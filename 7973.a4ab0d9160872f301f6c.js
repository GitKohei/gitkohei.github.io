(self.webpackChunkudonarium_lily_gk=self.webpackChunkudonarium_lily_gk||[]).push([[7973],{7973:function(Xe,Je,Ze){var e,M,q,h,u,x,E,c,n,f,Z,w,S,r,_,s,Y,d,I,D,t,C,$;Ze(4656),Opal.modules["bcdice/arithmetic_evaluator"]=function(e){var D,P,w,R,q,M,g,C,X=[],S=e.nil,r=e.$$$,_=e.$$,s=e.module,Y=e.hash2,d=e.truthy;return D=X,P=C=[s(X[0],"BCDice")].concat(D),g=[M=s(C[0],"ArithmeticEvaluator")].concat(P),w=e.get_singleton_class(M),q=[w].concat(g),void e.def(w,"$eval",R=function(W,L){var h,f=S;if(null==L)L=Y([],{});else if(!L.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(h=L.$$smap.round_type)&&(h=r(_(q,"RoundType"),"FLOOR")),d(W)&&d(f=_(q,"Arithmetic").$eval(W,h))?f:0},R.$$arity=-2)},Opal.modules["i18n/backend/fallbacks"]=function(e){function U(C,$){return"number"==typeof C&&"number"==typeof $?C-$:C["$-"]($)}var $,g,q,R,j,P,M,S=[],r=e.nil,_=e.$$$,s=e.$$,Y=e.module,d=e.truthy,I=e.send,D=e.send2,t=e.hash2;return $=S,M=[P=Y(S[0],"I18n")].concat($),e.class_variable_set(M[0],"@@fallbacks",r),g=e.get_singleton_class(P),j=[g].concat(M),e.def(g,"$fallbacks",q=function(){var W,n,h;return e.class_variable_set(j[1],"@@fallbacks",d(h=null==(W=j[1].$$cvars["@@fallbacks"])?r:W)?h:_(_(s(j,"I18n"),"Locale"),"Fallbacks").$new()),d(n=s(j,"Thread").$current()["$[]"]("i18n_fallbacks"))?n:null==(W=j[1].$$cvars["@@fallbacks"])?r:W},q.$$arity=0),e.def(g,"$fallbacks=",R=function(W){var L,n;return e.class_variable_set(j[1],"@@fallbacks",d(W["$is_a?"](s(j,"Array")))?_(_(s(j,"I18n"),"Locale"),"Fallbacks").$new(W):W),n=["i18n_fallbacks",null==(L=j[1].$$cvars["@@fallbacks"])?r:L],I(s(j,"Thread").$current(),"[]=",e.to_a(n)),n[U(n.length,1)]},R.$$arity=1),void function(g,w){var q=[Y(g,"Backend")].concat(w);!function(R,Z){var h,n,f,u,W=Y(R,"Fallbacks"),L=[W].concat(Z);e.def(W,"$translate",h=function(E,c,l){try{var b,B=h.$$p,T=this,m=r,o=r,p=r,v=r,y=r,a=r;for(B&&(h.$$p=null),y=0,a=arguments.length,v=new Array(a);y<a;y++)v[y]=arguments[y];return null==l&&(l=s(L,"EMPTY_HASH")),!d(l.$fetch("fallback",!0))||d(l["$[]"]("fallback_in_progress"))?D(T,e.find_super_dispatcher(T,"translate",h,!1,!0),"translate",v,B):(d(l["$[]"]("default"))&&(m=T["$extract_non_symbol_default!"](l)),o=l.$merge(t(["fallback_in_progress"],{fallback_in_progress:!0})),I(s(L,"I18n").$fallbacks()["$[]"](E),"each",[],((b=function(N){var te,O=null==b.$$s?this:b.$$s;null==N&&(N=r);try{return I(O,"catch",["exception"],((te=function(){var ve=null==te.$$s?this:te.$$s,ge=r;if(ge=D(ve,e.find_iter_super_dispatcher(ve,"translate",te.$$def||b.$$def||h,!1,!1),"translate",[N,c,o],null),d(ge["$nil?"]()))return r;d(E.$to_s()["$!="](N.$to_s()))&&ve.$on_fallback(E,N,c,l),e.ret(ge)}).$$s=O,te.$$arity=0,te))}catch(de){if(!e.rescue(de,[_(s(L,"I18n"),"InvalidLocale")]))throw de;try{return r}finally{e.pop_exception()}}}).$$s=T,b.$$arity=1,b)),d(d(p=l["$key?"]("default"))?l["$[]"]("default")["$nil?"]():p)?r:d(m)?D(T,e.find_super_dispatcher(T,"translate",h,!1,!0),"translate",[E,r,l.$merge(t(["default"],{default:m}))],null):T.$throw("exception",_(s(L,"I18n"),"MissingTranslation").$new(E,c,l)))}catch(k){if(k===e.returner)return k.$v;throw k}},h.$$arity=-3),e.def(W,"$extract_non_symbol_default!",n=function(E){var c,B,b=r,Q=r;return b=[E["$[]"]("default")].$flatten(),B=I(b,"detect",[],((c=function(m){return null==m&&(m=r),m["$is_a?"](s(L,"Symbol"))["$!"]()}).$$s=this,c.$$arity=1,c)),d(B)&&(Q=["default",b["$[]"](0,b.$index(B))],I(E,"[]=",e.to_a(Q)),U(Q.length,1)),B},n.$$arity=1),e.def(W,"$exists?",f=function(E,c,l){try{var b,B=f.$$p,T=this,m=r,o=r,p=r;for(B&&(f.$$p=null),o=0,p=arguments.length,m=new Array(p);o<p;o++)m[o]=arguments[o];return null==l&&(l=s(L,"EMPTY_HASH")),d(l.$fetch("fallback",!0))?(I(s(L,"I18n").$fallbacks()["$[]"](E),"each",[],((b=function(y){var a=null==b.$$s?this:b.$$s;null==y&&(y=r);try{if(!d(D(a,e.find_iter_super_dispatcher(a,"exists?",b.$$def||f,!1,!1),"exists?",[y,c],null)))return r;e.ret(!0)}catch(k){if(!e.rescue(k,[_(s(L,"I18n"),"InvalidLocale")]))throw k;try{return r}finally{e.pop_exception()}}}).$$s=T,b.$$arity=1,b)),!1):D(T,e.find_super_dispatcher(T,"exists?",f,!1,!0),"exists?",m,B)}catch(v){if(v===e.returner)return v.$v;throw v}},f.$$arity=-3),W.$private(),e.def(W,"$on_fallback",u=function(E,c,l,b){return r},u.$$arity=4)}(q[0],q)}(M[0],M)},Opal.modules["bcdice/randomizer"]=function(e){function U(g,w){return"number"==typeof g&&"number"==typeof w?g>w:g["$>"](w)}function X(g,w){return"number"==typeof g&&"number"==typeof w?g+w:g["$+"](w)}function S(g,w){return"number"==typeof g&&"number"==typeof w?g<=w:g["$<="](w)}function r(g,w){return"number"==typeof g&&"number"==typeof w?g-w:g["$-"](w)}function _(g,w){return"number"==typeof g&&"number"==typeof w?g*w:g["$*"](w)}var w,W,n,f,u,x,E,c,l,b,B,Q,T,L,h,q,d=[],I=e.nil,D=e.$$$,t=e.$$,$=e.klass,P=e.truthy,M=e.send;return w=d,W=q=[(0,e.module)(d[0],"BCDice")].concat(w),L=$(q[0],null,"Randomizer"),h=[L].concat(W),L.$$prototype.rand_results=L.$$prototype.detailed_rand_results=I,e.const_set(h[0],"UPPER_LIMIT_DICE_TIMES",200),e.const_set(h[0],"UPPER_LIMIT_DICE_SIDES",1e3),e.const_set(h[0],"UPPER_LIMIT_RANDS",1e4),e.def(L,"$initialize",n=function(){return this.rand_results=[],this.detailed_rand_results=[]},n.$$arity=0),L.$attr_reader("rand_results"),L.$attr_reader("detailed_rand_results"),e.const_set(h[0],"DetailedRandResult",t(h,"Struct").$new("kind","sides","value")),e.def(L,"$roll_barabara",f=function(o,p){var v,a,y=this;return P(U(X(y.rand_results.$size(),o),t(h,"UPPER_LIMIT_RANDS")))&&y.$raise(t(h,"TooManyRandsError")),P(P(a=S(o,0))?a:U(o,t(h,"UPPER_LIMIT_DICE_TIMES")))?[]:M(t(h,"Array"),"new",[o],((v=function(){return(null==v.$$s?this:v.$$s).$roll_once(p)}).$$s=y,v.$$arity=0,v))},f.$$arity=2),e.def(L,"$roll_sum",u=function(o,p){return this.$roll_barabara(o,p).$sum()},u.$$arity=2),e.def(L,"$roll_once",x=function(o){var v,y=I;return P(P(v=S(o,0))?v:U(o,t(h,"UPPER_LIMIT_DICE_SIDES")))?0:(y=this.$rand_inner(o),this.$push_to_detail("normal",o,y),y)},x.$$arity=1),e.def(L,"$roll_index",E=function(o){return r(this.$roll_once(o),1)},E.$$arity=1),e.def(L,"$roll_tens_d10",c=function(){var v,p=I;return(p=this.$rand_inner(10))["$=="](10)&&(p=0),v=_(p,10),this.$push_to_detail("tens_d10",10,v),v},c.$$arity=0),e.def(L,"$roll_d9",l=function(){var p;return p=r(this.$rand_inner(10),1),this.$push_to_detail("d9",10,p),p},l.$$arity=0),e.def(L,"$roll_d66",b=function(o){var p,a,y=I;return y=M(t(h,"Array"),"new",[2],((p=function(){return(null==p.$$s?this:p.$$s).$roll_once(6)}).$$s=this,p.$$arity=0,p)),a=o,D(t(h,"D66SortType"),"ASC")["$==="](a)?y["$sort!"]():D(t(h,"D66SortType"),"DESC")["$==="](a)&&y["$sort!"]()["$reverse!"](),X(_(y["$[]"](0),10),y["$[]"](1))},b.$$arity=1),L.$private(),e.def(L,"$rand_inner",B=function(o){var v,p=this;return P(function(g,w){return"number"==typeof g&&"number"==typeof w?g>=w:g["$>="](w)}(p.rand_results.$size(),t(h,"UPPER_LIMIT_RANDS")))&&p.$raise(t(h,"TooManyRandsError")),v=p.$random(o),p.rand_results["$<<"]([v,o]),v},B.$$arity=1),e.def(L,"$random",Q=function(o){return X(t(h,"Kernel").$rand(o),1)},Q.$$arity=1),e.def(L,"$push_to_detail",T=function(o,p,v){var a;return a=t(h,"DetailedRandResult").$new(o,p,v),this.detailed_rand_results.$push(a)},T.$$arity=3),void function(R,Z,W){[$(R,Z,"TooManyRandsError")].concat(W)}(q[0],t(q,"StandardError"),q)},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var D,P,q,W,L,h,n,R,Z,g,C,X=[],S=e.nil,_=e.$$,s=e.module,Y=e.klass,d=e.truthy;return D=X,P=C=[s(X[0],"BCDice")].concat(D),q=g=[s(C[0],"DiceTable")].concat(P),R=Y(g[0],null,"RollResult"),Z=[R].concat(q),R.$$prototype.table_name=R.$$prototype.value=R.$$prototype.body=S,e.def(R,"$initialize",W=function(u,x,E){var c=this;return c.table_name=u,c.value=x,c.body=E},W.$$arity=3),R.$attr_reader("table_name"),R.$attr_reader("value"),R.$attr_reader("body"),e.def(R,"$to_s",L=function(){var u=this;return u.table_name+"("+u.value+") \uff1e "+u.body},L.$$arity=0),e.def(R,"$last_body",h=function(){var u=this;return d(u.body["$is_a?"](_(Z,"RollResult")))?u.body.$last_body():u.body},h.$$arity=0),void e.def(R,"$empty?",n=function(){return!1},n.$$arity=0)},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var t,M,R,L,h,Z,W,w,$,S=[],r=e.nil,s=e.$$,Y=e.module,d=e.klass,I=e.truthy;return t=S,M=$=[Y(S[0],"BCDice")].concat(t),R=w=[Y($[0],"DiceTable")].concat(M),Z=d(w[0],null,"ChainTable"),W=[Z].concat(R),Z.$$prototype.times=Z.$$prototype.sides=Z.$$prototype.items=Z.$$prototype.name=r,e.def(Z,"$initialize",L=function(f,u,x){var E=this,c=r;return E.name=f,E.items=x.$freeze(),c=/(\d+)D(\d+)/i.$match(u),I(c)||E.$raise(s(W,"ArgumentError"),"Unexpected table type: "+u),E.times=c["$[]"](1).$to_i(),E.sides=c["$[]"](2).$to_i()},L.$$arity=3),void e.def(Z,"$roll",h=function(f){var x,E,u=this,c=r;return E=function(D,t){return"number"==typeof D&&"number"==typeof t?D-t:D["$-"](t)}(x=f.$roll_sum(u.times,u.sides),u.times),c=u.items["$[]"](E),I(c["$respond_to?"]("roll"))&&(c=c.$roll(f)),s(W,"RollResult").$new(u.name,x,c)},h.$$arity=1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){function S(C,$){return"number"==typeof C&&"number"==typeof $?C-$:C["$-"]($)}var $,w,W,n,f,u,L,h,q,M,_=[],s=e.nil,d=e.$$,I=e.module,D=e.klass,t=e.hash2;return $=_,w=M=[I(_[0],"BCDice")].concat($),W=q=[I(M[0],"DiceTable")].concat(w),L=D(q[0],null,"D66GridTable"),h=[L].concat(W),L.$$prototype.name=L.$$prototype.items=s,e.defs(L,"$from_i18n",n=function(E,c){var b=s;return b=d(h,"I18n").$t(E,t(["locale","raise"],{locale:c,raise:!0})),this.$new(b["$[]"]("name"),b["$[]"]("items"))},n.$$arity=2),e.def(L,"$initialize",f=function(E,c){return this.name=E,this.items=c.$freeze()},f.$$arity=2),void e.def(L,"$roll",u=function(E){var l,b,B,Q,T;return l=E.$roll_once(6),b=E.$roll_once(6),B=function(C,$){return"number"==typeof C&&"number"==typeof $?C+$:C["$+"]($)}(function(C,$){return"number"==typeof C?10*C:C["$*"](10)}(l),b),Q=S(l,1),T=S(b,1),d(h,"RollResult").$new(this.name,B,this.items["$[]"](Q)["$[]"](T))},u.$$arity=1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var D,P,q,W,L,R,Z,g,C,X=[],S=e.nil,_=e.$$,s=e.module,Y=e.klass,d=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),D=X,P=C=[s(X[0],"BCDice")].concat(D),q=g=[s(C[0],"DiceTable")].concat(P),R=Y(g[0],_(g,"D66GridTable"),"D66HalfGridTable"),Z=[R].concat(q),e.defs(R,"$from_i18n",W=function(n,f){var x=S;return x=_(Z,"I18n").$t(n,d(["locale","raise"],{locale:f,raise:!0})),this.$new(x["$[]"]("name"),x["$[]"]("items_1_2_3"),x["$[]"]("items_4_5_6"))},W.$$arity=2),void e.def(R,"$initialize",L=function(n,f,u){return this.name=n,this.items=[f,f,f,u,u,u].$freeze()},L.$$arity=3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var D,P,q,W,L,R,Z,g,C,X=[],S=e.nil,_=e.$$,s=e.module,Y=e.klass,d=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),D=X,P=C=[s(X[0],"BCDice")].concat(D),q=g=[s(C[0],"DiceTable")].concat(P),R=Y(g[0],_(g,"D66GridTable"),"D66OneThirdTable"),Z=[R].concat(q),e.defs(R,"$from_i18n",W=function(n,f){var x=S;return x=_(Z,"I18n").$t(n,d(["locale","raise"],{locale:f,raise:!0})),this.$new(x["$[]"]("name"),x["$[]"]("items_1_2"),x["$[]"]("items_3_4"),x["$[]"]("items_5_6"))},W.$$arity=2),void e.def(R,"$initialize",L=function(n,f,u,x){return this.name=n,this.items=[f,f,u,u,x,x].$freeze()},L.$$arity=4)},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var $,w,W,n,f,u,L,h,q,M,r=[],_=e.nil,s=e.$$$,Y=e.$$,d=e.module,I=e.klass,D=e.hash2,t=e.truthy;return $=r,w=M=[d(r[0],"BCDice")].concat($),W=q=[d(M[0],"DiceTable")].concat(w),L=I(q[0],null,"D66Table"),h=[L].concat(W),L.$$prototype.sort_type=L.$$prototype.items=L.$$prototype.name=_,e.defs(L,"$from_i18n",n=function(E,c){var B,b=_;return b=Y(h,"I18n").$t(E,D(["locale"],{locale:c})),B=Y(h,"D66SortType").$const_get(b["$[]"]("d66_sort_type")),this.$new(b["$[]"]("name"),B,b["$[]"]("items"))},n.$$arity=2),e.def(L,"$initialize",f=function(E,c,l){var b=this;return b.name=E,b.sort_type=c,b.items=l.$freeze()},f.$$arity=3),void e.def(L,"$roll",u=function(E){var b,T,c=this,l=_,B=_,Q=_;return l=E.$roll_barabara(2,6),b=c.sort_type,s(Y(h,"D66SortType"),"ASC")["$==="](b)?l["$sort!"]():s(Y(h,"D66SortType"),"DESC")["$==="](b)&&l["$sort!"]()["$reverse!"](),B=function(C,$){return"number"==typeof C&&"number"==typeof $?C+$:C["$+"]($)}(function(C,$){return"number"==typeof C?10*C:C["$*"](10)}(l["$[]"](0)),l["$[]"](1)),Q=t(T=c.items["$[]"](B))?T:c.items["$[]"](B.$to_s()),t(Q["$respond_to?"]("roll"))&&(Q=Q.$roll(E)),Y(h,"RollResult").$new(c.name,B,Q)},u.$$arity=1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){function U(P,M){return"number"==typeof P&&"number"==typeof M?P+M:P["$+"](M)}var M,h,u,n,q,Z,w,_=[],s=e.nil,d=e.$$,I=e.module,D=e.klass,t=e.hash2,C=e.send,$=e.send2;return e.top.$require("bcdice/dice_table/d66_table"),M=_,q=w=[I(_[0],"BCDice")].concat(M),h=Z=[I(w[0],"DiceTable")].concat(q),[n=D(Z[0],d(Z,"D66Table"),"D66LeftRangeTable")].concat(h),void e.def(n,"$initialize",u=function(E,c,l){var b,m,T=this;return u.$$p&&(u.$$p=null),m=t([],{}),C(l,"each",[],((b=function(o){function p(v){return o.apply(this,arguments)}return p.toString=function(){return o.toString()},p}(function(o){var v,a,N,p=null==b.$$s?this:b.$$s;return null==o&&(o=s),v=e.to_ary(o),N=null==v[1]?s:v[1],C(null==v[0]?s:v[0],"each",[],((a=function(te){var ve;return null==te&&(te=s),C(N,"each_with_index",[],((ve=function(qe,Re){var Te,be,P;return null==qe&&(qe=s),null==Re&&(Re=s),Te=U("number"==typeof(P=te)?10*P:P["$*"](10),U(Re,1)),C(m,"[]=",e.to_a(be=[Te,qe])),be[function(P,M){return"number"==typeof P?P-1:P["$-"](1)}(be.length)]}).$$s=null==a.$$s?this:a.$$s,ve.$$arity=2,ve))}).$$s=p,a.$$arity=1,a))})).$$s=T,b.$$arity=1,b)),$(T,e.find_super_dispatcher(T,"initialize",u,!1,!0),"initialize",[E,c,m],null)},u.$$arity=3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var $,w,W,n,f,L,h,q,M,_=[],s=e.nil,d=e.$$,I=e.module,D=e.klass,t=e.truthy;return $=_,w=M=[I(_[0],"BCDice")].concat($),W=q=[I(M[0],"DiceTable")].concat(w),L=D(q[0],null,"D66ParityTable"),h=[L].concat(W),L.$$prototype.odd=L.$$prototype.even=L.$$prototype.name=s,e.def(L,"$initialize",n=function(x,E,c){var l=this;return l.name=x,l.odd=E.$freeze(),l.even=c.$freeze()},n.$$arity=3),void e.def(L,"$roll",f=function(x){var l,B,Q,E=this,c=s;return c=x.$roll_once(6),l=x.$roll_once(6),B=(t(c["$odd?"]())?E.odd:E.even)["$[]"](function(C,$){return"number"==typeof C?C-1:C["$-"](1)}(l)),Q=function(C,$){return"number"==typeof C&&"number"==typeof $?C+$:C["$+"]($)}(function(C,$){return"number"==typeof C?10*C:C["$*"](10)}(c),l),d(h,"RollResult").$new(E.name,Q,B)},f.$$arity=1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var C,g,Z,h,n,W,L,j,P,r=[],_=e.nil,Y=e.$$,d=e.module,I=e.klass,D=e.send;return C=r,g=P=[d(r[0],"BCDice")].concat(C),Z=j=[d(P[0],"DiceTable")].concat(g),W=I(j[0],null,"D66RangeTable"),L=[W].concat(Z),W.$$prototype.items=W.$$prototype.name=_,e.def(W,"$initialize",h=function(u,x){return this.name=u,this.items=x.$freeze()},h.$$arity=2),void e.def(W,"$roll",n=function(u){var x,c,l,b,E=this,B=_;return c=u.$roll_once(6),l=u.$roll_once(6),b=function(t,C){return"number"==typeof t&&"number"==typeof C?t+C:t["$+"](C)}(function(t,C){return"number"==typeof t?10*t:t["$*"](10)}(c),l),B=D(E.items,"find",[],((x=function(T){return null==T&&(T=_),T["$[]"](0)["$include?"](b)}).$$s=E,x.$$arity=1,x)),Y(L,"RollResult").$new(E.name,b,B["$[]"](1))},n.$$arity=1)},Opal.modules["bcdice/dice_table/range_table"]=function(e){var P,j,L,f,u,x,E,c,l,b,B,Q,h,n,R,g,_=[],s=e.nil,d=e.$$,I=e.module,D=e.klass,t=e.send,C=e.truthy;return P=_,j=g=[I(_[0],"BCDice")].concat(P),L=R=[I(g[0],"DiceTable")].concat(j),h=D(R[0],null,"RangeTable"),n=[h].concat(L),h.$$prototype.name=h.$$prototype.items=h.$$prototype.num_of_dice=h.$$prototype.num_of_sides=h.$$prototype.formatter=s,e.const_set(n[0],"RollResult",t(d(n,"Struct"),"new",["sum","values","content","formatted"],((f=function(){return(null==f.$$s?this:f.$$s).$alias_method("to_s","formatted")}).$$s=h,f.$$arity=0,f))),e.const_set(n[0],"Item",d(n,"Struct").$new("range","content")),e.const_set(n[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),e.const_set(n[0],"DEFAULT_FORMATTER",t(h,"lambda",[],($$2=function(T){function m(o,p){return T.apply(this,arguments)}return m.toString=function(){return T.toString()},m}(function(T,m){return null==$$2.$$s||$$2,null==T&&(T=s),null==m&&(m=s),T.$name()+"("+m.$sum()+") \uff1e "+m.$content()}),$$2.$$s=h,$$2.$$arity=2,$$2))),h.$attr_reader("name"),h.$attr_reader("num_of_dice"),h.$attr_reader("num_of_sides"),e.def(h,"$initialize",u=function(m,o,p){var k,v=u.$$p,y=v||s,a=this,N=s;return v&&(u.$$p=null),v&&(u.$$p=null),a.name=m.$freeze(),a.formatter=C(k=y)?k:d(n,"DEFAULT_FORMATTER"),N=d(n,"DICE_ROLL_METHOD_RE").$match(o),C(N)||a.$raise(d(n,"ArgumentError"),a.name+": invalid dice roll method: "+o),a.num_of_dice=N["$[]"](1).$to_i(),a.num_of_sides=N["$[]"](2).$to_i(),a.$store(p)},u.$$arity=3),e.def(h,"$fetch",x=function(m){var o,v,p=this;return v=t(p.items,"find",[],((o=function(a){return null==a&&(a=s),a.$range()["$include?"](m)}).$$s=p,o.$$arity=1,o)),C(v)||p.$raise(d(n,"RangeError"),p.name+": value is out of range: "+m),v},x.$$arity=1),e.def(h,"$roll",E=function(m){var v,y,a,o=this,p=s;return v=(p=m.$roll_barabara(o.num_of_dice,o.num_of_sides)).$sum(),y=d(n,"RollResult").$new(v,p,o.$fetch(v).$content()),a=[o.formatter["$[]"](o,y)],t(y,"formatted=",e.to_a(a)),function($,P){"number"==typeof $||$["$-"](1)}(a.length),y},E.$$arity=1),h.$private(),e.def(h,"$store",c=function(m){var o,p,v,a,k,y=this;return a=t(m,"map",[],((o=function(O,te){return null==O&&(O=s),null==te&&(te=s),[(null==o.$$s?this:o.$$s).$coerce_to_int_range(O),te]}).$$s=y,o.$$arity=2,o)),k=t(a,"sort_by",[],((p=function(O,te){return null==O&&(O=s),null==te&&(te=s),O.$min()}).$$s=y,p.$$arity=2,p)),y.$assert_min_sum_is_covered(k),y.$assert_max_sum_is_covered(k),y.$assert_no_gap_or_overlap_in_ranges(k),y.items=t(k,"map",[],(v=function(O,te){return null==O&&(O=s),null==te&&(te=s),d(n,"Item").$new(O,te.$freeze()).$freeze()},v.$$s=y,v.$$arity=2,v)).$freeze(),y},c.$$arity=1),e.def(h,"$coerce_to_int_range",l=function(m){var p,v=s;return p=m,d(n,"Integer")["$==="](p)?d(n,"Range").$new(m,m):d(n,"Range")["$==="](p)&&C(C(v=m.$begin()["$is_a?"](d(n,"Integer")))?m.$end()["$is_a?"](d(n,"Integer")):v)?m:this.$raise(d(n,"TypeError"),this.name+": "+m+" ("+m.$class()+") must be an Integer or a Range with Integers ")},l.$$arity=1),e.def(h,"$assert_min_sum_is_covered",b=function(m){var p,o=this,v=s;return p=o.num_of_dice,v=m.$first()["$[]"](0),C(v["$include?"](p))||o.$raise(d(n,"RangeError"),o.name+": min value ("+p+") is not covered: "+v),o},b.$$arity=1),e.def(h,"$assert_max_sum_is_covered",B=function(m){var p,o=this,v=s;return p=function($,P){return"number"==typeof $&&"number"==typeof P?$*P:$["$*"](P)}(o.num_of_dice,o.num_of_sides),v=m.$last()["$[]"](0),C(v["$include?"](p))||o.$raise(d(n,"RangeError"),o.name+": max value ("+p+") is not covered: "+v),o},B.$$arity=1),void e.def(h,"$assert_no_gap_or_overlap_in_ranges",Q=function(m){var o;return t(m,"each_cons",[2],((o=function(y,a){var te,de,k=null==o.$$s?this:o.$$s,N=s,O=s;return null==k.name&&(k.name=s),null==y&&(y=s),null==a&&(a=s),N=y["$[]"](0),O=a["$[]"](0),de=function($,P){return"number"==typeof $?$+1:$["$+"](1)}(te=N.$max()),C(O["$include?"](te))&&k.$raise(d(n,"RangeError"),k.name+": Range overlap: "+N+" and "+O),C(O["$include?"](de))?s:k.$raise(d(n,"RangeError"),k.name+": Range gap: "+N+" and "+O)}).$$s=this,o.$$arity=2,o)),this},Q.$$arity=1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var t,M,R,n,x,E,c,f,u,W,w,$,S=[],r=e.nil,_=e.$$$,s=e.$$,Y=e.module,d=e.klass,I=e.send;return t=S,M=$=[Y(S[0],"BCDice")].concat(t),R=w=[Y($[0],"DiceTable")].concat(M),n=W=[d(w[0],null,"SaiFicSkillTable")].concat(R),f=d(W[0],null,"Category"),u=[f].concat(n),f.$$prototype.name=r,e.def(f,"$initialize",x=function(b,B,Q,T){var m,o=this;return o.name=b,o.skills=I(B.$map(),"with_index",[2],((m=function(p){function v(y,a){return p.apply(this,arguments)}return v.toString=function(){return p.toString()},v}(function(p,v){return null==p&&(p=r),null==v&&(v=r),_(s(u,"SaiFicSkillTable"),"Skill").$new(b,p,Q,v,T)})).$$s=o,m.$$arity=2,m)),o.dice=Q},x.$$arity=4),e.def(f,"$roll",E=function(b){return this.$skills()["$[]"](function(D,t){return"number"==typeof D?D-2:D["$-"](2)}(b.$roll_sum(2,6)))},E.$$arity=1),e.def(f,"$to_s",c=function(){return this.name},c.$$arity=0),void f.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var D,P,h,u,x,n,q,Z,g,C,X=[],S=e.nil,s=e.module,Y=e.klass,d=e.hash2;return D=X,P=C=[s(X[0],"BCDice")].concat(D),q=g=[s(C[0],"DiceTable")].concat(P),h=Z=[Y(g[0],null,"SaiFicSkillTable")].concat(q),[n=Y(Z[0],null,"Skill")].concat(h),n.$$prototype.s_format=n.$$prototype.category_dice=n.$$prototype.row_dice=n.$$prototype.category_name=n.$$prototype.name=S,e.def(n,"$initialize",u=function(c,l,b,B,Q){var T=this;return T.category_name=c,T.name=l,T.category_dice=b,T.row_dice=B,T.s_format=Q},u.$$arity=5),e.def(n,"$to_s",x=function(){var c=this;return c.$format(c.s_format,d(["category_dice","row_dice","category_name","skill_name"],{category_dice:c.category_dice,row_dice:c.row_dice,category_name:c.category_name,skill_name:c.name}))},x.$$arity=0),void n.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var M,q,h,u,x,E,c,l,b,B,n,f,Z,w,S=e.top,r=[],_=e.nil,s=e.$$$,Y=e.$$,d=e.module,I=e.klass,D=e.hash2,t=e.send,$=e.truthy;return S.$require("bcdice/dice_table/sai_fic_skill_table/category"),S.$require("bcdice/dice_table/sai_fic_skill_table/skill"),M=r,q=w=[d(r[0],"BCDice")].concat(M),h=Z=[d(w[0],"DiceTable")].concat(q),n=I(Z[0],null,"SaiFicSkillTable"),f=[n].concat(h),n.$$prototype.rtt=n.$$prototype.rtt_format=n.$$prototype.rct=n.$$prototype.rct_format=n.$$prototype.rttn=n.$$prototype.rttn_format=n.$$prototype.categories=_,e.defs(n,"$from_i18n",u=function(T,m,o){var p,v,y,a,te,O=_;if(null==o)o=D([],{});else if(!o.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(p=o.$$smap.rtt)&&(p=_),null==(v=o.$$smap.rct)&&(v=_),null==(y=o.$$smap.rttn)&&(y=_),te=(O=Y(f,"I18n").$t("RTT",D(["locale","raise","default"],{locale:m,raise:!1,default:D([],{})})).$merge(Y(f,"I18n").$t(T,D(["locale","raise"],{locale:m,raise:!0}))))["$[]"]("items"),O=t(O,"select",[],((a=function(de){function ve(ge,qe){return de.apply(this,arguments)}return ve.toString=function(){return de.toString()},ve}(function(de,ve){return null==de&&(de=_),null==ve&&(ve=_),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](de)})).$$s=this,a.$$arity=2,a)),this.$new(te,e.to_hash(O).$merge(D(["rtt","rct","rttn"],{rtt:p,rct:v,rttn:y})))},u.$$arity=-3),e.const_set(f[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),e.const_set(f[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),e.const_set(f[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),e.const_set(f[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),e.def(n,"$initialize",x=function(T,m){var o,p,v,y,a,k,N,O,te=this;if(null==m)m=D([],{});else if(!m.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(o=m.$$smap.rtt)&&(o=_),null==(p=m.$$smap.rct)&&(p=_),null==(v=m.$$smap.rttn)&&(v=_),null==(y=m.$$smap.rtt_format)&&(y=Y(f,"DEFAULT_RTT")),null==(a=m.$$smap.rct_format)&&(a=Y(f,"DEFAULT_RCT")),null==(k=m.$$smap.rttn_format)&&(k=Y(f,"DEFAULT_RTTN")),null==(N=m.$$smap.s_format)&&(N=Y(f,"DEFAULT_S")),te.categories=t(T.$map(),"with_index",[1],((O=function(ve,ge){var Re,Te,be;return null==ve&&(ve=_),null==ge&&(ge=_),Te=null==(Re=e.to_ary(ve))[0]?_:Re[0],be=null==Re[1]?_:Re[1],s(Y(f,"SaiFicSkillTable"),"Category").$new(Te,be,ge,N)}).$$s=te,O.$$arity=2,O.$$has_top_level_mlhs_arg=!0,O)),te.rtt=o,te.rct=p,te.rttn=v.$to_a(),te.rtt_format=y,te.rct_format=a,te.rttn_format=k},x.$$arity=-2),e.const_set(f[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),n.$attr_reader("categories"),e.def(n,"$roll_command",E=function(T,m){var p,o=this,v=_,y=_,a=_;return $(["RTT",o.rtt]["$include?"](p=m))?o.$format_skill(o.rtt_format,o.$roll_skill(T)):$(["RCT",o.rct]["$include?"](p))?(v=o.$roll_category(T),o.$format(o.rct_format,D(["category_dice","category_name"],{category_dice:v.$dice(),category_name:v.$name()}))):$($(y=a=Y(f,"RTTN").$index(p))?y:a=o.rttn.$index(p))?o.$format_skill(o.rttn_format,o.categories["$[]"](a).$roll(T)):_},E.$$arity=2),e.def(n,"$roll_category",c=function(T){return this.categories["$[]"]("number"==typeof(P=T.$roll_once(6))?P-1:P["$-"](1));var P},c.$$arity=1),e.def(n,"$roll_skill",l=function(T){return this.$roll_category(T).$roll(T)},l.$$arity=1),e.def(n,"$prefixes",b=function(){var T=this;return function(P,M){return"number"==typeof P&&"number"==typeof M?P+M:P["$+"](M)}(["RTT[1-6]?","RCT",T.rtt,T.rct],T.rttn).$compact()},b.$$arity=0),n.$private(),void e.def(n,"$format_skill",B=function(T,m){return this.$format(T,D(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:m.$category_dice(),row_dice:m.$row_dice(),category_name:m.$category_name(),skill_name:m.$name(),text:m.$to_s()}))},B.$$arity=2)},Opal.modules["bcdice/dice_table/table"]=function(e){var C,g,Z,h,n,f,u,W,L,j,P,S=[],r=e.nil,s=e.$$,Y=e.module,d=e.klass,I=e.hash2,D=e.truthy;return C=S,g=P=[Y(S[0],"BCDice")].concat(C),Z=j=[Y(P[0],"DiceTable")].concat(g),W=d(j[0],null,"Table"),L=[W].concat(Z),W.$$prototype.times=W.$$prototype.sides=W.$$prototype.name=W.$$prototype.items=r,e.defs(W,"$from_i18n",h=function(E,c){var b=r;return b=s(L,"I18n").$t(E,I(["locale"],{locale:c})),this.$new(b["$[]"]("name"),b["$[]"]("type"),b["$[]"]("items"))},h.$$arity=2),e.def(W,"$initialize",n=function(E,c,l){var b=this,B=r;return b.name=E,b.items=l.$freeze(),B=/(\d+)D(\d+)/i.$match(c),D(B)||b.$raise(s(L,"ArgumentError"),"Unexpected table type: "+c),b.times=B["$[]"](1).$to_i(),b.sides=B["$[]"](2).$to_i()},n.$$arity=3),e.def(W,"$roll",f=function(E){var l,c=this;return l=E.$roll_sum(c.times,c.sides),c.$choice(l)},f.$$arity=1),void e.def(W,"$choice",u=function(E){var l,c=this;return l=function(t,C){return"number"==typeof t&&"number"==typeof C?t-C:t["$-"](C)}(E,c.times),s(L,"RollResult").$new(c.name,E,c.items["$[]"](l))},u.$$arity=1)},Opal.modules["bcdice/dice_table"]=function(e){var U=e.top;return U.$require("bcdice/dice_table/roll_result"),U.$require("bcdice/dice_table/chain_table"),U.$require("bcdice/dice_table/d66_grid_table"),U.$require("bcdice/dice_table/d66_half_grid_table"),U.$require("bcdice/dice_table/d66_one_third_table"),U.$require("bcdice/dice_table/d66_left_range_table"),U.$require("bcdice/dice_table/d66_parity_table"),U.$require("bcdice/dice_table/d66_range_table"),U.$require("bcdice/dice_table/d66_table"),U.$require("bcdice/dice_table/range_table"),U.$require("bcdice/dice_table/sai_fic_skill_table"),U.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var d,C,P,D,X=[],s=e.module;return d=X,C=D=[s(X[0],"BCDice")].concat(d),P=[s(D[0],"D66SortType")].concat(C),e.const_set(P[0],"NO_SORT","no_sort"),e.const_set(P[0],"ASC","asc"),e.const_set(P[0],"DESC","desc"),void function(t,C){var P=[s(t,"RoundType")].concat(C);e.const_set(P[0],"CEIL","ceil"),e.const_set(P[0],"FLOOR","floor"),e.const_set(P[0],"ROUND","round")}(D[0],D)},Opal.modules["bcdice/translate"]=function(e){var D,P,w,M,g,C,X=[],S=e.nil,_=e.$$,s=e.module,Y=e.hash2;return D=X,P=C=[s(X[0],"BCDice")].concat(D),M=s(C[0],"Translate"),g=[M].concat(P),void e.def(M,"$translate",w=function(q,R){var Z,W=this;if(null==W.locale&&(W.locale=S),null==R)R=Y([],{});else if(!R.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return Z=e.kwrestargs(R,{}),_(g,"I18n").$translate(q,Y(["locale","raise"],{locale:W.locale,raise:!0}).$merge(e.to_hash(Z)))},w.$$arity=-2)},Opal.modules["bcdice/result"]=function(e){function U(D,t){return"number"==typeof D&&"number"==typeof t?D-t:D["$-"](t)}var t,f,E,c,l,b,B,g,q,R,Z,W,L,h,n,w,j,$,S=[],r=e.nil,d=e.klass,I=e.send;return t=S,g=$=[(0,e.module)(S[0],"BCDice")].concat(t),j=[w=d($[0],null,"Result")].concat(g),w.$$prototype.secret=w.$$prototype.success=w.$$prototype.failure=w.$$prototype.critical=w.$$prototype.fumble=r,[f=e.get_singleton_class(w)].concat(j),e.def(f,"$success",E=function(T){var m;return I(this.$new(),"tap",[],((m=function(p){function v(y){return p.apply(this,arguments)}return v.toString=function(){return p.toString()},v}(function(p){var y=r;return null==p&&(p=r),I(p,"text=",e.to_a(y=[T])),U(y.length,1),I(p,"success=",e.to_a(y=[!0])),y[U(y.length,1)]})).$$s=this,m.$$arity=1,m))},E.$$arity=1),e.def(f,"$failure",c=function(T){var m;return I(this.$new(),"tap",[],((m=function(v){var a=r;return null==v&&(v=r),I(v,"text=",e.to_a(a=[T])),U(a.length,1),I(v,"failure=",e.to_a(a=[!0])),a[U(a.length,1)]}).$$s=this,m.$$arity=1,m))},c.$$arity=1),e.def(f,"$critical",l=function(T){var m;return I(this.$new(),"tap",[],((m=function(v){var a=r;return null==v&&(v=r),I(v,"text=",e.to_a(a=[T])),U(a.length,1),I(v,"critical=",e.to_a(a=[!0])),U(a.length,1),I(v,"success=",e.to_a(a=[!0])),a[U(a.length,1)]}).$$s=this,m.$$arity=1,m))},l.$$arity=1),e.def(f,"$fumble",b=function(T){var m;return I(this.$new(),"tap",[],((m=function(v){var a=r;return null==v&&(v=r),I(v,"text=",e.to_a(a=[T])),U(a.length,1),I(v,"fumble=",e.to_a(a=[!0])),U(a.length,1),I(v,"failure=",e.to_a(a=[!0])),a[U(a.length,1)]}).$$s=this,m.$$arity=1,m))},b.$$arity=1),e.def(f,"$nothing",B=function(){return"nothing"},B.$$arity=0),e.def(w,"$initialize",q=function(u){var x=this;return null==u&&(u=r),x.text=u,x.rands=r,x.detailed_rands=r,x.secret=!1,x.success=!1,x.failure=!1,x.critical=!1,x.fumble=!1},q.$$arity=-1),w.$attr_accessor("text","rands","detailed_rands"),w.$attr_writer("secret","success","failure","critical","fumble"),e.def(w,"$secret?",R=function(){return this.secret},R.$$arity=0),e.def(w,"$success?",Z=function(){return this.success},Z.$$arity=0),e.def(w,"$failure?",W=function(){return this.failure},W.$$arity=0),e.def(w,"$critical?",L=function(){return this.critical},L.$$arity=0),e.def(w,"$fumble?",h=function(){return this.fumble},h.$$arity=0),void e.def(w,"$condition=",n=function(u){return this.success=u,this.failure=u["$!"]()},n.$$arity=1)},Opal.modules["racc/parser"]=function(e){function U(q,R){return"number"==typeof q&&"number"==typeof R?q<R:q["$<"](R)}function X(q,R){return"number"==typeof q&&"number"==typeof R?q-R:q["$-"](R)}function S(q,R){return"number"==typeof q&&"number"==typeof R?q+R:q["$+"](R)}function r(q,R){return"number"==typeof q&&"number"==typeof R?q>=R:q["$>="](R)}function _(q,R){return"number"==typeof q&&"number"==typeof R?q>R:q["$>"](R)}function s(q,R){return"number"==typeof q&&"number"==typeof R?q<=R:q["$<="](R)}var L,h,n,R,W,D=[],t=e.nil,C=e.$$$,$=e.$$,P=e.module,M=e.klass,g=e.truthy,w=e.gvars,j=e.send;return R=D,L=(W=[P(D[0],"Racc")].concat(R))[0],h=$(W,"StandardError"),n=W,[M(L,h,"ParseError")].concat(n),g(C("::","ParseError","skip_raise")?"constant":t)||e.const_set(D[0],"ParseError",C($(D,"Racc"),"ParseError")),function(q,R){var f,E,c,l,b,B,Q,T,m,o,p,v,y,a,k,N,O,te,de,ve,ge,qe,Re,ze,Te,u,x,W=[P(q,"Racc")].concat(R);g($(W,"Racc_No_Extensions","skip_raise")?"constant":t)||e.const_set(W[0],"Racc_No_Extensions",!1),f=W,u=M(W[0],null,"Parser"),x=[u].concat(f),u.$$prototype.yydebug=u.$$prototype.racc_debug_out=u.$$prototype.racc_error_status=u.$$prototype.racc_t=u.$$prototype.racc_vstack=u.$$prototype.racc_val=u.$$prototype.racc_state=u.$$prototype.racc_tstack=t,e.const_set(x[0],"Racc_Runtime_Version","1.4.6"),e.const_set(x[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),e.const_set(x[0],"Racc_Runtime_Core_Version_R","1.4.6"),e.const_set(x[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),e.const_set(x[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),e.const_set(x[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),e.const_set(x[0],"Racc_Runtime_Core_Version",$(x,"Racc_Runtime_Core_Version_R")),e.const_set(x[0],"Racc_Runtime_Core_Revision",$(x,"Racc_Runtime_Core_Revision_R")),e.const_set(x[0],"Racc_Runtime_Type","ruby"),e.defs($(x,"Parser"),"$racc_runtime_type",E=function(){return $(x,"Racc_Runtime_Type")},E.$$arity=0),e.def(u,"$_racc_setup",c=function(){var J,re,i=this,H=t,K=t,A=t;return null==w.stderr&&(w.stderr=t),g(C(i.$class(),"Racc_debug_parser"))||(i.yydebug=!1),g(null!=(J=i.yydebug)&&J!==t?"instance-variable":t)||(i.yydebug=!1),g(i.yydebug)&&(g(null!=(re=i.racc_debug_out)&&re!==t?"instance-variable":t)||(i.racc_debug_out=w.stderr),i.racc_debug_out=g(H=i.racc_debug_out)?H:w.stderr),K=C(i.$class(),"Racc_arg"),g(U(K.$size(),14))&&(j(K,"[]=",e.to_a(A=[13,!0])),X(A.length,1)),K},c.$$arity=0),e.def(u,"$_racc_init_sysvars",l=function(){var J=this;return J.racc_state=[0],J.racc_tstack=[],J.racc_vstack=[],J.racc_t=t,J.racc_val=t,J.racc_read_next=!0,J.racc_user_yyerror=!1,J.racc_error_status=0},l.$$arity=0),e.def(u,"$do_parse",b=function(){return this.$__send__($(x,"Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},b.$$arity=0),e.def(u,"$next_token",B=function(){return this.$raise($(x,"NotImplementedError"),this.$class()+"#next_token is not defined")},B.$$arity=0),e.def(u,"$_racc_do_parse_rb",Q=function(J,re){var i,K,A=this,ne=t,$e=t,ce=t,xe=t,fe=t,he=t,we=t,le=t;return i=e.to_ary(J),ne=null==i[0]?t:i[0],$e=null==i[1]?t:i[1],ce=null==i[2]?t:i[2],xe=null==i[3]?t:i[3],fe=null==i[10]?t:i[10],A.$_racc_init_sysvars(),he=we=le=t,j(A,"catch",["racc_end_parse"],((K=function(){var Ke,Me,me=null==K.$$s?this:K.$$s,Le=t,Ge=t,He=t;for(null==me.racc_state&&(me.racc_state=t),null==me.racc_read_next&&(me.racc_read_next=t),null==me.racc_t&&(me.racc_t=t),null==me.yydebug&&(me.yydebug=t),null==me.racc_val&&(me.racc_val=t);g(!0);)for(g(le=xe["$[]"](me.racc_state["$[]"](-1)))?(g(me.racc_read_next)&&g(me.racc_t["$!="](0))&&(Me=me.$next_token(),Ke=e.to_ary(Me),he=null==Ke[0]?t:Ke[0],me.racc_val=null==Ke[1]?t:Ke[1],me.racc_t=g(he)?g(Le=fe["$[]"](he))?Le:1:0,g(me.yydebug)&&me.$racc_read_token(me.racc_t,he,me.racc_val),me.racc_read_next=!1),le=S(le,me.racc_t),g(g(Ge=g(He=r(le,0))?we=ne["$[]"](le):He)?$e["$[]"](le)["$=="](me.racc_state["$[]"](-1)):Ge)||(we=ce["$[]"](me.racc_state["$[]"](-1)))):we=ce["$[]"](me.racc_state["$[]"](-1));g(we=me.$_racc_evalact(we,J)););}).$$s=A,K.$$arity=0,K))},Q.$$arity=2),e.def(u,"$yyparse",T=function(J,re){return this.$__send__($(x,"Racc_YY_Parse_Method"),J,re,this.$_racc_setup(),!0)},T.$$arity=2),e.def(u,"$_racc_yyparse_rb",m=function(J,re,i,H){var K,ne,ce=t,xe=t,oe=t,fe=t,we=t,le=t,De=t;return K=e.to_ary(i),ce=null==K[0]?t:K[0],xe=null==K[1]?t:K[1],oe=null==K[2]?t:K[2],fe=null==K[3]?t:K[3],we=null==K[10]?t:K[10],this.$_racc_init_sysvars(),le=t,De=t,j(this,"catch",["racc_end_parse"],((ne=function(){var Le,Ae=null==ne.$$s?this:ne.$$s;for(null==Ae.racc_state&&(Ae.racc_state=t);!g(De=fe["$[]"](Ae.racc_state["$[]"](-1)));)for(;g(le=Ae.$_racc_evalact(oe["$[]"](Ae.racc_state["$[]"](-1)),i)););return j(J,"__send__",[re],((Le=function(He,Fe){var ee,G,Ne=null==Le.$$s?this:Le.$$s,ke=t,ye=t,Pe=t,_e=t,ae=t,z=t,ie=t;for(null==Ne.racc_t&&(Ne.racc_t=t),null==Ne.racc_state&&(Ne.racc_state=t),null==Ne.racc_read_next&&(Ne.racc_read_next=t),null==He&&(He=t),null==Fe&&(Fe=t),Ne.racc_t=g(He)?g(ke=we["$[]"](He))?ke:1:0,Ne.racc_val=Fe,Ne.racc_read_next=!1,De=S(De,Ne.racc_t),g(g(ee=g(G=r(De,0))?le=ce["$[]"](De):G)?xe["$[]"](De)["$=="](Ne.racc_state["$[]"](-1)):ee)||(le=oe["$[]"](Ne.racc_state["$[]"](-1)));g(le=Ne.$_racc_evalact(le,i)););for(;g(g(ye=g(Pe=(De=fe["$[]"](Ne.racc_state["$[]"](-1)))["$!"]())?Pe:Ne.racc_read_next["$!"]())?ye:Ne.racc_t["$=="](0));)for(g(g(_e=g(ae=g(z=g(ie=De)?De=S(De,Ne.racc_t):ie)?r(De,0):z)?le=ce["$[]"](De):ae)?xe["$[]"](De)["$=="](Ne.racc_state["$[]"](-1)):_e)||(le=oe["$[]"](Ne.racc_state["$[]"](-1)));g(le=Ne.$_racc_evalact(le,i)););}).$$s=Ae,Le.$$arity=2,Le))}).$$s=this,ne.$$arity=0,ne))},m.$$arity=4),e.def(u,"$_racc_evalact",o=function(J,re){var i,K,oe,he,A=this,ne=t,$e=t,xe=t,fe=t,we=t,le=t,De=t,me=t,Ae=t,Ke=t;if(ne=null==(i=e.to_ary(re))[0]?t:i[0],$e=null==i[1]?t:i[1],xe=null==i[3]?t:i[3],oe=null==i[11]?t:i[11],fe=null==i[12]?t:i[12],g(g(he=_(J,0))?U(J,oe):he))g(_(A.racc_error_status,0))&&(A.racc_t["$=="](1)||(A.racc_error_status=X(A.racc_error_status,1))),A.racc_vstack.$push(A.racc_val),A.racc_state.$push(J),A.racc_read_next=!0,g(A.yydebug)&&(A.racc_tstack.$push(A.racc_t),A.$racc_shift(A.racc_t,A.racc_tstack,A.racc_vstack));else if(g(g(we=U(J,0))?_(J,fe["$-@"]()):we)){if(le=j(A,"catch",["racc_jump"],((K=function(){var Le=null==K.$$s?this:K.$$s;return null==Le.racc_state&&(Le.racc_state=t),Le.racc_state.$push(Le.$_racc_do_reduce(re,J)),!1}).$$s=A,K.$$arity=0,K)),g(le)){if(1["$==="](De=le))return A.racc_user_yyerror=!0,fe["$-@"]();if(2["$==="](De))return oe;A.$raise("[Racc Bug] unknown jump code")}}else if(J["$=="](oe))g(A.yydebug)&&A.$racc_accept(),A.$throw("racc_end_parse",A.racc_vstack["$[]"](0));else{if(J["$=="](fe["$-@"]())){for((0)["$==="](De=A.racc_error_status)?g(re["$[]"](21))||A.$on_error(A.racc_t,A.racc_val,A.racc_vstack):3["$==="](De)&&(A.racc_t["$=="](0)&&A.$throw("racc_end_parse",t),A.racc_read_next=!0),A.racc_user_yyerror=!1,A.racc_error_status=3;g(!0)&&(!g(me=xe["$[]"](A.racc_state["$[]"](-1)))||(me=S(me,1),!g(g(Ae=g(Ke=r(me,0))?J=ne["$[]"](me):Ke)?$e["$[]"](me)["$=="](A.racc_state["$[]"](-1)):Ae)));)g(s(A.racc_state.$size(),1))&&A.$throw("racc_end_parse",t),A.racc_state.$pop(),A.racc_vstack.$pop(),g(A.yydebug)&&(A.racc_tstack.$pop(),A.$racc_e_pop(A.racc_state,A.racc_tstack,A.racc_vstack));return J}A.$raise("[Racc Bug] unknown action "+J.$inspect())}return g(A.yydebug)&&A.$racc_next_state(A.racc_state["$[]"](-1),A.racc_state),t},o.$$arity=2),e.def(u,"$_racc_do_reduce",p=function(J,re){var i,oe,he,Ke,Me,Le,Ne,K=this,ne=t,$e=t,ce=t,xe=t,fe=t,we=t,le=t,De=t,me=t,Ae=t,Ge=t,He=t,Fe=t,Ee=t,ue=t,ke=t;return ne=null==(i=e.to_ary(J))[4]?t:i[4],$e=null==i[5]?t:i[5],ce=null==i[6]?t:i[6],xe=null==i[7]?t:i[7],oe=null==i[8]?t:i[8],fe=null==i[9]?t:i[9],he=null==i[13]?t:i[13],we=K.racc_state,le=K.racc_vstack,De=K.racc_tstack,me=function(q,R){return"number"==typeof q?-3*q:q["$*"](-3)}(re),Ae=fe["$[]"](me),Ke=fe["$[]"](S(me,1)),Me=fe["$[]"](S(me,2)),Le=[],g(K.yydebug)&&(Ge=De["$[]"](Ae["$-@"](),Ae)),He=le["$[]"](Ae["$-@"](),Ae),g(K.yydebug)&&(Fe=[Ae["$-@"](),Ae,Le],j(De,"[]=",e.to_a(Fe)),X(Fe.length,1)),Fe=[Ae["$-@"](),Ae,Le],j(le,"[]=",e.to_a(Fe)),X(Fe.length,1),Fe=[Ae["$-@"](),Ae,Le],j(we,"[]=",e.to_a(Fe)),X(Fe.length,1),g(he)?le.$push(K.$__send__(Me,He,le,He["$[]"](0))):le.$push(K.$__send__(Me,He,le)),De.$push(Ke),g(K.yydebug)&&K.$racc_reduce(Ge,Ke,De,le),Ne=X(Ke,oe),g(me=xe["$[]"](Ne))&&(me=S(me,we["$[]"](-1)),g(g(Ee=g(ue=r(me,0))?ke=ne["$[]"](me):ue)?$e["$[]"](me)["$=="](Ne):Ee))?ke:ce["$[]"](Ne)},p.$$arity=2),e.def(u,"$on_error",v=function(J,re,i){var K,H=this;return H.$raise($(x,"ParseError"),H.$sprintf("\nparse error on value %s (%s)",re.$inspect(),g(K=H.$token_to_str(J))?K:"?"))},v.$$arity=3),e.def(u,"$yyerror",y=function(){return this.$throw("racc_jump",1)},y.$$arity=0),e.def(u,"$yyaccept",a=function(){return this.$throw("racc_jump",2)},a.$$arity=0),e.def(u,"$yyerrok",k=function(){return this.racc_error_status=0},k.$$arity=0),e.def(u,"$racc_read_token",N=function(J,re,i){var H=this;return H.racc_debug_out.$print("read    "),H.racc_debug_out.$print(re.$inspect(),"(",H.$racc_token2str(J),") "),H.racc_debug_out.$puts(i.$inspect()),H.racc_debug_out.$puts()},N.$$arity=3),e.def(u,"$racc_shift",O=function(J,re,i){var H=this;return H.racc_debug_out.$puts("shift   "+H.$racc_token2str(J)),H.$racc_print_stacks(re,i),H.racc_debug_out.$puts()},O.$$arity=3),e.def(u,"$racc_reduce",te=function(J,re,i,H){var K,A=this,ne=t;return(ne=A.racc_debug_out).$print("reduce "),g(J["$empty?"]())?ne.$print(" <none>"):j(J,"each",[],((K=function(ce){return null==ce&&(ce=t),ne.$print(" ",(null==K.$$s?this:K.$$s).$racc_token2str(ce))}).$$s=A,K.$$arity=1,K)),ne.$puts(" --\x3e "+A.$racc_token2str(re)),A.$racc_print_stacks(i,H),A.racc_debug_out.$puts()},te.$$arity=4),e.def(u,"$racc_accept",de=function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},de.$$arity=0),e.def(u,"$racc_e_pop",ve=function(J,re,i){var H=this;return H.racc_debug_out.$puts("error recovering mode: pop token"),H.$racc_print_states(J),H.$racc_print_stacks(re,i),H.racc_debug_out.$puts()},ve.$$arity=3),e.def(u,"$racc_next_state",ge=function(J,re){var i=this;return i.racc_debug_out.$puts("goto    "+J),i.$racc_print_states(re),i.racc_debug_out.$puts()},ge.$$arity=2),e.def(u,"$racc_print_stacks",qe=function(J,re){var i,K=t;return(K=this.racc_debug_out).$print("        ["),j(J,"each_index",[],((i=function(ne){return null==ne&&(ne=t),K.$print(" (",(null==i.$$s?this:i.$$s).$racc_token2str(J["$[]"](ne))," ",re["$[]"](ne).$inspect(),")")}).$$s=this,i.$$arity=1,i)),K.$puts(" ]")},qe.$$arity=2),e.def(u,"$racc_print_states",Re=function(J){var re,H=t;return(H=this.racc_debug_out).$print("        ["),j(J,"each",[],((re=function(A){return null==A&&(A=t),H.$print(" ",A)}).$$s=this,re.$$arity=1,re)),H.$puts(" ]")},Re.$$arity=1),e.def(u,"$racc_token2str",ze=function(J){var i;return g(i=C(this.$class(),"Racc_token_to_s_table")["$[]"](J))?i:this.$raise("[Racc Bug] can't convert token "+J+" to string")},ze.$$arity=1),e.def(u,"$token_to_str",Te=function(J){return C(this.$class(),"Racc_token_to_s_table")["$[]"](J)},Te.$$arity=1)}(D[0],D)},Opal.modules["bcdice/arithmetic/node"]=function(e){function U(D,t){return"number"==typeof D&&"number"==typeof t?D/t:D["$/"](t)}var t,M,q,W,L,h,u,x,E,c,l,b,n,f,Z,w,$,S=[],r=e.nil,_=e.$$$,s=e.$$,Y=e.module,d=e.klass,I=e.send2;return t=S,M=$=[Y(S[0],"BCDice")].concat(t),q=w=[Y($[0],"Arithmetic")].concat(M),function(W,L,h){var u,x,E,c,l,n=d(W,null,"BinaryOp");[n].concat(h),n.$$prototype.lhs=n.$$prototype.rhs=n.$$prototype.op=r,e.def(n,"$initialize",u=function(B,Q,T){var m=this;return m.lhs=B,m.op=Q,m.rhs=T},u.$$arity=3),e.def(n,"$eval",x=function(B){var m,Q=this,T=r;return T=Q.lhs.$eval(B),m=Q.rhs.$eval(B),T.$send(Q.op,m)},x.$$arity=1),e.def(n,"$output",E=function(){var B=this;return""+B.lhs.$output()+B.op+B.rhs.$output()},E.$$arity=0),e.def(n,"$s_exp",c=function(){var B=this;return"("+B.$op_for_s_exp()+" "+B.lhs.$s_exp()+" "+B.rhs.$s_exp()+")"},c.$$arity=0),e.def(n,"$op_for_s_exp",l=function(){return this.op},l.$$arity=0)}((Z=[Y(w[0],"Node")].concat(q))[0],0,Z),W=Z[0],L=s(Z,"BinaryOp"),h=Z,n=d(W,L,"DivideBase"),f=[n].concat(h),n.$$prototype.lhs=n.$$prototype.rhs=n.$$prototype.op=r,e.def(n,"$initialize",u=function(Q,T){return u.$$p&&(u.$$p=null),I(this,e.find_super_dispatcher(this,"initialize",u,!1,!0),"initialize",[Q,"/",T],null)},u.$$arity=2),e.def(n,"$eval",x=function(Q){var m,T=this,o=r;return m=T.lhs.$eval(Q),(o=T.rhs.$eval(Q))["$=="](0)&&T.$raise(s(f,"ZeroDivisionError")),T.$divide_and_round(m,o,Q)},x.$$arity=1),e.def(n,"$output",E=function(){var Q=E.$$p,m=this,o=r,p=r,v=r;for(Q&&(E.$$p=null),p=0,v=arguments.length,o=new Array(v);p<v;p++)o[p]=arguments[p];return""+I(m,e.find_super_dispatcher(m,"output",E,!1,!0),"output",o,Q)+m.$rounding_method()},E.$$arity=0),n.$private(),e.def(n,"$rounding_method",c=function(){return _(this.$class(),"ROUNDING_METHOD")},c.$$arity=0),e.def(n,"$op_for_s_exp",l=function(){return""+this.op+this.$rounding_method()},l.$$arity=0),e.def(n,"$divide_and_round",b=function(Q,T,m){return this.$raise(s(f,"NotImplementedError"))},b.$$arity=3),function(W,L,h){var u,n=d(W,L,"DivideWithGameSystemDefault"),f=[n].concat(h);e.const_set(f[0],"ROUNDING_METHOD",""),n.$private(),e.def(n,"$divide_and_round",u=function(E,c,l){var B;return B=l,_(s(f,"RoundType"),"CEIL")["$==="](B)?U(E.$to_f(),c).$ceil():_(s(f,"RoundType"),"ROUND")["$==="](B)?U(E.$to_f(),c).$round():U(E,c).$to_i()},u.$$arity=3)}(Z[0],s(Z,"DivideBase"),Z),function(W,L,h){var u,n=d(W,L,"DivideWithCeil"),f=[n].concat(h);e.const_set(f[0],"ROUNDING_METHOD","C"),n.$private(),e.def(n,"$divide_and_round",u=function(E,c,l){return U(E.$to_f(),c).$ceil()},u.$$arity=3)}(Z[0],s(Z,"DivideBase"),Z),function(W,L,h){var u,n=d(W,L,"DivideWithRound"),f=[n].concat(h);e.const_set(f[0],"ROUNDING_METHOD","R"),n.$private(),e.def(n,"$divide_and_round",u=function(E,c,l){return U(E.$to_f(),c).$round()},u.$$arity=3)}(Z[0],s(Z,"DivideBase"),Z),function(W,L,h){var u,n=d(W,L,"DivideWithFloor"),f=[n].concat(h);e.const_set(f[0],"ROUNDING_METHOD","F"),n.$private(),e.def(n,"$divide_and_round",u=function(E,c,l){return U(E,c).$to_i()},u.$$arity=3)}(Z[0],s(Z,"DivideBase"),Z),function(W,L,h){var u,x,E,c,n=d(W,null,"Negative");[n].concat(h),n.$$prototype.body=r,e.def(n,"$initialize",u=function(b){return this.body=b},u.$$arity=1),e.def(n,"$eval",x=function(b){return this.body.$eval(b)["$-@"]()},x.$$arity=1),e.def(n,"$output",E=function(){return"-"+this.body.$output()},E.$$arity=0),e.def(n,"$s_exp",c=function(){return"(- "+this.body.$s_exp()+")"},c.$$arity=0)}(Z[0],0,Z),function(W,L,h){var u,x,E,c,n=d(W,null,"Parenthesis");[n].concat(h),n.$$prototype.expr=r,e.def(n,"$initialize",u=function(b){return this.expr=b},u.$$arity=1),e.def(n,"$eval",x=function(b){return this.expr.$eval(b)},x.$$arity=1),e.def(n,"$output",E=function(){return"("+this.expr.$output()+")"},E.$$arity=0),e.def(n,"$s_exp",c=function(){return"(Parenthesis "+this.expr.$s_exp()+")"},c.$$arity=0)}(Z[0],0,Z),void function(W,L,h){var u,x,E,n=d(W,null,"Number");[n].concat(h),n.$$prototype.value=r,e.def(n,"$initialize",u=function(l){return this.value=l},u.$$arity=1),e.def(n,"$eval",x=function(l){return this.value},x.$$arity=1),e.def(n,"$output",E=function(){return this.value.$to_s()},E.$$arity=0),e.alias(n,"s_exp","output")}(Z[0],0,Z)},Opal.modules.strscan=function(e){var C,M,g,w,j,q,R,Z,W,L,h,n,f,u,x,E,c,l,b,B,Q,T,m,o,p,v,$,P,S=[],r=e.nil,s=e.$$,d=e.truthy,I=e.send;return C=S,$=(0,e.klass)(S[0],null,"StringScanner"),P=[$].concat(C),$.$$prototype.pos=$.$$prototype.string=$.$$prototype.working=$.$$prototype.matched=$.$$prototype.prev_pos=$.$$prototype.match=r,$.$attr_reader("pos"),$.$attr_reader("matched"),e.def($,"$initialize",M=function(a){var k=this;return k.string=a,k.pos=0,k.matched=r,k.working=a,k.match=[]},M.$$arity=1),$.$attr_reader("string"),e.def($,"$beginning_of_line?",g=function(){var a=this;return 0===a.pos||"\n"===a.string.charAt(a.pos-1)},g.$$arity=0),e.alias($,"bol?","beginning_of_line?"),e.def($,"$scan",w=function(a){var k=this,N=(a=k.$anchor(a)).exec(k.working);return null==N?k.matched=r:"object"==typeof N?(k.prev_pos=k.pos,k.pos+=N[0].length,k.working=k.working.substring(N[0].length),k.matched=N[0],k.match=N,N[0]):"string"==typeof N?(k.pos+=N.length,k.working=k.working.substring(N.length),N):r},w.$$arity=1),e.def($,"$scan_until",j=function(a){var k=this;a=k.$anchor(a);for(var te,N=k.pos,O=k.working;;){if(te=a.exec(O),N+=1,O=O.substr(1),null!=te)return k.matched=k.string.substr(k.pos,N-k.pos-1+te[0].length),k.match=te,k.prev_pos=N-1,k.pos=N,k.working=O.substr(te[0].length),k.matched;if(0===O.length)return k.match=[],k.matched=r}},j.$$arity=1),e.def($,"$[]",q=function(a){var N;if(d(this.match["$empty?"]()))return r;N=a,s(P,"Symbol")["$==="](N)?a=a.$to_s():s(P,"String")["$==="](N)||(a=s(P,"Opal")["$coerce_to!"](a,s(P,"Integer"),"to_int"));var O=this.match;return a<0&&(a+=O.length),a<0||a>=O.length||null==O[a]?r:O[a]},q.$$arity=1),e.def($,"$check",R=function(a){var k=this,N=(a=k.$anchor(a)).exec(k.working);return k.matched=null==N?r:N[0]},R.$$arity=1),e.def($,"$check_until",Z=function(a){var k=this,N=k.prev_pos,O=k.pos,te=k.$scan_until(a);return te!==r&&(k.matched=te.substr(-1),k.working=k.string.substr(O)),k.prev_pos=N,k.pos=O,te},Z.$$arity=1),e.def($,"$peek",W=function(a){return this.working.substring(0,a)},W.$$arity=1),e.def($,"$eos?",L=function(){return 0===this.working.length},L.$$arity=0),e.def($,"$exist?",h=function(a){var N=a.exec(this.working);return null==N?r:0==N.index?0:N.index+1},h.$$arity=1),e.def($,"$skip",n=function(a){var k=this,N=(a=k.$anchor(a)).exec(k.working);if(null==N)return k.match=[],k.matched=r;var O=N[0],te=O.length;return k.matched=O,k.match=N,k.prev_pos=k.pos,k.pos+=te,k.working=k.working.substring(te),te},n.$$arity=1),e.def($,"$skip_until",f=function(a){var N=this.$scan_until(a);return N===r?r:(this.matched=N.substr(-1),N.length)},f.$$arity=1),e.def($,"$get_byte",u=function(){var a=this,k=r;return a.pos<a.string.length?(a.prev_pos=a.pos,a.pos+=1,k=a.matched=a.working.substring(0,1),a.working=a.working.substring(1)):a.matched=r,k},u.$$arity=0),e.alias($,"getch","get_byte"),e.def($,"$match?",x=function(a){var k=this,N=(a=k.$anchor(a)).exec(k.working);return null==N?r:(k.prev_pos=k.pos,N[0].length)},x.$$arity=1),e.def($,"$pos=",E=function(a){var k=this;return a<0&&(a+=k.string.$length()),k.pos=a,k.working=k.string.slice(a)},E.$$arity=1),e.def($,"$matched_size",c=function(){return this.matched===r?r:this.matched.length},c.$$arity=0),e.def($,"$post_match",l=function(){var a=this;return a.matched===r?r:a.string.substr(a.pos)},l.$$arity=0),e.def($,"$pre_match",b=function(){var a=this;return a.matched===r?r:a.string.substr(0,a.prev_pos)},b.$$arity=0),e.def($,"$reset",B=function(){var a=this;return a.working=a.string,a.matched=r,a.pos=0},B.$$arity=0),e.def($,"$rest",Q=function(){return this.working},Q.$$arity=0),e.def($,"$rest?",T=function(){return 0!==this.working.length},T.$$arity=0),e.def($,"$rest_size",m=function(){return this.$rest().$size()},m.$$arity=0),e.def($,"$terminate",o=function(){var k,a=this;return a.match=r,k=[a.string.$length()],I(a,"pos=",e.to_a(k)),k[function(D,t){return"number"==typeof D?D-1:D["$-"](1)}(k.length)]},o.$$arity=0),e.def($,"$unscan",p=function(){var a=this;return a.pos=a.prev_pos,a.prev_pos=r,a.match=r,a},p.$$arity=0),$.$private(),e.def($,"$anchor",v=function(a){var N=a.toString().match(/\/([^\/]+)$/);return N=N?N[1]:void 0,new RegExp("^(?:"+a.source+")",N)},v.$$arity=1),r&&"anchor"},Opal.modules["bcdice/normalize"]=function(e){var C,M,g,$,d,D,X=[],S=e.nil,s=e.module;return d=X,C=D=[s(X[0],"BCDice")].concat(d),[$=s(D[0],"Normalize")].concat(C),$.$module_function(),e.def($,"$comparison_operator",M=function(j){var R;return/<=|=</["$==="](R=j)?"<=":/>=|=>/["$==="](R)?">=":/<>|!=|=!/["$==="](R)?"!=":/</["$==="](R)?"<":/>/["$==="](R)?">":/=/["$==="](R)?"==":S},M.$$arity=1),void e.def($,"$target_number",g=function(j){return j["$=="]("?")?j:j.$to_i()},g.$$arity=1)},Opal.modules["bcdice/command/lexer"]=function(e){var C,g,Z,h,n,f,W,L,j,P,U=e.top,X=[],S=e.nil,_=e.$$,s=e.module,Y=e.klass,d=e.hash2,I=e.truthy,D=e.send;return U.$require("strscan"),U.$require("bcdice/normalize"),C=X,g=P=[s(X[0],"BCDice")].concat(C),Z=j=[s(P[0],"Command")].concat(g),W=Y(j[0],null,"Lexer"),L=[W].concat(Z),W.$$prototype.scanner=W.$$prototype.notations=S,e.const_set(L[0],"SYMBOLS",d(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),e.def(W,"$initialize",h=function(x,E){var c,l,b,Q,B=this;return x=I(Q=(l=(c=x)===S||null==c?S:D(c,"split",[" ",2]))===S||null==l?S:D(l,"first",[]))?Q:"",B.scanner=_(L,"StringScanner").$new(x),B.notations=D(E,"map",[],((b=function(T){function m(o){return T.apply(this,arguments)}return m.toString=function(){return T.toString()},m}(function(T){return null==T&&(T=S),I(T["$is_a?"](_(L,"String")))?_(L,"Regexp").$new(T):T})).$$s=B,b.$$arity=1,b))},h.$$arity=2),e.def(W,"$next_token",n=function(){try{var x,E=this,c=S,l=S,B=S,Q=S;return I(E.scanner["$eos?"]())?[!1,"$"]:(D(E.notations,"each",[],((x=function(m){var p,o=null==x.$$s?this:x.$$s;if(null==o.scanner&&(o.scanner=S),null==m&&(m=S),p=o.scanner.$scan(m),!I(p))return S;e.ret(["NOTATION",p])}).$$s=E,x.$$arity=1,x)),I(c=E.scanner.$scan(/\d+/))?["NUMBER",c.$to_i()]:I(l=E.scanner.$scan(/[<>!=]+/))?(l=_(L,"Normalize").$comparison_operator(l),[I(l)?"CMP_OP":"ILLEGAL",l]):(B=E.scanner.$getch().$upcase(),[I(Q=_(L,"SYMBOLS")["$[]"](B))?Q:B.$to_sym(),B]))}catch(T){if(T===e.returner)return T.$v;throw T}},n.$$arity=0),void e.def(W,"$source",f=function(){return this.scanner.$string()},f.$$arity=0)},Opal.modules["bcdice/command/parsed"]=function(e){var D,P,q,W,L,h,R,Z,g,C,X=[],S=e.nil,_=e.$$,s=e.module,Y=e.klass,d=e.truthy;return D=X,P=C=[s(X[0],"BCDice")].concat(D),q=g=[s(C[0],"Command")].concat(P),R=Y(g[0],null,"Parsed"),Z=[R].concat(q),R.$$prototype.question_target=R.$$prototype.critical=R.$$prototype.fumble=R.$$prototype.dollar=R.$$prototype.modify_number=R.$$prototype.target_number=R.$$prototype.prefix_number=R.$$prototype.command=R.$$prototype.suffix_number=R.$$prototype.cmp_op=S,R.$attr_accessor("command"),R.$attr_accessor("prefix_number"),R.$attr_accessor("suffix_number"),R.$attr_accessor("critical"),R.$attr_accessor("fumble"),R.$attr_accessor("dollar"),R.$attr_accessor("modify_number"),R.$attr_accessor("cmp_op"),R.$attr_accessor("target_number"),R.$attr_writer("question_target"),e.def(R,"$initialize",W=function(){var f=this;return f.prefix_number=S,f.suffix_number=S,f.critical=S,f.fumble=S,f.dollar=S,f.cmp_op=S,f.target_number=S,f.question_target=!1},W.$$arity=0),e.def(R,"$question_target?",L=function(){return this.question_target},L.$$arity=0),void e.def(R,"$to_s",h=function(f){var B,u=this,x=S,E=S,c=S,l=S,b=S;return null==f&&(f="after_command"),x=d(u.critical)?"@"+u.critical:S,E=d(u.fumble)?"#"+u.fumble:S,c=d(u.dollar)?"$"+u.dollar:S,l=_(Z,"Format").$modifier(u.modify_number),b=d(u.question_target)?"?":u.target_number,"after_command"["$==="](B=f)?[u.prefix_number,u.command,u.suffix_number,x,E,c,l,u.cmp_op,b].$join():"after_modify_number"["$==="](B)?[u.prefix_number,u.command,u.suffix_number,l,x,E,c,u.cmp_op,b].$join():"after_target_number"["$==="](B)?[u.prefix_number,u.command,u.suffix_number,l,u.cmp_op,b,x,E,c].$join():S},h.$$arity=-1)},Opal.modules["bcdice/command/parser"]=function(e){function U(P,M){return"number"==typeof P&&"number"==typeof M?P-M:P["$-"](M)}var M,q,W,L,h,u,x,E,c,l,b,B,Q,T,m,o,p,v,y,a,k,N,O,te,de,ve,ge,qe,Re,ze,Te,be,J,re,i,H,K,A,ne,$e,ce,xe,oe,fe,he,we,le,De,me,Ae,Ke,Me,Le,Ge,He,Fe,Ne,Ee,ue,ke,ye,n,f,Z,w,X=e.top,S=[],r=e.nil,_=e.$$$,s=e.$$,Y=e.klass,d=e.module,I=e.hash2,D=e.send2,t=e.send,C=e.hash,$=e.truthy;return X.$require("racc/parser.rb"),X.$require("bcdice/arithmetic/node"),X.$require("bcdice/command/lexer"),X.$require("bcdice/command/parsed"),function(P,M,g){[Y(P,M,"Parser")].concat(g)}(_(s(S,"BCDice"),"Command"),_(s(S,"Racc"),"Parser"),S),M=S,q=w=[d(S[0],"BCDice")].concat(M),W=(Z=[d(w[0],"Command")].concat(q))[0],L=_(s(Z,"Racc"),"Parser"),h=Z,n=Y(W,L,"Parser"),f=[n].concat(h),n.$$prototype.notations=n.$$prototype.lexer=n.$$prototype.modifier=n.$$prototype.prefix_number=n.$$prototype.suffix_number=n.$$prototype.need_suffix_number=n.$$prototype.need_prefix_number=n.$$prototype.critical=n.$$prototype.fumble=n.$$prototype.dollar=n.$$prototype.allowed_cmp_op=n.$$prototype.question_target=r,e.def(n,"$initialize",u=function(z,ie){var F,V,se,Ie,Ce=u.$$p,Se=this;if(Ce&&(u.$$p=null),F=e.slice.call(arguments,0,arguments.length),null==(V=e.extract_kwargs(F)))V=I([],{});else if(!V.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(se=F,!e.hasOwnProperty.call(V.$$smap,"round_type"))throw e.ArgumentError.$new("missing keyword: round_type");return Ie=V.$$smap.round_type,D(Se,e.find_super_dispatcher(Se,"initialize",u,!1,!0),"initialize",[],null),Se.notations=se,Se.round_type=Ie,Se.prefix_number=!1,Se.suffix_number=!1,Se.need_prefix_number=!1,Se.need_suffix_number=!1,Se.modifier=!0,Se.critical=!1,Se.fumble=!1,Se.dollar=!1,Se.allowed_cmp_op=[r,">=",">","<=","<","==","!="],Se.question_target=!1},u.$$arity=-2),e.def(n,"$disable_modifier",x=function(){return this.modifier=!1,this},x.$$arity=0),e.def(n,"$enable_prefix_number",E=function(){return this.prefix_number=!0,this},E.$$arity=0),e.def(n,"$enable_suffix_number",c=function(){return this.suffix_number=!0,this},c.$$arity=0),e.def(n,"$has_prefix_number",l=function(){var z=this;return z.prefix_number=!0,z.need_prefix_number=!0,z},l.$$arity=0),e.def(n,"$has_suffix_number",b=function(){var z=this;return z.suffix_number=!0,z.need_suffix_number=!0,z},b.$$arity=0),e.def(n,"$enable_critical",B=function(){return this.critical=!0,this},B.$$arity=0),e.def(n,"$enable_fumble",Q=function(){return this.fumble=!0,this},Q.$$arity=0),e.def(n,"$enable_dollar",T=function(){return this.dollar=!0,this},T.$$arity=0),e.def(n,"$restrict_cmp_op_to",m=function(z){var ie,V=this;return ie=e.slice.call(arguments,0,arguments.length),V.allowed_cmp_op=ie,V},m.$$arity=-1),e.def(n,"$enable_question_target",o=function(){return this.question_target=!0,this},o.$$arity=0),e.def(n,"$parse",p=function(z){try{return this.lexer=s(f,"Lexer").$new(z,this.notations),this.$do_parse()}catch(F){if(!e.rescue(F,[s(f,"ParseError"),s(f,"ZeroDivisionError")]))throw F;try{return r}finally{e.pop_exception()}}},p.$$arity=1),n.$private(),e.def(n,"$parsed",v=function(z,ie,F,V){var se;return t(s(f,"Parsed").$new(),"tap",[],((se=function(Be){var We,Ue,je,Ye,Ve,Qe,Se=null==se.$$s?this:se.$$s,pe=r;return null==Se.round_type&&(Se.round_type=r),null==Be&&(Be=r),pe=[z["$[]"]("command")],t(Be,"command=",e.to_a(pe)),U(pe.length,1),pe=[(We=z["$[]"]("prefix"),We===r||null==We?r:t(We,"eval",[Se.round_type]))],t(Be,"prefix_number=",e.to_a(pe)),U(pe.length,1),pe=[(Ue=z["$[]"]("suffix"),Ue===r||null==Ue?r:t(Ue,"eval",[Se.round_type]))],t(Be,"suffix_number=",e.to_a(pe)),U(pe.length,1),pe=[(je=ie["$[]"]("critical"),je===r||null==je?r:t(je,"eval",[Se.round_type]))],t(Be,"critical=",e.to_a(pe)),U(pe.length,1),pe=[(Ye=ie["$[]"]("fumble"),Ye===r||null==Ye?r:t(Ye,"eval",[Se.round_type]))],t(Be,"fumble=",e.to_a(pe)),U(pe.length,1),pe=[(Ve=ie["$[]"]("dollar"),Ve===r||null==Ve?r:t(Ve,"eval",[Se.round_type]))],t(Be,"dollar=",e.to_a(pe)),U(pe.length,1),pe=[F.$eval(Se.round_type)],t(Be,"modify_number=",e.to_a(pe)),U(pe.length,1),pe=[V["$[]"]("cmp_op")],t(Be,"cmp_op=",e.to_a(pe)),U(pe.length,1),V["$[]"]("target")["$=="]("?")?(t(Be,"question_target=",e.to_a(pe=[!0])),U(pe.length,1),t(Be,"target_number=",e.to_a(pe=[0])),pe[U(pe.length,1)]):(t(Be,"question_target=",e.to_a(pe=[!1])),U(pe.length,1),pe=[(Qe=V["$[]"]("target"),Qe===r||null==Qe?r:t(Qe,"eval",[Se.round_type]))],t(Be,"target_number=",e.to_a(pe)),pe[U(pe.length,1)])}).$$s=this,se.$$arity=1,se))},v.$$arity=4),e.def(n,"$next_token",y=function(){return this.lexer.$next_token()},y.$$arity=0),Me=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,33,34,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,r,r,17,18,6,r,5,r,r,17,18,r,r,5,23,24,25,26,56,54,55,57],Le=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,r,17,15,15,18,18,23,r,18,30,30,23,23,24,r,23,31,31,24,24,25,r,24,44,44,25,25,28,r,25,47,47,28,28,29,r,28,48,48,29,29,33,r,29,49,49,33,33,34,r,33,50,50,34,34,36,r,34,r,r,36,36,37,r,36,r,r,37,37,r,r,37,27,27,27,27,52,52,52,52],Ge=[-2,4,16,-3,-1,11,r,33,13,35,23,30,1,r,28,40,r,37,44,r,r,-2,r,51,58,65,0,106,72,79,47,54,r,86,93,r,100,107,r,r,r,r,r,r,63,r,r,68,75,82,89,r,120,r,r,r,r,r],He=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],Fe=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,r,r,21,47,48,40,51,52,49,50,44,46,3,r,r,r,13,r,r,r,r,r,r,r,32],Ne=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,r,r,4,8,8,5,7,7,8,8,9,5,6,r,r,r,6,r,r,r,r,r,r,r,6],Ee=[r,6,13,3,9,-1,27,-15,-10,-1,-38],ue=[r,r,r,r,r,r,19,16,15,r,r],ke=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],ye=C(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),e.const_set(f[0],"Racc_arg",[Me,Le,He,Ge,Fe,Ne,ue,Ee,19,ke,ye,58,35,!0]),e.const_set(f[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),e.const_set(f[0],"Racc_debug_parser",!1),e.def(n,"$_reduce_1",a=function(z,ie,F){var V;return $(this.modifier)||this.$raise(s(f,"ParseError")),V=e.to_ary(z),this.$parsed(null==V[0]?r:V[0],null==V[1]?r:V[1],null==V[2]?r:V[2],null==V[3]?r:V[3])},a.$$arity=3),e.def(n,"$_reduce_2",k=function(z,ie,F){var V;return $(this.modifier)||this.$raise(s(f,"ParseError")),V=e.to_ary(z),this.$parsed(null==V[0]?r:V[0],null==V[2]?r:V[2],null==V[1]?r:V[1],null==V[3]?r:V[3])},k.$$arity=3),e.def(n,"$_reduce_3",N=function(z,ie,F){var V,Se;return Se=null==(V=e.to_ary(z))[2]?r:V[2],this.$parsed(null==V[0]?r:V[0],null==V[1]?r:V[1],_(_(s(f,"Arithmetic"),"Node"),"Number").$new(0),Se)},N.$$arity=3),e.def(n,"$_reduce_4",O=function(z,ie,F){var se,V=this;return $($(se=V.prefix_number)?V.suffix_number:se)||V.$raise(s(f,"ParseError")),I(["command","prefix","suffix"],{command:z["$[]"](1),prefix:z["$[]"](0),suffix:z["$[]"](2)})},O.$$arity=3),e.def(n,"$_reduce_5",te=function(z,ie,F){var V=this;return $(V.prefix_number)||V.$raise(s(f,"ParseError")),$(V.need_suffix_number)&&V.$raise(s(f,"ParseError")),I(["command","prefix"],{command:z["$[]"](1),prefix:z["$[]"](0)})},te.$$arity=3),e.def(n,"$_reduce_6",de=function(z,ie,F){var V=this;return $(V.suffix_number)||V.$raise(s(f,"ParseError")),$(V.need_prefix_number)&&V.$raise(s(f,"ParseError")),I(["command","suffix"],{command:z["$[]"](0),suffix:z["$[]"](1)})},de.$$arity=3),e.def(n,"$_reduce_7",ve=function(z,ie,F){var se,V=this;return $($(se=V.need_prefix_number)?se:V.need_suffix_number)&&V.$raise(s(f,"ParseError")),I(["command"],{command:z["$[]"](0)})},ve.$$arity=3),e.def(n,"$_reduce_8",ge=function(z,ie,F){return I([],{})},ge.$$arity=3),e.def(n,"$_reduce_9",qe=function(z,ie,F){var V,Se,Ue,We,Ce=r;return Ce=null==(V=e.to_ary(z))[0]?r:V[0],Se=null==V[2]?r:V[2],$($(We=this.critical)?Ce["$[]"]("critical")["$nil?"]():We)||this.$raise(s(f,"ParseError")),t(Ce,"[]=",e.to_a(Ue=["critical",Se])),U(Ue.length,1),Ce},qe.$$arity=3),e.def(n,"$_reduce_10",Re=function(z,ie,F){var V,Se,Ue,We,Ce=r;return Ce=null==(V=e.to_ary(z))[0]?r:V[0],Se=null==V[2]?r:V[2],$($(We=this.fumble)?Ce["$[]"]("fumble")["$nil?"]():We)||this.$raise(s(f,"ParseError")),t(Ce,"[]=",e.to_a(Ue=["fumble",Se])),U(Ue.length,1),Ce},Re.$$arity=3),e.def(n,"$_reduce_11",ze=function(z,ie,F){var V,Se,Ue,We,Ce=r;return Ce=null==(V=e.to_ary(z))[0]?r:V[0],Se=null==V[2]?r:V[2],$($(We=this.dollar)?Ce["$[]"]("dollar")["$nil?"]():We)||this.$raise(s(f,"ParseError")),t(Ce,"[]=",e.to_a(Ue=["dollar",Se])),U(Ue.length,1),Ce},ze.$$arity=3),e.def(n,"$_reduce_12",Te=function(z,ie,F){return z["$[]"](1)},Te.$$arity=3),e.def(n,"$_reduce_13",be=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"Negative").$new(z["$[]"](1))},be.$$arity=3),e.def(n,"$_reduce_14",J=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"+",z["$[]"](2))},J.$$arity=3),e.def(n,"$_reduce_15",re=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"-",z["$[]"](2))},re.$$arity=3),e.def(n,"$_reduce_16",i=function(z,ie,F){return $(this.allowed_cmp_op["$include?"](r))||this.$raise(s(f,"ParseError")),I([],{})},i.$$arity=3),e.def(n,"$_reduce_17",H=function(z,ie,F){var V,Ce,Be;return Be=null==(V=e.to_ary(z))[1]?r:V[1],$(this.allowed_cmp_op["$include?"](Ce=null==V[0]?r:V[0]))||this.$raise(s(f,"ParseError")),I(["cmp_op","target"],{cmp_op:Ce,target:Be})},H.$$arity=3),e.def(n,"$_reduce_18",K=function(z,ie,F){var se,V=this;return se=z["$[]"](0),$(V.question_target)||V.$raise(s(f,"ParseError")),$(V.allowed_cmp_op["$include?"](se))||V.$raise(s(f,"ParseError")),I(["cmp_op","target"],{cmp_op:se,target:"?"})},K.$$arity=3),e.def(n,"$_reduce_19",A=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"+",z["$[]"](2))},A.$$arity=3),e.def(n,"$_reduce_20",ne=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"-",z["$[]"](2))},ne.$$arity=3),e.def(n,"$_reduce_22",$e=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"*",z["$[]"](2))},$e.$$arity=3),e.def(n,"$_reduce_23",ce=function(z,ie,F){return z["$[]"](3).$new(z["$[]"](0),z["$[]"](2))},ce.$$arity=3),e.def(n,"$_reduce_25",xe=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"DivideWithGameSystemDefault")},xe.$$arity=3),e.def(n,"$_reduce_26",oe=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"DivideWithCeil")},oe.$$arity=3),e.def(n,"$_reduce_27",fe=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"DivideWithCeil")},fe.$$arity=3),e.def(n,"$_reduce_28",he=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"DivideWithRound")},he.$$arity=3),e.def(n,"$_reduce_29",we=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"DivideWithFloor")},we.$$arity=3),e.def(n,"$_reduce_30",le=function(z,ie,F){return z["$[]"](1)},le.$$arity=3),e.def(n,"$_reduce_31",De=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"Negative").$new(z["$[]"](1))},De.$$arity=3),e.def(n,"$_reduce_33",me=function(z,ie,F){return z["$[]"](1)},me.$$arity=3),e.def(n,"$_reduce_34",Ae=function(z,ie,F){return _(_(s(f,"Arithmetic"),"Node"),"Number").$new(z["$[]"](0))},Ae.$$arity=3),void e.def(n,"$_reduce_none",Ke=function(z,ie,F){return z["$[]"](0)},Ke.$$arity=3)},Opal.modules["bcdice/deprecated/checker"]=function(e){var D,P,j,Z,W,L,h,n,f,q,R,g,C,X=[],S=e.nil,_=e.$$,s=e.module,Y=e.send,d=e.truthy;return D=X,P=C=[s(X[0],"BCDice")].concat(D),j=g=[s(C[0],"Deprecated")].concat(P),q=s(g[0],"Checker"),R=[q].concat(j),q.$private(),e.def(q,"$check_result_legacy",Z=function(x,E,c,l){var T,p,b=this,B=S,Q=S,m=S,o=S,v=S;return B=Y(E,"map",[],"sides".$to_proc()),T=(Q=Y(E,"map",[],"value".$to_proc())).$sum(),m=[100]["$==="](o=B)?b.$check_1D100(x,T,c,l):[20]["$==="](o)?b.$check_1D20(x,T,c,l):[6,6]["$==="](o)?b.$check_2D6(x,T,Q,c,l):S,d(d(p=m["$nil?"]())?p:m["$empty?"]())&&(o=B.$uniq(),m=[10]["$==="](o)?b.$check_nD10(x,T,Q,c,l):[6]["$==="](o)?b.$check_nD6(x,T,Q,c,l):S,d(d(v=m["$nil?"]())?v:m["$empty?"]()))?S:_(R,"Result").$new(m.$delete_prefix(" \uff1e "))},Z.$$arity=4),e.def(q,"$check_1D100",W=function(x,E,c,l){return S},W.$$arity=4),e.def(q,"$check_1D20",L=function(x,E,c,l){return S},L.$$arity=4),e.def(q,"$check_nD10",h=function(x,E,c,l,b){return S},h.$$arity=5),e.def(q,"$check_2D6",n=function(x,E,c,l,b){return S},n.$$arity=5),void e.def(q,"$check_nD6",f=function(x,E,c,l,b){return S},f.$$arity=5)},Opal.modules["bcdice/base"]=function(e){function U(w,j){return"number"==typeof w&&"number"==typeof j?w+j:w["$+"](j)}function X(w,j){return"number"==typeof w&&"number"==typeof j?w-j:w["$-"](j)}var j,L,f,u,x,E,c,l,b,B,Q,T,m,o,p,v,y,a,k,N,O,te,de,ve,ge,qe,Re,ze,Te,be,J,re,K,A,ne,$e,ce,H,h,n,R,s=e.top,Y=[],d=e.nil,I=e.$$$,D=e.$$,t=e.module,C=e.klass,$=e.truthy,P=e.send,M=e.range,g=d;return s.$require("i18n"),s.$require("i18n/backend/fallbacks"),s.$require("bcdice/randomizer"),s.$require("bcdice/dice_table"),s.$require("bcdice/enum"),s.$require("bcdice/translate"),s.$require("bcdice/result"),s.$require("bcdice/command/parser"),s.$require("bcdice/deprecated/checker"),j=Y,L=R=[t(Y[0],"BCDice")].concat(j),h=C(R[0],null,"Base"),n=[h].concat(L),h.$$prototype.sort_add_dice=h.$$prototype.sort_barabara_dice=h.$$prototype.enabled_d9=h.$$prototype.raw_input=h.$$prototype.randomizer=h.$$prototype.enabled_upcase_input=h.$$prototype.debug=d,re=e.get_singleton_class(h),H=[re].concat(n),re.$attr_reader("prefixes"),e.def(re,"$register_prefix",K=function(oe){var he,we=this,le=d;return null==we.prefixes&&(we.prefixes=d),he=e.slice.call(arguments,0,arguments.length),we.prefixes=$(le=we.prefixes)?le:[],we.prefixes.$concat(he.$flatten())},K.$$arity=-1),e.def(re,"$register_prefix_from_super_class",A=function(){return this.$register_prefix(this.$superclass().$prefixes())},A.$$arity=0),e.def(re,"$prefixes_pattern",ne=function(){var fe,oe=this,he=d;return null==oe.prefixes_pattern&&(oe.prefixes_pattern=d),null==oe.prefixes&&(oe.prefixes=d),oe.prefixes_pattern=$(fe=oe.prefixes_pattern)?fe:d,$(oe.prefixes_pattern)?oe.prefixes_pattern:(oe.prefixes=$(he=oe.prefixes)?he:[],oe.prefixes.$freeze(),oe.prefixes_pattern=($(oe.prefixes["$empty?"]())?/(?!)/:e.regexp(["^(S)?(",oe.prefixes.$join("|"),")"],"i")).$freeze())},ne.$$arity=0),e.def(re,"$command_pattern",$e=function(){var oe,he,fe=this,we=d,le=d;return null==fe.command_pattern&&(fe.command_pattern=d),null==fe.prefixes&&(fe.prefixes=d),fe.command_pattern=$(he=fe.command_pattern)?he:d,$(fe.command_pattern)?fe.command_pattern:(fe.prefixes=$(we=fe.prefixes)?we:[],fe.prefixes.$freeze(),le=U(P(I(D(H,"CommonCommand"),"COMMANDS"),"map",[],((oe=function(me){return null==me&&(me=d),I(me,"PREFIX_PATTERN").$source()}).$$s=fe,oe.$$arity=1,oe)),fe.prefixes),fe.command_pattern=e.regexp(["^S?(",le.$join("|"),")"],"i").$freeze())},$e.$$arity=0),e.def(re,"$eval",ce=function(oe){return this.$new(oe).$eval()},ce.$$arity=1),h.$include(D(n,"Translate")),h.$include(I(D(n,"Deprecated"),"Checker")),e.def(h,"$initialize",f=function(i){var H=this;return H.raw_input=i,H.sort_add_dice=!1,H.sort_barabara_dice=!1,H.d66_sort_type=I(D(n,"D66SortType"),"NO_SORT"),H.enabled_d9=!1,H.round_type=I(D(n,"RoundType"),"FLOOR"),H.sides_implicit_d=6,H.upper_dice_reroll_threshold=d,H.reroll_dice_reroll_threshold=d,H.default_cmp_op=d,H.default_target_number=d,H.enabled_upcase_input=!0,H.locale="ja_jp",H.randomizer=I(D(n,"BCDice"),"Randomizer").$new(),H.debug=!1},f.$$arity=1),h.$attr_accessor("randomizer"),h.$attr_reader("d66_sort_type"),h.$attr_reader("round_type"),h.$attr_reader("sides_implicit_d"),h.$attr_reader("upper_dice_reroll_threshold"),h.$attr_reader("reroll_dice_reroll_threshold"),h.$attr_reader("default_cmp_op"),h.$attr_reader("default_target_number"),e.def(h,"$sort_add_dice?",u=function(){return this.sort_add_dice},u.$$arity=0),e.def(h,"$sort_barabara_dice?",x=function(){return this.sort_barabara_dice},x.$$arity=0),e.def(h,"$enabled_d9?",E=function(){return this.enabled_d9},E.$$arity=0),e.def(h,"$enable_debug",c=function(){return this.debug=!0},c.$$arity=0),e.def(h,"$eval",l=function(){var H,K,A,i=this,ne=d;return H=I(D(n,"BCDice"),"Preprocessor").$process(i.raw_input,i),K=$(A=i.$dice_command(H))?A:i.$eval_common_command(i.raw_input),$(K)?(ne=[i.randomizer.$rand_results()],P(K,"rands=",e.to_a(ne)),X(ne.length,1),ne=[i.randomizer.$detailed_rand_results()],P(K,"detailed_rands=",e.to_a(ne)),X(ne.length,1),K):d},l.$$arity=0),e.def(h,"$change_text",b=function(i){return i},b.$$arity=1),e.def(h,"$check_result",B=function(i,H,K,A){var ne=this,$e=d,ce=d,xe=d,oe=d,fe=d;return $e=ne.$check_result_legacy(i,H,K,A),$($e)?$e:(ce=P(H,"map",[],"sides".$to_proc()),oe=(xe=P(H,"map",[],"value".$to_proc())).$sum(),($e=[100]["$==="](fe=ce)?ne.$result_1d100(i,oe,K,A):[20]["$==="](fe)?ne.$result_1d20(i,oe,K,A):[6,6]["$==="](fe)?ne.$result_2d6(i,oe,xe,K,A):d)["$=="](D(n,"Result").$nothing())?d:$($e)?$e:(fe=ce.$uniq(),($e=[10]["$==="](fe)?ne.$result_nd10(i,oe,xe,K,A):[6]["$==="](fe)?ne.$result_nd6(i,oe,xe,K,A):d)["$=="](D(n,"Result").$nothing())?d:$($e)?$e:ne.$result_ndx(i,K,A)))},B.$$arity=4),e.def(h,"$grich_text",Q=function(i,H,K){return d},Q.$$arity=3),h.$private(),e.def(h,"$eval_common_command",T=function(i){try{var H;return i=this.$change_text(i),P(I(D(n,"CommonCommand"),"COMMANDS"),"each",[],((H=function(ne){var ce,$e=null==H.$$s?this:H.$$s;if(null==$e.randomizer&&($e.randomizer=d),null==ne&&(ne=d),ce=ne.$eval(i,$e,$e.randomizer),!$(ce))return d;e.ret(ce)}).$$s=this,H.$$arity=1,H)),d}catch(A){if(A===e.returner)return A.$v;throw A}},T.$$arity=1),e.def(h,"$dice_command",m=function(i){var H,K=this,A=d,ne=d,$e=d,ce=d,xe=d,oe=d,fe=d;return $(K.enabled_upcase_input)&&(i=i.$upcase()),A=K.$class().$prefixes_pattern().$match(i),$(A)?(ne=A["$[]"](1)["$nil?"]()["$!"](),$(ne)&&(i=i["$[]"](M(1,-1,!1))),$e=K.$eval_game_system_specific_command(i),$($e["$is_a?"](D(n,"Result")))?(ce=[$(xe=$e["$secret?"]())?xe:ne],P($e,"secret=",e.to_a(ce)),X(ce.length,1),$e):$($(oe=$(fe=$e["$nil?"]())?fe:$e["$empty?"]())?oe:$e["$=="]("1"))?d:P(D(n,"Result").$new(),"tap",[],((H=function(we){return null==we&&(we=d),ce=[$e.$to_s()],P(we,"text=",e.to_a(ce)),X(ce.length,1),P(we,"secret=",e.to_a(ce=[ne])),ce[X(ce.length,1)]}).$$s=K,H.$$arity=1,H))):d},m.$$arity=1),e.def(h,"$eval_game_system_specific_command",o=function(i){return d},o.$$arity=1),e.def(h,"$result_ndx",p=function(i,H,K){return $(K["$is_a?"](D(n,"String")))?d:$(i.$send(H,K))?D(n,"Result").$success(this.$translate("success")):D(n,"Result").$failure(this.$translate("failure"))},p.$$arity=3),e.def(h,"$result_1d100",v=function(i,H,K,A){return d},v.$$arity=4),e.def(h,"$result_1d20",y=function(i,H,K,A){return d},y.$$arity=4),e.def(h,"$result_nd10",a=function(i,H,K,A,ne){return d},a.$$arity=5),e.def(h,"$result_2d6",k=function(i,H,K,A,ne){return d},k.$$arity=5),e.def(h,"$result_nd6",N=function(i,H,K,A,ne){return d},N.$$arity=5),e.def(h,"$get_table_by_2d6",O=function(i){return this.$get_table_by_nD6(i,2)},O.$$arity=1),e.def(h,"$get_table_by_1d6",te=function(i){return this.$get_table_by_nD6(i,1)},te.$$arity=1),e.def(h,"$get_table_by_nD6",de=function(i,H){return this.$get_table_by_nDx(i,H,6)},de.$$arity=2),e.def(h,"$get_table_by_nDx",ve=function(i,H,K){var ne,$e=d;return ne=this.randomizer.$roll_sum(H,K),$e=this.$get_table_value(i["$[]"](X(ne,H))),$($e["$nil?"]())?["1",0]:[$e,ne]},ve.$$arity=3),e.def(h,"$get_table_by_1d3",ge=function(i){var A,ne,H=this,$e=d;return H.$debug("get_table_by_1d3"),A=H.randomizer.$roll_sum(1,6),H.$debug("num",A),ne=function(w,j){return"number"==typeof w?w/2:w["$/"](2)}(X(A,1)).$to_i(),H.$debug("index",ne),$e=i["$[]"](ne),$($e["$nil?"]())?["1",0]:[$e,A]},ge.$$arity=1),e.def(h,"$get_table_by_d66_swap",qe=function(i){var K;return K=this.randomizer.$roll_d66(I(D(n,"D66SortType"),"ASC")),[this.$get_table_by_number(K,i),K]},qe.$$arity=1),e.def(h,"$get_table_by_d66",Re=function(i){var K,A,ne,ce,$e=d;return K=this.randomizer.$roll_once(6),A=this.randomizer.$roll_once(6),ne=U(function(w,j){return"number"==typeof w?6*w:w["$*"](6)}(X(K,1)),X(A,1)),$e=i["$[]"](ne),ce=""+K+A,$($e["$nil?"]())?["1",ce]:[$e,ce]},Re.$$arity=1),e.def(h,"$get_table_by_number",ze=function(i,H,K){try{var A;return null==K&&(K="1"),P(H,"each",[],((A=function(ce){var oe,xe=null==A.$$s?this:A.$$s;if(null==ce&&(ce=d),oe=ce["$[]"](0),!$(function(w,j){return"number"==typeof w&&"number"==typeof j?w>=j:w["$>="](j)}(oe,i)))return d;e.ret(xe.$get_table_value(ce["$[]"](1)))}).$$s=this,A.$$arity=1,A)),this.$get_table_value(K)}catch($e){if($e===e.returner)return $e.$v;throw $e}},ze.$$arity=-3),e.def(h,"$get_table_value",Te=function(i){return $(i["$is_a?"](D(n,"Proc")))?i.$call():i},Te.$$arity=1),e.def(h,"$roll_tables",be=function(i,H){var A=d;return A=H["$[]"](i),$(A)?A.$roll(this.randomizer).$to_s():d},be.$$arity=2),e.def(h,"$debug",J=function(i,H){var A,ne,$e=this,ce=d,xe=d;return A=e.slice.call(arguments,1,arguments.length),$($e.debug)?(ce=$(i["$is_a?"](D(n,"String")))?i:i.$inspect(),$(A["$empty?"]())?$e.$warn(ce):(xe=P(A,"map",[],((ne=function(fe){return null==fe&&(fe=d),$(fe["$is_a?"](D(n,"String")))?'"'+fe+'"':fe.$inspect()}).$$s=$e,ne.$$arity=1,ne)),$e.$warn(ce+": "+xe.$join(", ")))):d},J.$$arity=-2),I(I(D(Y,"I18n"),"Backend"),"Simple").$include(I(I(D(Y,"I18n"),"Backend"),"Fallbacks")),D(Y,"I18n").$load_path()["$<<"](D(Y,"Dir")["$[]"](D(Y,"File").$join(s.$__dir__(),"../../i18n/**/*.yml"))),g=["ja_jp"],P(D(Y,"I18n"),"default_locale=",e.to_a(g)),X(g.length,1),g=[["ja_jp"]],P(D(Y,"I18n").$fallbacks(),"defaults=",e.to_a(g)),g[X(g.length,1)]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(e){var C,g,Z,f,E,c,l,u,x,L,j,P,X=[],S=e.nil,_=e.$$,s=e.module,Y=e.klass,d=e.hash2,I=e.truthy,D=e.send;return e.top.$require("strscan"),C=X,g=P=[s(X[0],"BCDice")].concat(C),Z=j=[s(P[0],"GameSystem")].concat(g),f=L=[Y(j[0],_(j,"Base"),"SwordWorld")].concat(Z),u=Y(L[0],null,"RatingLexer"),x=[u].concat(f),u.$$prototype.scanner=S,e.const_set(x[0],"SYMBOLS",d(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),e.def(u,"$initialize",E=function(B){var Q,T,o;return B=I(o=(T=(Q=B)===S||null==Q?S:D(Q,"split",[" ",2]))===S||null==T?S:D(T,"first",[]))?o:"",this.scanner=_(x,"StringScanner").$new(B)},E.$$arity=1),e.def(u,"$next_token",c=function(){var B=this,Q=S,T=S,o=S;return I(B.scanner["$eos?"]())?[!1,"$"]:I(Q=B.scanner.$scan(/\d+/))?["NUMBER",Q.$to_i()]:(T=B.scanner.$getch().$upcase(),[I(o=_(x,"SYMBOLS")["$[]"](T))?o:T.$to_sym(),T])},c.$$arity=0),void e.def(u,"$source",l=function(){return this.scanner.$string()},l.$$arity=0)},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(e){function U(t,C){return"number"==typeof t&&"number"==typeof C?t<C:t["$<"](C)}function X(t,C){return"number"==typeof t&&"number"==typeof C?t+C:t["$+"](C)}var C,g,Z,f,E,c,l,b,B,Q,T,m,o,u,x,L,j,P,r=[],_=e.nil,Y=e.$$,d=e.module,I=e.klass,D=e.truthy;return C=r,g=P=[d(r[0],"BCDice")].concat(C),Z=j=[d(P[0],"GameSystem")].concat(g),f=L=[I(j[0],Y(j,"Base"),"SwordWorld")].concat(Z),u=I(L[0],null,"RatingParsed"),x=[u].concat(f),u.$$prototype.modifier_after_half=u.$$prototype.critical=u.$$prototype.first_modify=u.$$prototype.first_to=u.$$prototype.rateup=u.$$prototype.kept_modify=u.$$prototype.rate=u.$$prototype.greatest_fortune=u.$$prototype.modifier=_,u.$attr_accessor("rate"),u.$attr_writer("critical"),u.$attr_writer("kept_modify"),u.$attr_writer("first_to"),u.$attr_writer("first_modify"),u.$attr_writer("rateup"),u.$attr_accessor("greatest_fortune"),u.$attr_accessor("modifier"),u.$attr_writer("modifier_after_half"),e.def(u,"$initialize",E=function(){var v=this;return v.critical=_,v.kept_modify=_,v.first_to=_,v.first_modify=_,v.greatest_fortune=!1,v.rateup=_},E.$$arity=0),e.def(u,"$half",c=function(){return this.modifier_after_half["$nil?"]()["$!"]()},c.$$arity=0),e.def(u,"$critical",l=function(){var a,y=_;return y=D(a=this.critical)?a:D(this.$half())?13:10,D(U(y,3))&&(y=3),y},l.$$arity=0),e.def(u,"$first_modify",b=function(){var y;return D(y=this.first_modify)?y:0},b.$$arity=0),e.def(u,"$first_to",B=function(){var y;return D(y=this.first_to)?y:0},B.$$arity=0),e.def(u,"$rateup",Q=function(){var y;return D(y=this.rateup)?y:0},Q.$$arity=0),e.def(u,"$kept_modify",T=function(){var y;return D(y=this.kept_modify)?y:0},T.$$arity=0),e.def(u,"$modifier_after_half",m=function(){var y;return D(y=this.modifier_after_half)?y:0},m.$$arity=0),void e.def(u,"$to_s",o=function(){var v=this,y=_;return y="KeyNo."+v.rate,D(U(v.$critical(),13))&&(y=X(y,"c["+v.$critical()+"]")),D(v.$first_modify()["$!="](0))&&(y=X(y,"m["+Y(x,"Format").$modifier(v.$first_modify())+"]")),D(v.$first_to()["$!="](0))&&(y=X(y,"m["+v.$first_to()+"]")),D(v.$rateup()["$!="](0))&&(y=X(y,"r["+v.$rateup()+"]")),D(v.greatest_fortune)&&(y=X(y,"gf")),D(v.$kept_modify()["$!="](0))&&(y=X(y,"a["+Y(x,"Format").$modifier(v.$kept_modify())+"]")),D(v.modifier["$!="](0))&&(y=X(y,Y(x,"Format").$modifier(v.modifier))),y},o.$$arity=0)},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(e){function U(P,M){return"number"==typeof P&&"number"==typeof M?P-M:P["$-"](M)}var M,q,h,E,b,B,Q,T,m,o,p,v,y,a,k,N,O,te,de,ve,ge,qe,Re,ze,Te,be,J,re,i,H,K,A,ne,$e,ce,xe,oe,fe,he,we,le,De,me,Ae,Ke,Me,He,c,l,f,Z,w,X=e.top,S=[],r=e.nil,_=e.$$$,s=e.$$,Y=e.module,d=e.klass,I=e.hash2,D=e.send2,t=e.send,C=e.hash,$=e.truthy;return X.$require("racc/parser.rb"),X.$require("bcdice/arithmetic/node"),X.$require("bcdice/enum"),X.$require("bcdice/game_system/sword_world/rating_lexer"),X.$require("bcdice/game_system/sword_world/rating_parsed"),M=S,q=w=[Y(S[0],"BCDice")].concat(M),h=Z=[Y(w[0],"GameSystem")].concat(q),E=f=[d(Z[0],s(Z,"Base"),"SwordWorld")].concat(h),c=d(f[0],_(s(f,"Racc"),"Parser"),"RatingParser"),l=[c].concat(E),c.$$prototype.lexer=c.$$prototype.version=r,e.def(c,"$initialize",b=function(ue){var ke,ee;if(b.$$p&&(b.$$p=null),null==ue)ue=I([],{});else if(!ue.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(ke=ue.$$smap.version)&&(ke="v1_0"),null==(ee=ue.$$smap.round_type)&&(ee=_(s(l,"RoundType"),"CEIL")),D(this,e.find_super_dispatcher(this,"initialize",b,!1,!0),"initialize",[],null),this.version=ke,this.round_type=ee},b.$$arity=-1),e.def(c,"$set_debug",B=function(){return this.yydebug=!0,this},B.$$arity=0),e.def(c,"$parse",Q=function(ue){try{return this.lexer=s(l,"RatingLexer").$new(ue),this.$do_parse()}catch(ee){if(!e.rescue(ee,[s(l,"ParseError"),s(l,"ZeroDivisionError")]))throw ee;try{return r}finally{e.pop_exception()}}},Q.$$arity=1),c.$private(),e.def(c,"$parsed",T=function(ue,ke,ee){var G;return t(s(l,"RatingParsed").$new(),"tap",[],((G=function(_e){var z,ie,F,V,ae=null==G.$$s?this:G.$$s,se=r;return null==ae.round_type&&(ae.round_type=r),null==_e&&(_e=r),t(_e,"rate=",e.to_a(se=[ue])),U(se.length,1),se=[(z=ee["$[]"]("critical"),z===r||null==z?r:t(z,"eval",[ae.round_type]))],t(_e,"critical=",e.to_a(se)),U(se.length,1),se=[(ie=ee["$[]"]("kept_modify"),ie===r||null==ie?r:t(ie,"eval",[ae.round_type]))],t(_e,"kept_modify=",e.to_a(se)),U(se.length,1),se=[ee["$[]"]("first_to")],t(_e,"first_to=",e.to_a(se)),U(se.length,1),se=[ee["$[]"]("first_modify")],t(_e,"first_modify=",e.to_a(se)),U(se.length,1),se=[(F=ee["$[]"]("rateup"),F===r||null==F?r:t(F,"eval",[ae.round_type]))],t(_e,"rateup=",e.to_a(se)),U(se.length,1),se=[ee.$fetch("greatest_fortune",!1)],t(_e,"greatest_fortune=",e.to_a(se)),U(se.length,1),se=[ke.$eval(ae.round_type)],t(_e,"modifier=",e.to_a(se)),U(se.length,1),se=[(V=ee["$[]"]("modifier_after_half"),V===r||null==V?r:t(V,"eval",[ae.round_type]))],t(_e,"modifier_after_half=",e.to_a(se)),se[U(se.length,1)]}).$$s=this,G.$$arity=1,G))},T.$$arity=3),e.def(c,"$next_token",m=function(){return this.lexer.$next_token()},m.$$arity=0),fe=[15,14,16,5,18,19,51,52,21,22,11,53,12,17,13,15,14,16,4,18,19,4,8,3,28,11,28,12,17,13,24,25,24,25,27,28,27,28,49,50,9,24,25,24,25,27,28,27,28,49,50,35,24,25,24,25,27,28,27,28,49,50,42,24,25,24,25,27,28,27,28,49,50,47,24,25,24,25,27,28,27,28,49,50,48,24,25,24,25,27,28,27,28,49,50,r,24,25,24,25,27,28,27,28,49,50,r,24,25,24,25,27,30,27,r,r,r,r,31,32],he=[6,6,6,1,6,6,45,45,10,10,6,45,6,6,6,20,20,20,3,20,20,0,4,0,11,20,12,20,20,20,11,11,12,12,11,14,12,15,37,37,5,14,14,15,15,14,17,15,18,39,39,16,17,17,18,18,17,19,18,21,40,40,23,19,19,21,21,19,22,21,24,41,41,31,22,22,24,24,22,25,24,27,46,46,32,25,25,27,27,25,49,27,50,56,56,r,49,49,50,50,49,51,50,52,57,57,r,51,51,52,52,51,13,52,r,r,r,r,13,13],we=[18,3,r,15,20,40,-4,r,r,r,0,22,24,110,33,35,44,44,46,55,11,57,66,47,68,77,r,79,r,r,r,71,82,r,r,r,r,28,r,39,50,61,r,r,r,-2,72,r,r,88,90,99,101,r,r,r,83,94],le=[-31,-31,-4,-31,-31,-31,-1,-4,-3,58,-5,-31,-31,-31,-11,-31,-31,-31,-31,-31,-2,-31,-31,-31,-31,-31,-28,-31,-30,-7,-8,-31,-31,-12,-13,-14,-15,-16,-25,-17,-18,-19,-6,-26,-27,-31,-22,-9,-10,-31,-31,-31,-31,-29,-23,-24,-20,-21],De=[23,29,2,33,34,7,36,37,39,1,40,41,6,43,44,45,46,20,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,54,55,56,57],me=[5,5,2,5,5,2,5,6,6,1,6,6,3,5,5,7,6,3,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,5,5,6,6],Ae=[r,9,2,10,r,-11,-11,-12,r],Ke=[r,r,r,r,10,38,r,r,26],Me=[0,0,"racc_error",2,20,"_reduce_1",3,20,"_reduce_2",2,21,"_reduce_3",0,22,"_reduce_4",2,22,"_reduce_5",4,22,"_reduce_6",3,22,"_reduce_7",3,22,"_reduce_8",4,22,"_reduce_9",4,22,"_reduce_10",2,22,"_reduce_11",3,22,"_reduce_12",3,22,"_reduce_13",3,22,"_reduce_14",3,22,"_reduce_15",2,23,"_reduce_16",2,23,"_reduce_17",3,23,"_reduce_18",3,23,"_reduce_19",3,26,"_reduce_20",3,26,"_reduce_21",1,26,"_reduce_none",3,25,"_reduce_23",3,25,"_reduce_24",1,25,"_reduce_none",2,24,"_reduce_26",2,24,"_reduce_27",1,24,"_reduce_none",3,27,"_reduce_29",1,27,"_reduce_30"],He=C(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"G",6,"F",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"AT",16,"SHARP",17,"DOLLAR",18),e.const_set(l[0],"Racc_arg",[fe,he,le,we,De,me,Ke,Ae,19,Me,He,58,31,!0]),e.const_set(l[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","G","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),e.const_set(l[0],"Racc_debug_parser",!1),e.def(c,"$_reduce_1",o=function(ue,ke,ee){var G,_e,z,ie,ae=r;return _e=null==(G=e.to_ary(ue))[0]?r:G[0],z=$(ie=(ae=null==G[1]?r:G[1])["$[]"]("modifier"))?ie:_(_(s(l,"Arithmetic"),"Node"),"Number").$new(0),this.$parsed(_e,z,ae)},o.$$arity=3),e.def(c,"$_reduce_2",p=function(ue,ke,ee){var G,ae,V,se,z=r,F=r;return ae=null==(G=e.to_ary(ue))[1]?r:G[1],$((z=null==G[2]?r:G[2])["$[]"]("modifier_after_half"))||(F=["modifier_after_half",_(_(s(l,"Arithmetic"),"Node"),"Number").$new(0)],t(z,"[]=",e.to_a(F)),U(F.length,1)),V=$(se=z["$[]"]("modifier"))?se:_(_(s(l,"Arithmetic"),"Node"),"Number").$new(0),this.$parsed(ae,V,z)},p.$$arity=3),e.def(c,"$_reduce_3",v=function(ue,ke,ee){return ue["$[]"](1).$to_i()},v.$$arity=3),e.def(c,"$_reduce_4",y=function(ue,ke,ee){return I([],{})},y.$$arity=3),e.def(c,"$_reduce_5",a=function(ue,ke,ee){var G,ae,z,_e=r;return ae=null==(G=e.to_ary(ue))[1]?r:G[1],$((_e=null==G[0]?r:G[0])["$[]"]("modifier")["$nil?"]())||this.$raise(s(l,"ParseError")),t(_e,"[]=",e.to_a(z=["modifier",ae])),U(z.length,1),_e},a.$$arity=3),e.def(c,"$_reduce_6",k=function(ue,ke,ee){var G,z,ie,_e=r;return z=null==(G=e.to_ary(ue))[2]?r:G[2],$((_e=null==G[0]?r:G[0])["$[]"]("critical")["$nil?"]())||this.$raise(s(l,"ParseError")),t(_e,"[]=",e.to_a(ie=["critical",z])),U(ie.length,1),_e},k.$$arity=3),e.def(c,"$_reduce_7",N=function(ue,ke,ee){var G,z,ie,_e=r;return z=null==(G=e.to_ary(ue))[2]?r:G[2],$((_e=null==G[0]?r:G[0])["$[]"]("critical")["$nil?"]())||this.$raise(s(l,"ParseError")),t(_e,"[]=",e.to_a(ie=["critical",z])),U(ie.length,1),_e},N.$$arity=3),e.def(c,"$_reduce_8",O=function(ue,ke,ee){var G,F,ie,_e=r,z=r;return z=null==(G=e.to_ary(ue))[2]?r:G[2],$($(ie=(_e=null==G[0]?r:G[0])["$[]"]("first_to")["$nil?"]())?_e["$[]"]("first_modify")["$nil?"]():ie)||this.$raise(s(l,"ParseError")),F=["first_to",z.$to_i()],t(_e,"[]=",e.to_a(F)),U(F.length,1),_e},O.$$arity=3),e.def(c,"$_reduce_9",te=function(ue,ke,ee){var G,F,ie,_e=r,z=r;return z=null==(G=e.to_ary(ue))[3]?r:G[3],$($(ie=(_e=null==G[0]?r:G[0])["$[]"]("first_to")["$nil?"]())?_e["$[]"]("first_modify")["$nil?"]():ie)||this.$raise(s(l,"ParseError")),F=["first_modify",z.$to_i()],t(_e,"[]=",e.to_a(F)),U(F.length,1),_e},te.$$arity=3),e.def(c,"$_reduce_10",de=function(ue,ke,ee){var G,F,ie,_e=r,z=r;return z=null==(G=e.to_ary(ue))[3]?r:G[3],$($(ie=(_e=null==G[0]?r:G[0])["$[]"]("first_to")["$nil?"]())?_e["$[]"]("first_modify")["$nil?"]():ie)||this.$raise(s(l,"ParseError")),F=["first_modify",z.$to_i()["$-@"]()],t(_e,"[]=",e.to_a(F)),U(F.length,1),_e},de.$$arity=3),e.def(c,"$_reduce_11",ve=function(ue,ke,ee){var G,z,_e=r;return G=e.to_ary(ue),$((_e=null==G[0]?r:G[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise(s(l,"ParseError")),z=["modifier_after_half",_(_(s(l,"Arithmetic"),"Node"),"Number").$new(0)],t(_e,"[]=",e.to_a(z)),U(z.length,1),_e},ve.$$arity=3),e.def(c,"$_reduce_12",ge=function(ue,ke,ee){var G,z,ie,_e=r;return z=null==(G=e.to_ary(ue))[2]?r:G[2],$((_e=null==G[0]?r:G[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise(s(l,"ParseError")),t(_e,"[]=",e.to_a(ie=["modifier_after_half",z])),U(ie.length,1),_e},ge.$$arity=3),e.def(c,"$_reduce_13",qe=function(ue,ke,ee){var G,z,F,ie,_e=r;return _e=null==(G=e.to_ary(ue))[0]?r:G[0],z=null==G[2]?r:G[2],$($(ie=["v2_5","v2_0"]["$include?"](this.version))?_e["$[]"]("rateup")["$nil?"]():ie)||this.$raise(s(l,"ParseError")),t(_e,"[]=",e.to_a(F=["rateup",z])),U(F.length,1),_e},qe.$$arity=3),e.def(c,"$_reduce_14",Re=function(ue,ke,ee){var G,ie,z,_e=r;return _e=null==(G=e.to_ary(ue))[0]?r:G[0],$($(z=["v2_5","v2_0"]["$include?"](this.version))?_e["$[]"]("greatest_fortune")["$nil?"]():z)||this.$raise(s(l,"ParseError")),t(_e,"[]=",e.to_a(ie=["greatest_fortune",!0])),U(ie.length,1),_e},Re.$$arity=3),e.def(c,"$_reduce_15",ze=function(ue,ke,ee){var G,z,F,ie,_e=r;return _e=null==(G=e.to_ary(ue))[0]?r:G[0],z=null==G[2]?r:G[2],$($(ie=this.version["$=="]("v2_5"))?_e["$[]"]("kept_modify")["$nil?"]():ie)||this.$raise(s(l,"ParseError")),t(_e,"[]=",e.to_a(F=["kept_modify",z])),U(F.length,1),_e},ze.$$arity=3),e.def(c,"$_reduce_16",Te=function(ue,ke,ee){return ue["$[]"](1)},Te.$$arity=3),e.def(c,"$_reduce_17",be=function(ue,ke,ee){return _(_(s(l,"Arithmetic"),"Node"),"Negative").$new(ue["$[]"](1))},be.$$arity=3),e.def(c,"$_reduce_18",J=function(ue,ke,ee){return _(_(s(l,"Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"+",ue["$[]"](2))},J.$$arity=3),e.def(c,"$_reduce_19",re=function(ue,ke,ee){return _(_(s(l,"Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"-",ue["$[]"](2))},re.$$arity=3),e.def(c,"$_reduce_20",i=function(ue,ke,ee){return _(_(s(l,"Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"+",ue["$[]"](2))},i.$$arity=3),e.def(c,"$_reduce_21",H=function(ue,ke,ee){return _(_(s(l,"Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"-",ue["$[]"](2))},H.$$arity=3),e.def(c,"$_reduce_23",K=function(ue,ke,ee){return _(_(s(l,"Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"*",ue["$[]"](2))},K.$$arity=3),e.def(c,"$_reduce_24",A=function(ue,ke,ee){return _(_(s(l,"Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(ue["$[]"](0),ue["$[]"](2))},A.$$arity=3),e.def(c,"$_reduce_26",ne=function(ue,ke,ee){return ue["$[]"](1)},ne.$$arity=3),e.def(c,"$_reduce_27",$e=function(ue,ke,ee){return _(_(s(l,"Arithmetic"),"Node"),"Negative").$new(ue["$[]"](1))},$e.$$arity=3),e.def(c,"$_reduce_29",ce=function(ue,ke,ee){return ue["$[]"](1)},ce.$$arity=3),e.def(c,"$_reduce_30",xe=function(ue,ke,ee){return _(_(s(l,"Arithmetic"),"Node"),"Number").$new(ue["$[]"](0))},xe.$$arity=3),void e.def(c,"$_reduce_none",oe=function(ue,ke,ee){return ue["$[]"](0)},oe.$$arity=3)},Opal.modules["bcdice/game_system/SwordWorld"]=function(e){function U(q,R){return"number"==typeof q&&"number"==typeof R?q>=R:q["$>="](R)}function X(q,R){return"number"==typeof q&&"number"==typeof R?q<=R:q["$<="](R)}function S(q,R){return"number"==typeof q&&"number"==typeof R?q-R:q["$-"](R)}function r(q,R){return"number"==typeof q&&"number"==typeof R?q>R:q["$>"](R)}function _(q,R){return"number"==typeof q&&"number"==typeof R?q+R:q["$+"](R)}function Y(q,R){return"number"==typeof q&&"number"==typeof R?q*R:q["$*"](R)}var R,h,E,b,B,Q,T,m,o,p,v,y,c,l,f,W,I=e.top,D=[],t=e.nil,$=e.$$,P=e.module,M=e.klass,g=e.send2,w=e.truthy,j=e.send;return I.$require("bcdice/base"),I.$require("bcdice/game_system/sword_world/rating_parser"),R=D,h=W=[P(D[0],"BCDice")].concat(R),E=f=[P(W[0],"GameSystem")].concat(h),c=M(f[0],$(f,"Base"),"SwordWorld"),l=[c].concat(E),c.$$prototype.rating_table=c.$$prototype.randomizer=t,e.const_set(l[0],"ID","SwordWorld"),e.const_set(l[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),e.const_set(l[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),e.const_set(l[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),c.$register_prefix("H?K"),e.def(c,"$initialize",b=function(k){return b.$$p&&(b.$$p=null),g(this,e.find_super_dispatcher(this,"initialize",b,!1,!0),"initialize",[k],null),this.rating_table=0},b.$$arity=1),e.def(c,"$result_2d6",B=function(k,N,O,te,de){var ge=t;return w(U(N,12))?$(l,"Result").$critical("\u81ea\u52d5\u7684\u6210\u529f"):w(X(N,2))?$(l,"Result").$fumble("\u81ea\u52d5\u7684\u5931\u6557"):w(w(ge=te["$!="](">="))?ge:de["$=="]("?"))?t:w(U(k,de))?$(l,"Result").$success("\u6210\u529f"):$(l,"Result").$failure("\u5931\u6557")},B.$$arity=5),e.def(c,"$eval_game_system_specific_command",Q=function(k){return this.$rating(k)},Q.$$arity=1),c.$private(),e.def(c,"$rating_parser",T=function(){return $(l,"RatingParser").$new()},T.$$arity=0),e.def(c,"$rating",m=function(k){var N,O,te,de,ve=this,ge=t,qe=t,Re=t,ze=t,Te=t,be=t,J=t,re=t,i=t,H=t,K=t,A=t,ne=t,$e=t,xe=t,oe=t;return ve.$debug("rating string",k),ge=ve.$rating_parser().$parse(k),w(ge)?(qe=ve.$getSW2_0_RatingTable(),Re=S(qe.$length(),1),ve.$debug("keyMax",Re),w(r(ge.$rate(),Re))?"\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc\u306f"+Re+"\u307e\u3067\u3067\u3059":(ze=ve.$getNewRates(qe),Te=ge+" \uff1e ",be=[],J=[],re=[],i=0,H=0,K=0,A=0,ne=ge.$first_to(),$e=ge.$first_modify(),function(){var fe=e.new_brk();try{j(ve,"loop",[],((N=function(){var le,De,Me,Le,Ke,we=null==N.$$s?this:N.$$s,me=t,Ae=t;if(De=we.$rollDice(ge),Ae=null==(le=e.to_ary(De))[1]?t:le[1],i=me=null==le[0]?t:le[0],w(ne["$!="](0))?(i=me=ne,ne=0):w($e["$!="](0))&&(i=_(i,$e),$e=0),w(X(me,2))&&(be["$<<"](me.$to_s()),J["$<<"](Ae.$to_s()),re["$<<"]("**"),A=_(A,1),e.brk(t,fe)),w(w(Ke=ge.$kept_modify()["$!="](0))?i["$!="](2):Ke)&&(i=_(i,ge.$kept_modify())),w(function(q,R){return"number"==typeof q?q<2:q["$<"](2)}(i))&&(i=2),w(r(i,12))&&(i=12),Me=[_(ge.$rate(),Y(A,ge.$rateup())),Re].$min(),we.$debug("currentKey",Me),Le=ze["$[]"](i)["$[]"](Me),we.$debug("rateValue",Le),K=_(K,Le),H=_(H,i),be["$<<"](i.$to_s()),J["$<<"](Ae.$to_s()),re["$<<"](w(r(i,2))?Le:"**"),A=_(A,1),w(U(i,ge.$critical())))return t;e.brk(t,fe)}).$$s=ve,N.$$brk=fe,N.$$arity=0,N))}catch(he){if(he===fe)return he.$v;throw he}}(),te=ve.$getResultText(K,ge,J,be,re,H,A),O=e.to_ary(te),xe=null==O[1]?t:O[1],oe=null==O[2]?t:O[2],Te=_(Te,null==O[0]?t:O[0]),j($(l,"Result").$new(),"tap",[],((de=function(he){var le=t;return null==he&&(he=t),j(he,"text=",e.to_a(le=[Te])),S(le.length,1),j(he,"critical=",e.to_a(le=[xe])),S(le.length,1),j(he,"fumble=",e.to_a(le=[oe])),le[S(le.length,1)]}).$$s=ve,de.$$arity=1,de)))):(ve.$debug("not matched"),"1")},m.$$arity=1),e.def(c,"$getSW2_0_RatingTable",o=function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]},o.$$arity=0),e.def(c,"$getNewRates",p=function(k){var N,te=t,de=t,ve=t,ge=t,qe=t,Re=t,ze=t,Te=t,be=t,J=t,re=t,i=t;return te=[],de=[],ve=[],ge=[],qe=[],Re=[],ze=[],Te=[],be=[],J=[],re=[],j(k,"each",[],((N=function(A){var $e=t;return null==A&&(A=t),$e=A.$split(/,/),re.$push(0),te.$push($e["$[]"](1).$to_i()),de.$push($e["$[]"](2).$to_i()),ve.$push($e["$[]"](3).$to_i()),ge.$push($e["$[]"](4).$to_i()),qe.$push($e["$[]"](5).$to_i()),Re.$push($e["$[]"](6).$to_i()),ze.$push($e["$[]"](7).$to_i()),Te.$push($e["$[]"](8).$to_i()),be.$push($e["$[]"](9).$to_i()),J.$push($e["$[]"](10).$to_i())}).$$s=this,N.$$arity=1,N)),this.rating_table["$=="](1)&&(i=[31,(i=[32,(i=[33,10],j(J,"[]=",e.to_a(i)),i[S(i.length,1)])],j(J,"[]=",e.to_a(i)),i[S(i.length,1)])],j(J,"[]=",e.to_a(i)),S(i.length,1)),[re,re,re,te,de,ve,ge,qe,Re,ze,Te,be,J]},p.$$arity=1),e.def(c,"$rollDice",v=function(k){var O=t;return[(O=this.randomizer.$roll_barabara(2,6)).$sum(),O.$join(",")]},v.$$arity=1),void e.def(c,"$getResultText",y=function(k,N,O,te,de,ve,ge){var Re=t,ze=t,Te=t,be=t,J=t,re=t;return(Re=[]).$push("2D:["+O.$join(" ")+"]="+te.$join(",")),w(X(ve,2))?(Re.$push(de.$join(",")),Re.$push("\u81ea\u52d5\u7684\u5931\u6557"),[Re.$join(" \uff1e "),!1,!0]):(w(w(ze=r(de.$size(),1))?ze:N.$modifier()["$!="](0))?(Te=_(de.$join(","),$(l,"Format").$modifier(N.$modifier())),w(N.$half())&&(Te="("+Te+")/2",w(N.$modifier_after_half()["$!="](0))&&(Te=_(Te,$(l,"Format").$modifier(N.$modifier_after_half())))),Re.$push(Te)):w(N.$half())&&(Te=de.$first()+"/2",w(N.$modifier_after_half()["$!="](0))&&(Te=_(Te,$(l,"Format").$modifier(N.$modifier_after_half()))),Re.$push(Te)),w(r(ge,1))&&(be=S(ge,1)+"\u56de\u8ee2",Re.$push(be)),J=_(k,N.$modifier()),w(N.$half())&&(J=function(q,R){return"number"==typeof q?q/2:q["$/"](2)}(J).$ceil(),w(N.$modifier_after_half()["$!="](0))&&(J=_(J,N.$modifier_after_half()))),re=J.$to_s(),Re.$push(re),[Re.$join(" \uff1e "),r(ge,1),!1])},y.$$arity=7)},Opal.modules["bcdice/game_system/sword_world/transcendent_test"]=function(e){function X(M,g){return"number"==typeof M&&"number"==typeof g?M>=g:M["$>="](g)}function r(M,g){return"number"==typeof M&&"number"==typeof g?M-g:M["$-"](g)}var g,R,n,c,B,Q,T,m,o,p,l,b,u,W,j,s=[],Y=e.nil,I=e.$$,D=e.module,t=e.klass,C=e.hash2,$=e.truthy,P=e.send;return e.top.$require("bcdice/result"),g=s,R=j=[D(s[0],"BCDice")].concat(g),n=W=[D(j[0],"GameSystem")].concat(R),c=u=[t(W[0],I(W,"SwordWorld"),"SwordWorld2_0")].concat(n),l=t(u[0],null,"TranscendentTest"),b=[l].concat(c),l.$$prototype.modifier=l.$$prototype.critical_value=l.$$prototype.expression=l.$$prototype.modifier_str=l.$$prototype.target=l.$$prototype.cmp_op=Y,e.const_set(b[0],"RESULT_STR",C(["success","failure","super_success","critical","fumble"],{success:"\u6210\u529f",failure:"\u5931\u6557",super_success:"\u8d85\u6210\u529f",critical:"\u81ea\u52d5\u7684\u6210\u529f",fumble:"\u81ea\u52d5\u7684\u5931\u6557"}).$freeze()),e.def(l,"$initialize",B=function(y,a,k,N){var O=this;return O.critical_value=y,O.modifier=a,O.cmp_op=k,O.target=N,O.modifier_str=I(b,"Format").$modifier(O.modifier),O.expression=O.$node_expression()},B.$$arity=4),e.def(l,"$execute",Q=function(y){var k,qe,ge,N=this,O=Y,te=Y,de=Y,ve=Y,Re=Y,ze=Y,Te=Y;if($(function(M,g){return"number"==typeof M?M<3:M["$<"](3)}(N.critical_value)))return"("+N.expression+") \uff1e \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u304c\u5c0f\u3055\u3059\u304e\u307e\u3059\u30023\u4ee5\u4e0a\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002";if(te=[O=y.$roll_barabara(2,6)],de=O["$=="]([1,1]),ve=O["$=="]([6,6]),$($(ge=de["$!"]())?ve["$!"]():ge))for(;$(X(N.$sum_of_dice(te.$last()),N.critical_value));)te.$push(y.$roll_barabara(2,6));return Re=function(M,g){return"number"==typeof M&&"number"==typeof g?M+g:M["$+"](g)}(qe=N.$sum_of_dice(te),N.modifier),ze=N.$result_status(Re,te.$length(),de,ve),Te=["("+N.expression+")",""+N.$dice_str(te,qe)+N.modifier_str,Re,I(b,"RESULT_STR")["$[]"](ze)].$compact(),P(I(b,"Result").$new(),"tap",[],((k=function(J){var i=Y;return null==J&&(J=Y),i=[Te.$join(" \uff1e ")],P(J,"text=",e.to_a(i)),r(i.length,1),i=[ze["$=="]("fumble")],P(J,"fumble=",e.to_a(i)),r(i.length,1),i=[ze["$=="]("critical")],P(J,"critical=",e.to_a(i)),r(i.length,1),i=[["success","super_success","critical"]["$include?"](ze)],P(J,"success=",e.to_a(i)),r(i.length,1),i=[["failure","fumble"]["$include?"](ze)],P(J,"failure=",e.to_a(i)),i[r(i.length,1)]}).$$s=N,k.$$arity=1,k))},Q.$$arity=1),l.$private(),e.def(l,"$node_expression",T=function(){var a,y=this;return a="2D6@"+y.critical_value+y.modifier_str,$(y.target)?""+a+y.cmp_op+y.target:a},T.$$arity=0),e.def(l,"$sum_of_dice",m=function(y){return y.$flatten().$sum()},m.$$arity=1),e.def(l,"$dice_str",o=function(y,a){var k;return""+a+P(y,"map",[],(k=function(de){return null==de&&(de=Y),"["+de.$join(",")+"]"},k.$$s=this,k.$$arity=1,k)).$join()},o.$$arity=2),void e.def(l,"$result_status",p=function(y,a,k,N){var O=this,te=Y;return $(O.target)?$(k)?"fumble":$(N)?"critical":$(y.$send(O.cmp_op,O.target))?$($(te=X(a,2))?X(y,41):te)?"super_success":"success":"failure":"no_target"},p.$$arity=4)},Opal.modules["bcdice/game_system/SwordWorld2_0"]=function(e){function U(P,M){return"number"==typeof P&&"number"==typeof M?P*M:P["$*"](M)}var M,q,h,u,x,E,c,l,b,B,Q,T,n,f,Z,w,S=e.top,r=[],_=e.nil,s=e.$$$,Y=e.$$,d=e.module,I=e.klass,D=e.send2,t=e.truthy,C=e.hash2,$=e.send;return S.$require("bcdice/arithmetic_evaluator"),S.$require("bcdice/game_system/SwordWorld"),S.$require("bcdice/game_system/sword_world/transcendent_test"),M=r,q=w=[d(r[0],"BCDice")].concat(M),h=Z=[d(w[0],"GameSystem")].concat(q),n=I(Z[0],Y(Z,"SwordWorld"),"SwordWorld2_0"),f=[n].concat(h),n.$$prototype.randomizer=_,e.const_set(f[0],"ID","SwordWorld2.0"),e.const_set(f[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0"),e.const_set(f[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0"),e.const_set(f[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r10\n\u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r10gf\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),n.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT"),e.def(n,"$initialize",u=function(o){var y=this;return u.$$p&&(u.$$p=null),D(y,e.find_super_dispatcher(y,"initialize",u,!1,!0),"initialize",[o],null),y.rating_table=2},u.$$arity=1),e.def(n,"$eval_game_system_specific_command",x=function(o){var a,y=this,N=_;return x.$$p&&(x.$$p=null),/^Gr(\d+)?/i["$==="](a=o)?t(o["$=~"](/^Gr(\d+)/i))?y.$growth(Y(f,"Regexp").$last_match(1).$to_i()):y.$growth():/^2D6?@\d+/i["$==="](a)?(N=s(Y(f,"Command"),"Parser").$new(/2D6?/i,C(["round_type"],{round_type:s(s(Y(f,"BCDice"),"RoundType"),"CEIL")})).$enable_critical().$restrict_cmp_op_to(_,">=",">").$parse(o),t(N)?Y(f,"TranscendentTest").$new(N.$critical(),N.$modify_number(),N.$cmp_op(),N.$target_number()).$execute(y.randomizer):_):"FT"["$==="](a)?y.$get_fumble_table():"TT"["$==="](a)?y.$get_tangle_table():D(y,e.find_super_dispatcher(y,"eval_game_system_specific_command",x,!1,!0),"eval_game_system_specific_command",[o],null)},x.$$arity=1),e.def(n,"$rating_parser",E=function(){return Y(f,"RatingParser").$new(C(["version"],{version:"v2_0"}))},E.$$arity=0),e.def(n,"$rollDice",c=function(o){var y=this,a=_;return c.$$p&&(c.$$p=null),t(o.$greatest_fortune())?[U(a=y.randomizer.$roll_once(6),2),a+","+a]:D(y,e.find_super_dispatcher(y,"rollDice",c,!1,!0),"rollDice",[o],null)},c.$$arity=1),e.def(n,"$growth",l=function(o){var p;return null==o&&(o=1),$(e.Range.$new(1,o,!1),"map",[],(p=function(){return(null==p.$$s?this:p.$$s).$growth_step()},p.$$s=this,p.$$arity=0,p)).$join(" | ")},l.$$arity=-1),e.def(n,"$growth_step",b=function(){var p,v,a,o=this,y=_;return p=o.randomizer.$roll_once(6),v=o.randomizer.$roll_once(6),y=o.$get_ability_by_dice(p),a=o.$get_ability_by_dice(v),t(y["$!="](a))?"["+p+","+v+"]->("+y+" or "+a+")":"["+p+","+v+"]->("+y+")"},b.$$arity=0),e.def(n,"$get_ability_by_dice",B=function(o){return["\u5668\u7528\u5ea6","\u654f\u6377\u5ea6","\u7b4b\u529b","\u751f\u547d\u529b","\u77e5\u529b","\u7cbe\u795e\u529b"]["$[]"]("number"==typeof(P=o)?P-1:P["$-"](1));var P},B.$$arity=1),e.def(n,"$get_fumble_table",Q=function(){var o,p;return p=this.$get_table_by_1d6(["\u3053\u306e\u8868\u30922\u56de\u632f\u308a\u3001\u305d\u306e\u4e21\u65b9\u3092\u9069\u7528\u3059\u308b\u3002\uff08\u540c\u3058\u51fa\u76ee\u306b\u3088\u308b\u5f71\u97ff\u306f\u7d2f\u7a4d\u3057\u306a\u3044\uff09\u3002\u3053\u306e\u81ea\u52d5\u5931\u6557\u306b\u3088\u308a\u5f97\u3089\u308c\u308b\u7d4c\u9a13\u70b9\u306f\u3001+50\u70b9\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u306b\u3001\u653b\u6483\u8005\u3092\u5f37\u5316\u3057\u3066\u3044\u308b\u300c\u5263\u306e\u304b\u3051\u3089\u300d\u306e\u6570\u304c\u8ffd\u52a0\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u306b\u3001\u653b\u6483\u8005\u306e\u300c\u30ec\u30d9\u30eb\u300d\u304c\u8ffd\u52a0\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u6c7a\u5b9a\u30922\u56de\u884c\u3044\u3001\u3088\u308a\u9ad8\u3044\u65b9\u3092\u63a1\u7528\u3059\u308b","\u5408\u7b97\u30c0\u30e1\u30fc\u30b8\u30922\u500d\u3059\u308b","\u9632\u8b77\u70b9\u7121\u52b9"]),"\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868("+(null==(o=e.to_ary(p))[1]?_:o[1])+") \u2192 "+(null==o[0]?_:o[0])},Q.$$arity=0),void e.def(n,"$get_tangle_table",T=function(){var o,p;return p=this.$get_table_by_1d6(["\u982d\u3084\u9854\uff1a\u7259\u3084\u565b\u307f\u3064\u304d\u306a\u3069\u306b\u304a\u3051\u308b\u547d\u4e2d\u529b\u5224\u5b9a\u53ca\u3073\u3001\u9b54\u6cd5\u306e\u884c\u4f7f\u3084\u30d6\u30ec\u30b9\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b","\u6b66\u5668\u3084\u76fe\uff1a\u6b66\u5668\u306e\u4f7f\u7528\u4e0d\u53ef\u3001\u53c8\u306f\u76fe\u306e\u56de\u907f\u529b\u4fee\u6b63\u53ca\u3073\u9632\u8b77\u70b9\u3092\u7121\u52b9\u5316\u3059\u308b","\u8155\u3084\u624b\uff1a\u6b66\u5668\u3084\u722a\u306a\u3069\u306b\u304a\u3051\u308b\u547d\u4e2d\u529b\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3001\u76fe\u3092\u6301\u3064\u8155\u65b9\u306e\u8155\u306a\u3089\u305d\u306e\u76fe\u306e\u56de\u907f\u529b\u4fee\u6b63\u53ca\u3073\u9632\u8b77\u70b9\u3092\u7121\u52b9\u5316\u3059\u308b","\u811a\u3084\u8db3\uff1a\u79fb\u52d5\u4e0d\u53ef\u3001\u66f4\u306b\u56de\u907f\u529b\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b \u203b\u4e21\u8db3\u306b\u7d61\u3093\u3067\u3082\u7d2f\u7a4d\u3057\u306a\u3044","\u80f4\u4f53\uff1a\u751f\u547d\u30fb\u7cbe\u795e\u62b5\u6297\u529b\u3092\u57fa\u6e96\u5024\u306b\u7528\u3044\u308b\u5224\u5b9a\u3092\u9664\u304d\u3001\u3042\u3089\u3086\u308b\u884c\u70ba\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b","\u7279\u6b8a\uff1a\u5c3b\u5c3e\u3084\u7ffc\u306a\u3069\u306b\u547d\u4e2d\u3002\u7d61\u3081\u3089\u308c\u305f\u90e8\u4f4d\u3092\u4f7f\u7528\u3059\u308b\u5224\u5b9a\u306b\u304a\u3044\u3066-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3001\u307e\u305f\u306f\u305d\u3053\u304c\u4f7f\u3048\u3066\u3044\u305f\u3053\u3068\u306b\u3088\u308b\u30dc\u30fc\u30ca\u30b9\u4fee\u6b63\u3092\u5931\u3046 \u203b\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u6c7a\u3081\u76f4\u3057"]),"\u7d61\u307f\u52b9\u679c\u8868("+(null==(o=e.to_ary(p))[1]?_:o[1])+") \u2192 "+(null==o[0]?_:o[0])},T.$$arity=0)},e=Opal,S=[],r=e.nil,_=e.$$$,s=e.$$,Y=e.module,d=e.klass,I=e.send,D=e.hash2,t=e.truthy,C=e.send2,$=e.range,e.top.$require("bcdice/game_system/SwordWorld2_0"),M=S,q=w=[Y(S[0],"BCDice")].concat(M),h=Z=[Y(w[0],"GameSystem")].concat(q),n=d(Z[0],s(Z,"SwordWorld2_0"),"SwordWorld2_5"),f=[n].concat(h),n.$$prototype.randomizer=r,e.const_set(f[0],"ID","SwordWorld2.5"),e.const_set(f[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.5"),e.const_set(f[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.5"),e.const_set(f[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H+(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u5fc5\u6bba\u653b\u6483\u7528\uff09\n\u3000\u300c\uff03\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u7d99\u7d9a\u3055\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09K20#1\u3000\u3000\u3000k10-5@9#2\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r5\n\u3000\u4f8b\uff09K20r5\u3000K30+24@8R5\u3000K40+24@8$12r5\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r5gf\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u30c9\u30eb\u30a4\u30c9\u306e\u7269\u7406\u9b54\u6cd5\u7528\u8868\u3000(Dru[2-6\u306e\u5024,7-9\u306e\u5024,10-12\u306e\u5024])\n\u3000\u4f8b\uff09Dru[0,3,6]+10-3\n\n\u30fb\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u8868\u3000(ABT)\n\u3000\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),n.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT","Dru","ABT"),e.const_set(f[0],"ABYSS_CURSE_TABLE",_(s(f,"DiceTable"),"D66GridTable").$new("\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u8868",[["\u300c\u81ea\u50b7\u306e\u300d\u3000\u88c5\u5099\u6642\u3000\u3053\u306e\u6b66\u5177\u3092\u88c5\u5099\u4e2d\u306b\u88c5\u5099\u8005\u304c\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3092\u767a\u751f\u3055\u305b\u305f\u6642\u3001\u88c5\u5099\u8005\u306eHP\u304c5\u70b9\u6e1b\u5c11\u3059\u308b\u3002","\u300c\u5606\u304d\u306e\u300d\u3000\u88c5\u5099\u6642\u3000\u8fd1\u304f\u306b\u6575\u304c\u3044\u305f\u308a\u3001\u9577\u3044\u7dca\u5f35\u72b6\u614b\u304c\u7d9a\u304f\u3068\u6d99\u304c\u6b62\u307e\u3089\u306a\u304f\u306a\u308b\u3002\u6226\u95d8\u4e2d\u306a\u3089\u300c\u5c04\u7a0b\uff1a\u8853\u8005\uff08\u81ea\u8eab\uff09\u300d\u300c\u5c04\u7a0b\uff1a\u63a5\u89e6\u300d\u4ee5\u5916\u306e\u52b9\u679c\u3067\u5bfe\u8c61\u3092\u9078\u3079\u306a\u304f\u306a\u308b\u3002","\u300c\u512a\u3057\u304d\u300d\u3000\u88c5\u5099\u6642\u3000\u6575\u306b\u540c\u60c5\u3057\u3066\u3057\u307e\u3046\u3002\u6575\u5bfe\u3059\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5bfe\u8c61\u306b\u3059\u308b\u5834\u5408\u3001\u5bfe\u8c61\u306eHP\u304c1\u70b9\u4ee5\u4e0a\u6e1b\u5c11\u3057\u3066\u3044\u308b\u306a\u3089\u547d\u4e2d\u529b\u5224\u5b9a\u3001\u9b54\u6cd5\u884c\u4f7f\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u5dee\u5225\u306e\u300d\u3000\u88c5\u5099\u6642\u3000\u7279\u5b9a\u306e\u5206\u985e\u306b\u5bfe\u3057\u3066\u4e0e\u3048\u308b\u7269\u7406\u30c0\u30e1\u30fc\u30b8\u30fb\u9b54\u6cd5\u30c0\u30e1\u30fc\u30b8\u304c2\u70b9\u6e1b\u5c11\u3059\u308b\u3002\u5206\u985e\u306f\u300c\u5206\u985e\u6c7a\u5b9a\u8868\u300d\u3067\u7121\u4f5c\u70ba\u306b\u6c7a\u5b9a\u3059\u308b\u3002","\u300c\u8106\u5f31\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u9b54\u6cd5\u30c0\u30e1\u30fc\u30b8\u3092\u53d7\u3051\u308b\u305f\u3073\u3001\u305d\u306e\u30c0\u30e1\u30fc\u30b8\u304c+1\u70b9\u3055\u308c\u308b\u3002","\u300c\u7121\u8b00\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u9632\u8b77\u70b9\u304c2\u70b9\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e0\uff09\u3002"],["\u300c\u91cd\u3044\u300d\u3000\u88c5\u5099\u6642\u3000\u5f37\u5316\u3057\u305f\u6b66\u5177\u306e\u5fc5\u8981\u7b4b\u529b\u304c+2\u3055\u308c\u308b\u3002\u5a01\u529b\u3001\u9632\u8b77\u70b9\u306a\u3069\u306f\u5909\u5316\u306a\u3057\u3002","\u300c\u96e3\u3057\u3044\u300d\u3000\u88c5\u5099\u6642\u3000\u3044\u304b\u306a\u308b\u5a01\u529b\u8868\u4f7f\u7528\u6642\u3067\u3082\u3001\u2462\u2463\u6b04\u306e\u6570\u5024\u304c\u5a01\u529b\u306b\u95a2\u4fc2\u306a\u304f\u300c0\u300d\u306b\u306a\u308b\uff08\u81ea\u52d5\u5931\u6557\u3067\u306f\u306a\u3044\uff09\u3002","\u300c\u8edf\u5f31\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u7cbe\u795e\u62b5\u6297\u529b\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u75c5\u5f31\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u751f\u547d\u62b5\u6297\u529b\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u904e\u654f\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u7279\u5b9a\u306e\u5c5e\u6027\u304b\u3089\u53d7\u3051\u308b\u7269\u7406\u30c0\u30e1\u30fc\u30b8\u3001\u9b54\u6cd5\u30c0\u30e1\u30fc\u30b8\u304c2\u70b9\u4e0a\u6607\u3059\u308b\u3002\u5c5e\u6027\u306f\u300c\u5c5e\u6027\u6c7a\u5b9a\u8868\u300d\u3067\u7121\u4f5c\u70ba\u306b\u6c7a\u5b9a\u3059\u308b\u3002","\u300c\u967d\u6c17\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u7cbe\u795e\u62b5\u6297\u5224\u5b9a\u306b\u5931\u6557\u3059\u308b\u305f\u3073\u3001\u7b11\u3044\u304c\u6b62\u307e\u3089\u306a\u304f\u306a\u308b\u3002\u6b21\u306e\u624b\u756a\u7d42\u4e86\u6642\u307e\u3067\u884c\u52d5\u5224\u5b9a\uff08\u300e\u2160\u300f123\u9801\uff09\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002\u3053\u306e\u52b9\u679c\u306f\u7d2f\u7a4d\u3059\u308b\u3002"],["\u300c\u305f\u3069\u305f\u3069\u3057\u3044\u300d\u3000\u88c5\u5099\u6642\u3000\u8a71\u3092\u3059\u308b\u6642\u306b\u8a00\u8449\u306b\u8a70\u307e\u3063\u305f\u308a\u3001\u8a00\u3044\u9593\u9055\u3048\u305f\u308a\u3057\u3084\u3059\u304f\u306a\u308b\u3002\u9b54\u6cd5\u884c\u4f7f\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u4ee3\u5f01\u3059\u308b\u300d\u3000\u88c5\u5099\u6642\u3000\u81ea\u8eab\u306e\u4f1a\u8a71\u306f\u3001\u305d\u306e\u307e\u307e\u6b66\u5177\u304c\u9b54\u6cd5\u6587\u660e\u8a9e\u306e\u805e\u304d\u53d6\u308a\u3065\u3089\u3044\u58f0\u3067\u8a71\u3059\u3002\u88c5\u5099\u4e2d\u306f\u9b54\u6cd5\u6587\u660e\u8a9e\u4ee5\u5916\u306e\u8a00\u8a9e\u3067\u4f1a\u8a71\u306f\u884c\u3048\u305a\u3001\u5996\u7cbe\u9b54\u6cd5\u3001\u9b54\u52d5\u6a5f\u8853\u3092\u884c\u4f7f\u3067\u304d\u306a\u304f\u306a\u308b\u3002","\u300c\u65bd\u3057\u306f\u53d7\u3051\u306a\u3044\u300d\u3000\u88c5\u5099\u6642\u3000\u6226\u95d8\u4e2d\u3001\u300c\u62b5\u6297\uff1a\u4efb\u610f\u300d\u306e\u52b9\u679c\u3092\u53d7\u3051\u5165\u308c\u305f\u5834\u5408\u3001\u6b21\u306e\u624b\u756a\u7d42\u4e86\u6642\u307e\u3067\u751f\u547d\u62b5\u6297\u529b\u3001\u7cbe\u795e\u62b5\u6297\u529b\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u6b7b\u306b\u8fd1\u3044\u300d\u3000\u643a\u884c\u6642\u3000\u5e38\u306b\u751f\u6b7b\u5224\u5b9a\u306b\u300c\u5192\u967a\u8005\u30ec\u30d9\u30eb\u300d\u3068\u540c\u3058\u5024\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u304a\u3057\u3083\u308c\u306a\u300d\u3000\u643a\u884c\u6642\u3000\u305d\u306e\u6b66\u5177\u3092\u5e38\u306b\u83ef\u7f8e\u306b\u98fe\u308a\u305f\u304f\u306a\u308b\u3002\u53ce\u5165\u3092\u5f97\u308b\u305f\u3073\u3001\u305d\u306e1\u5272\u4ee5\u4e0a\u3092\u3053\u306e\u6b66\u5177\u306e\u88c5\u98fe\u306b\u8cbb\u3084\u3055\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\uff08\u52b9\u679c\u306a\u3069\u306b\u5909\u5316\u306f\u306a\u3044\uff09\u3002","\u300c\u30de\u30ca\u3092\u5438\u3046\u300d\u3000\u643a\u884c\u6642\u3000\u9b54\u6cd5\u3084\u7df4\u6280\u306a\u3069\u3001\u81ea\u8eab\u306e\u610f\u601d\u3067MP\u3092\u6d88\u8cbb\u3059\u308b\u52b9\u679c\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u3001\u3059\u3079\u3066\u306eMP\u6d88\u8cbb\u304c1\u70b9\u4e0a\u6607\u3059\u308b\u3002"],["\u300c\u920d\u91cd\u306a\u300d\u3000\u643a\u884c\u6642\u3000\u79fb\u52d5\u529b\u304c\u534a\u5206\uff08\u7aef\u6570\u5207\u308a\u4e0a\u3052\uff09\u306b\u306a\u308b\u3002","\u300c\u5b9a\u307e\u3089\u306a\u3044\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u4e2d\u306e\u624b\u756a\u958b\u59cb\u6642\u306b1d\u3057\u3001\u51fa\u76ee\u304c\u300c1\u300d\u306a\u3089\u300a\u30bf\u30fc\u30b2\u30c3\u30c6\u30a3\u30f3\u30b0\u300b\u3068\u305d\u308c\u3092\u524d\u63d0\u3068\u3057\u305f\u6226\u95d8\u7279\u6280\u3092\u7fd2\u5f97\u3057\u3066\u3044\u306a\u3044\u3082\u306e\u3068\u3057\u3066\u6271\u3046\u3002","\u300c\u932f\u4e71\u306e\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u4e2d\u306e\u624b\u756a\u958b\u59cb\u6642\u306b1d\u3057\u3001\u51fa\u76ee\u304c\u300c1\u300d\u306a\u3089\u8fd1\u63a5\u653b\u6483\u3092\u542b\u3080\u300c\u5c04\u7a0b\uff1a\u63a5\u89e6\u300d\u306e\u5bfe\u8c61\u306b\u52b9\u679c\u3092\u4f7f\u7528\u3059\u308b\u969b\u3001\u5bfe\u8c61\u306f\u540c\u3058\u4f4d\u7f6e\uff08\u30a8\u30ea\u30a2\u3001\u5ea7\u6a19\uff09\u306e\u5168\u3066\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\uff08\u6575\u5473\u65b9\u542b\u3080\uff09\u304b\u3089\u7121\u4f5c\u70ba\u306b\u9078\u3070\u308c\u308b\u3002","\u300c\u8db3\u7d61\u307f\u306e\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u4e2d\u306e\u624b\u756a\u958b\u59cb\u6642\u306b1d\u3057\u3001\u51fa\u76ee\u304c\u300c1\u300d\u306a\u3089\u305d\u306e\u5834\u3067\u5373\u5ea7\u306b\u8ee2\u5012\u3059\u308b\u3002\u624b\u756a\u4e2d\u306b\u306f\u8d77\u304d\u4e0a\u304c\u308c\u306a\u3044\u3002","\u300c\u6ed1\u308a\u843d\u3061\u308b\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u4e2d\u306e\u624b\u756a\u958b\u59cb\u6642\u306b1d\u3057\u3001\u51fa\u76ee\u304c\u300c1\u300d\u306a\u3089\u624b\u306b\u88c5\u5099\u307e\u305f\u306f\u4fdd\u6301\u3057\u3066\u3044\u308b\u3082\u306e\u3092\u3059\u3079\u3066\u305d\u306e\u5834\u306b\u843d\u3068\u3059\uff08\u305d\u306e\u624b\u756a\u306e\u4e3b\u52d5\u4f5c\u3067\u62fe\u3046\u4e8b\u306f\u53ef\u80fd\uff09\u3002","\u300c\u60aa\u81ed\u653e\u3064\u300d\u3000\u643a\u884c\u6642\u3000\u5f37\u3044\u60aa\u81ed\u3092\u653e\u3064\u3002\u6240\u6301\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e0d\u5feb\u611f\u3092\u4e0e\u3048\u3001\u96a0\u5bc6\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002\u3055\u3089\u306b\u5192\u967a\u8005\u30e9\u30f3\u30af\uff08\u300e\u2161\u300f137\u9801\uff09\u304c1\u6bb5\u968e\u4f4e\u3044\u3082\u306e\u3068\u3057\u3066\u6271\u308f\u308c\u308b\u3002"],["\u300c\u919c\u60aa\u306a\u300d\u3000\u643a\u884c\u6642\u3000\u6b66\u5177\u306e\u898b\u305f\u76ee\u304c\u60aa\u304f\u3001\u9b45\u529b\u304c\u306a\u3044\u3002\u58f2\u5374\u3059\u308b\u969b\u3001\u57fa\u672c\u53d6\u5f15\u4fa1\u683c\u306e4\u5206\u306e1\u306e\u4fa1\u683c\u3067\u58f2\u5374\u3059\u308b\u3002\u3055\u3089\u306b\u5192\u967a\u8005\u30e9\u30f3\u30af\uff08\u300e\u2161\u300f137\u9801\uff09\u304c1\u6bb5\u968e\u4f4e\u3044\u3082\u306e\u3068\u3057\u3066\u6271\u308f\u308c\u308b\u3002","\u300c\u5538\u308b\u300d\u3000\u643a\u884c\u6642\u3000\u305d\u306e\u6b66\u5177\u304b\u3089\u5e38\u306b\u7fbd\u866b\u304c\u98db\u3073\u4ea4\u3046\u3088\u3046\u306a\u97f3\u304c\u97ff\u304f\u3002\u96a0\u5bc6\u5224\u5b9a\u3001\u5371\u967a\u611f\u77e5\u5224\u5b9a\u306b-4\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u3075\u3084\u3051\u305f\u300d\u3000\u643a\u884c\u6642\u3000\u6c34\u3092\u5438\u3063\u305f\u3088\u3046\u306b\u3075\u3084\u3051\u305f\u8cea\u611f\u3092\u3057\u3066\u3044\u308b\u3002\u8ffd\u52a0\u30c0\u30e1\u30fc\u30b8-1\uff08\u6b66\u5668\uff09\u3001\u9632\u8b77\u70b9-1\uff08\u93a7\u3001\u76fe\uff09\u3002\u75c5\u6c17\u5c5e\u6027\u306e\u52b9\u679c\u306b\u5bfe\u3059\u308b\u751f\u547d\u62b5\u6297\u529b\u3001\u7cbe\u795e\u62b5\u6297\u529b\u5224\u5b9a\u306b-4\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u53e4\u50b7\u306e\u300d\u3000\u643a\u884c\u6642\u3000HP\u3092\u56de\u5fa9\u3059\u308b\u52b9\u679c\uff08\u4f11\u606f\u306b\u3088\u308b\u56de\u5fa9\u3092\u542b\u3080\uff09\u3092\u53d7\u3051\u305f\u5834\u5408\u3001\u305d\u306e\u56de\u5fa9\u91cf\u304c1\u70b9\u6e1b\u5c11\u3059\u308b\u3002","\u300c\u307e\u3070\u3086\u3044\u300d\u3000\u643a\u884c\u6642\u3000\u5149\u306a\u3069\u3092\u5f3e\u3044\u3066\u5f37\u304f\u8f1d\u304f\u3002\u81ea\u8eab\u306f\u5e38\u306b\u8996\u754c\u304c\u60aa\u3044\u4e8b\u306b\u3088\u308b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u6804\u5149\u306a\u304d\u300d\u3000\u643a\u884c\u6642\u3000\u884c\u70ba\u5224\u5b9a\u3067\u81ea\u52d5\u6210\u529f\u3057\u305f\u969b\u3001\u81ea\u52d5\u6210\u529f\u3068\u306f\u6271\u308f\u305a\u30012d\u3092\u632f\u308a\u76f4\u3057\u3001\u305d\u306e\u5f8c\u306e\u51fa\u76ee\u306b\u5f93\u3046\u3002\u3053\u306e\u52b9\u679c\u306f1\u65e5\u306b1\u56de\u306e\u307f\u767a\u63ee\u3055\u308c\u308b\u3002"],["\u300c\u6b63\u76f4\u8005\u306e\u300d\u3000\u643a\u884c\u6642\u3000\u5618\u3001\u65b9\u4fbf\u304c\u3059\u3050\u3070\u308c\u308b\u3088\u3046\u306b\u306a\u308b\u3002\u771f\u507d\u5224\u5b9a\u306e\u5bfe\u8c61\u3068\u306a\u308b\u5834\u5408\u3001-4\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u4e57\u308a\u7269\u9154\u3044\u306e\u300d\u3000\u643a\u884c\u6642\u3000\u63fa\u308c\u306b\u5f31\u304f\u306a\u308b\u3002\u81ea\u8eab\u306e\u8db3\u4ee5\u5916\u306e\u624b\u6bb5\u306710\u5206\u4ee5\u4e0a\u79fb\u52d5\u3057\u305f\u5f8c\u30011\u6642\u9593\u3001\u884c\u52d5\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u78a7\u3092\u53ad\u3046\u300d\u3000\u643a\u884c\u6642\u3000\u81ea\u7136\u306e\u4e2d\u3067\u306f\u843d\u3061\u7740\u304b\u306a\u304f\u306a\u308b\u3002\u81ea\u7136\u74b0\u5883\uff08\u300e\u2160\u300f108\u9801\uff09\u3067\u306f\u884c\u52d5\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u6211\u6162\u3067\u304d\u306a\u3044\u300d\u3000\u643a\u884c\u6642\u3000\u30bb\u30c3\u30b7\u30e7\u30f3\u4e2d\u306b1\u65e5\u306e\u59cb\u307e\u308a\u3092\u8fce\u3048\u308b\u305f\u3073\u3001\u8da3\u5473\u3084\u55dc\u597d\u54c1\u306a\u3069\u306b\u300c\u5192\u967a\u8005\u30ec\u30d9\u30eb\xd710\u300d\u30ac\u30e1\u30eb\u3092\u51fa\u8cbb\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002\u8da3\u5473\u3084\u55dc\u597d\u54c1\u304c\u6d88\u8cbb\u3067\u304d\u306a\u3044\u74b0\u5883\u3067\u3042\u308c\u3070\u3001\u7fcc\u65e5\u306e\u671d\u307e\u3067\u6700\u5927HP\u3001\u6700\u5927MP\u304c\u300c\u5192\u967a\u8005\u30ec\u30d9\u30eb\u300d\u70b9\u6e1b\u5c11\u3059\u308b\u3002","\u300c\u3064\u304d\u307e\u3068\u3046\u300d\u3000\u643a\u884c\u6642\u3000\u3053\u306e\u6b66\u5177\u304c\u6c17\u304c\u3064\u3051\u3070\u8eab\u306e\u56de\u308a\u306b\u3042\u308b\u3002\u3053\u306e\u6b66\u5177\u4ee5\u5916\u3067\u306e\u547d\u4e2d\u529b\u5224\u5b9a\u3001\u9b54\u6cd5\u884c\u4f7f\u5224\u5b9a\uff08\u6b66\u5668\uff09\u3001\u56de\u907f\u529b\u5224\u5b9a\uff08\u93a7\u3001\u76fe\uff09\u306b-4\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u306e\u308d\u307e\u306a\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u958b\u59cb\u51e6\u7406\u306e\u300c\u6226\u95d8\u6e96\u5099\u300d\u3092\u3044\u3063\u3055\u3044\u884c\u3048\u306a\u304f\u306a\u308b\u3002"]])),e.const_set(f[0],"ABYSS_CURSE_CATEGORY_TABLE",_(s(f,"DiceTable"),"D66ParityTable").$new("\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u5206\u985e\u6c7a\u5b9a\u8868",["\u86ee\u65cf","\u52d5\u7269","\u690d\u7269","\u30a2\u30f3\u30c7\u30c3\u30c9","\u9b54\u6cd5\u751f\u7269","\u300c\u86ee\u65cf\u300d\u300c\u52d5\u7269\u300d\u300c\u690d\u7269\u300d\u300c\u30a2\u30f3\u30c7\u30c3\u30c9\u300d\u300c\u9b54\u6cd5\u751f\u7269\u300d\u304b\u3089\u4efb\u610f"],["\u9b54\u52d5\u6a5f","\u5e7b\u7363","\u5996\u7cbe","\u9b54\u795e","\u4eba\u65cf","\u300c\u9b54\u52d5\u6a5f\u300d\u300c\u5e7b\u7363\u300d\u300c\u5996\u7cbe\u300d\u300c\u9b54\u795e\u300d\u300c\u4eba\u65cf\u300d\u304b\u3089\u4efb\u610f"])),e.const_set(f[0],"ABYSS_CURSE_ATTR_TABLE",_(s(f,"DiceTable"),"D66ParityTable").$new("\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u5c5e\u6027\u6c7a\u5b9a\u8868",["\u571f","\u6c34\u30fb\u6c37","\u708e","\u98a8","\u96f7","\u7d14\u7c8b\u30a8\u30cd\u30eb\u30ae\u30fc"],["\u65ad\u7a7a","\u885d\u6483","\u6bd2","\u75c5\u6c17","\u546a\u3044","\u7cbe\u795e\u52b9\u679c"])),e.def(n,"$eval_game_system_specific_command",u=function(b){var m,T=this,o=r,v=r;return u.$$p&&(u.$$p=null),/^dru\[(\d+),(\d+),(\d+)\]/i["$==="](m=b)?(o=I(s(f,"Regexp").$last_match().$captures(),"map",[],"to_i".$to_proc()),v=_(s(f,"Command"),"Parser").$new(/dru\[\d+,\d+,\d+\]/i,D(["round_type"],{round_type:_(_(s(f,"BCDice"),"RoundType"),"CEIL")})).$parse(b),t(v)?T.$druid_dice(v,o):r):"ABT"["$==="](m)?T.$get_abyss_curse_table():C(T,e.find_super_dispatcher(T,"eval_game_system_specific_command",u,!1,!0),"eval_game_system_specific_command",[b],null)},u.$$arity=1),e.def(n,"$rating_parser",x=function(){return s(f,"RatingParser").$new(D(["version"],{version:"v2_5"}))},x.$$arity=0),e.def(n,"$druid_dice",E=function(b,B){var m,v,y,o,p,T=r;return p=m=(T=this.randomizer.$roll_barabara(2,6)).$sum(),o=$(2,6,!1)["$==="](p)?0:$(7,9,!1)["$==="](p)?1:$(10,12,!1)["$==="](p)?2:r,y=function(P,M){return"number"==typeof P&&"number"==typeof M?P+M:P["$+"](M)}(v=B["$[]"](o),b.$modify_number()),["("+b.$command().$capitalize()+s(f,"Format").$modifier(b.$modify_number())+")","2D["+T.$join(",")+"]="+m,""+v+s(f,"Format").$modifier(b.$modify_number()),y].$join(" \uff1e ")},E.$$arity=2),e.def(n,"$get_abyss_curse_table",c=function(){var T,b=this,B=r,Q=r;return T=(B=s(f,"ABYSS_CURSE_TABLE").$roll(b.randomizer)).$value(),Q=14["$==="](T)?s(f,"ABYSS_CURSE_CATEGORY_TABLE").$roll(b.randomizer).$to_s():25["$==="](T)?s(f,"ABYSS_CURSE_ATTR_TABLE").$roll(b.randomizer).$to_s():r,[B.$to_s(),Q].$compact().$join("\n")},c.$$arity=0)}}]);