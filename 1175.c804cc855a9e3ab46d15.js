(self.webpackChunkudonarium_lily_gk=self.webpackChunkudonarium_lily_gk||[]).push([[1175],{1175:function(Xe,Je,Ze){Ze(4656),Opal.modules["i18n/backend/fallbacks"]=function(e){function j(E,i){return"number"==typeof E&&"number"==typeof i?E-i:E["$-"](i)}var i,f,U,S,H,A,V,w=[],r=e.nil,x=e.$$$,$=e.$$,Q=e.module,u=e.truthy,N=e.send,C=e.send2,t=e.hash2;return i=w,V=[A=Q(w[0],"I18n")].concat(i),e.class_variable_set(V[0],"@@fallbacks",r),f=e.get_singleton_class(A),H=[f].concat(V),e.def(f,"$fallbacks",U=function(){var L,n,l;return e.class_variable_set(H[1],"@@fallbacks",u(l=null==(L=H[1].$$cvars["@@fallbacks"])?r:L)?l:x(x($(H,"I18n"),"Locale"),"Fallbacks").$new()),u(n=$(H,"Thread").$current()["$[]"]("i18n_fallbacks"))?n:null==(L=H[1].$$cvars["@@fallbacks"])?r:L},U.$$arity=0),e.def(f,"$fallbacks=",S=function(L){var z,n;return e.class_variable_set(H[1],"@@fallbacks",u(L["$is_a?"]($(H,"Array")))?x(x($(H,"I18n"),"Locale"),"Fallbacks").$new(L):L),n=["i18n_fallbacks",null==(z=H[1].$$cvars["@@fallbacks"])?r:z],N($(H,"Thread").$current(),"[]=",e.to_a(n)),n[j(n.length,1)]},S.$$arity=1),void function(f,D){var U=[Q(f,"Backend")].concat(D);!function(S,Y){var l,n,m,_,L=Q(S,"Fallbacks"),z=[L].concat(Y);e.def(L,"$translate",l=function(g,b,p){try{var y,B=l.$$p,v=this,o=r,c=r,h=r,R=r,I=r,a=r;for(B&&(l.$$p=null),I=0,a=arguments.length,R=new Array(a);I<a;I++)R[I]=arguments[I];return null==p&&(p=$(z,"EMPTY_HASH")),!u(p.$fetch("fallback",!0))||u(p["$[]"]("fallback_in_progress"))?C(v,e.find_super_dispatcher(v,"translate",l,!1,!0),"translate",R,B):(u(p["$[]"]("default"))&&(o=v["$extract_non_symbol_default!"](p)),c=p.$merge(t(["fallback_in_progress"],{fallback_in_progress:!0})),N($(z,"I18n").$fallbacks()["$[]"](g),"each",[],((y=function(K){var $e,te=null==y.$$s?this:y.$$s;null==K&&(K=r);try{return N(te,"catch",["exception"],(($e=function(){var ge=null==$e.$$s?this:$e.$$s,Te=r;if(Te=C(ge,e.find_iter_super_dispatcher(ge,"translate",$e.$$def||y.$$def||l,!1,!1),"translate",[K,b,c],null),u(Te["$nil?"]()))return r;u(g.$to_s()["$!="](K.$to_s()))&&ge.$on_fallback(g,K,b,p),e.ret(Te)}).$$s=te,$e.$$arity=0,$e))}catch(ye){if(!e.rescue(ye,[x($(z,"I18n"),"InvalidLocale")]))throw ye;try{return r}finally{e.pop_exception()}}}).$$s=v,y.$$arity=1,y)),u(u(h=p["$key?"]("default"))?p["$[]"]("default")["$nil?"]():h)?r:u(o)?C(v,e.find_super_dispatcher(v,"translate",l,!1,!0),"translate",[g,r,p.$merge(t(["default"],{default:o}))],null):v.$throw("exception",x($(z,"I18n"),"MissingTranslation").$new(g,b,p)))}catch(T){if(T===e.returner)return T.$v;throw T}},l.$$arity=-3),e.def(L,"$extract_non_symbol_default!",n=function(g){var b,B,y=r,W=r;return y=[g["$[]"]("default")].$flatten(),B=N(y,"detect",[],((b=function(o){return null==o&&(o=r),o["$is_a?"]($(z,"Symbol"))["$!"]()}).$$s=this,b.$$arity=1,b)),u(B)&&(W=["default",y["$[]"](0,y.$index(B))],N(g,"[]=",e.to_a(W)),j(W.length,1)),B},n.$$arity=1),e.def(L,"$exists?",m=function(g,b,p){try{var y,B=m.$$p,v=this,o=r,c=r,h=r;for(B&&(m.$$p=null),c=0,h=arguments.length,o=new Array(h);c<h;c++)o[c]=arguments[c];return null==p&&(p=$(z,"EMPTY_HASH")),u(p.$fetch("fallback",!0))?(N($(z,"I18n").$fallbacks()["$[]"](g),"each",[],((y=function(I){var a=null==y.$$s?this:y.$$s;null==I&&(I=r);try{if(!u(C(a,e.find_iter_super_dispatcher(a,"exists?",y.$$def||m,!1,!1),"exists?",[I,b],null)))return r;e.ret(!0)}catch(T){if(!e.rescue(T,[x($(z,"I18n"),"InvalidLocale")]))throw T;try{return r}finally{e.pop_exception()}}}).$$s=v,y.$$arity=1,y)),!1):C(v,e.find_super_dispatcher(v,"exists?",m,!1,!0),"exists?",o,B)}catch(R){if(R===e.returner)return R.$v;throw R}},m.$$arity=-3),L.$private(),e.def(L,"$on_fallback",_=function(g,b,p,y){return r},_.$$arity=4)}(U[0],U)}(V[0],V)},Opal.modules["bcdice/randomizer"]=function(e){function j(f,D){return"number"==typeof f&&"number"==typeof D?f>D:f["$>"](D)}function X(f,D){return"number"==typeof f&&"number"==typeof D?f+D:f["$+"](D)}function w(f,D){return"number"==typeof f&&"number"==typeof D?f<=D:f["$<="](D)}function r(f,D){return"number"==typeof f&&"number"==typeof D?f-D:f["$-"](D)}function x(f,D){return"number"==typeof f&&"number"==typeof D?f*D:f["$*"](D)}var D,L,n,m,_,d,g,b,p,y,B,W,v,z,l,U,u=[],N=e.nil,C=e.$$$,t=e.$$,i=e.klass,A=e.truthy,V=e.send;return D=u,L=U=[(0,e.module)(u[0],"BCDice")].concat(D),z=i(U[0],null,"Randomizer"),l=[z].concat(L),z.$$prototype.rand_results=z.$$prototype.detailed_rand_results=N,e.const_set(l[0],"UPPER_LIMIT_DICE_TIMES",200),e.const_set(l[0],"UPPER_LIMIT_DICE_SIDES",1e3),e.const_set(l[0],"UPPER_LIMIT_RANDS",1e4),e.def(z,"$initialize",n=function(){return this.rand_results=[],this.detailed_rand_results=[]},n.$$arity=0),z.$attr_reader("rand_results"),z.$attr_reader("detailed_rand_results"),e.const_set(l[0],"DetailedRandResult",t(l,"Struct").$new("kind","sides","value")),e.def(z,"$roll_barabara",m=function(c,h){var R,a,I=this;return A(j(X(I.rand_results.$size(),c),t(l,"UPPER_LIMIT_RANDS")))&&I.$raise(t(l,"TooManyRandsError")),A(A(a=w(c,0))?a:j(c,t(l,"UPPER_LIMIT_DICE_TIMES")))?[]:V(t(l,"Array"),"new",[c],((R=function(){return(null==R.$$s?this:R.$$s).$roll_once(h)}).$$s=I,R.$$arity=0,R))},m.$$arity=2),e.def(z,"$roll_sum",_=function(c,h){return this.$roll_barabara(c,h).$sum()},_.$$arity=2),e.def(z,"$roll_once",d=function(c){var R,I=N;return A(A(R=w(c,0))?R:j(c,t(l,"UPPER_LIMIT_DICE_SIDES")))?0:(I=this.$rand_inner(c),this.$push_to_detail("normal",c,I),I)},d.$$arity=1),e.def(z,"$roll_index",g=function(c){return r(this.$roll_once(c),1)},g.$$arity=1),e.def(z,"$roll_tens_d10",b=function(){var R,h=N;return(h=this.$rand_inner(10))["$=="](10)&&(h=0),R=x(h,10),this.$push_to_detail("tens_d10",10,R),R},b.$$arity=0),e.def(z,"$roll_d9",p=function(){var h;return h=r(this.$rand_inner(10),1),this.$push_to_detail("d9",10,h),h},p.$$arity=0),e.def(z,"$roll_d66",y=function(c){var h,a,I=N;return I=V(t(l,"Array"),"new",[2],((h=function(){return(null==h.$$s?this:h.$$s).$roll_once(6)}).$$s=this,h.$$arity=0,h)),a=c,C(t(l,"D66SortType"),"ASC")["$==="](a)?I["$sort!"]():C(t(l,"D66SortType"),"DESC")["$==="](a)&&I["$sort!"]()["$reverse!"](),X(x(I["$[]"](0),10),I["$[]"](1))},y.$$arity=1),z.$private(),e.def(z,"$rand_inner",B=function(c){var R,h=this;return A(function(f,D){return"number"==typeof f&&"number"==typeof D?f>=D:f["$>="](D)}(h.rand_results.$size(),t(l,"UPPER_LIMIT_RANDS")))&&h.$raise(t(l,"TooManyRandsError")),R=h.$random(c),h.rand_results["$<<"]([R,c]),R},B.$$arity=1),e.def(z,"$random",W=function(c){return X(t(l,"Kernel").$rand(c),1)},W.$$arity=1),e.def(z,"$push_to_detail",v=function(c,h,R){var a;return a=t(l,"DetailedRandResult").$new(c,h,R),this.detailed_rand_results.$push(a)},v.$$arity=3),void function(S,Y,L){[i(S,Y,"TooManyRandsError")].concat(L)}(U[0],t(U,"StandardError"),U)},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var C,A,U,L,z,l,n,S,Y,f,E,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.klass,u=e.truthy;return C=X,A=E=[$(X[0],"BCDice")].concat(C),U=f=[$(E[0],"DiceTable")].concat(A),S=Q(f[0],null,"RollResult"),Y=[S].concat(U),S.$$prototype.table_name=S.$$prototype.value=S.$$prototype.body=w,e.def(S,"$initialize",L=function(_,d,g){var b=this;return b.table_name=_,b.value=d,b.body=g},L.$$arity=3),S.$attr_reader("table_name"),S.$attr_reader("value"),S.$attr_reader("body"),e.def(S,"$to_s",z=function(){var _=this;return _.table_name+"("+_.value+") \uff1e "+_.body},z.$$arity=0),e.def(S,"$last_body",l=function(){var _=this;return u(_.body["$is_a?"](x(Y,"RollResult")))?_.body.$last_body():_.body},l.$$arity=0),void e.def(S,"$empty?",n=function(){return!1},n.$$arity=0)},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var t,V,S,z,l,Y,L,D,i,w=[],r=e.nil,$=e.$$,Q=e.module,u=e.klass,N=e.truthy;return t=w,V=i=[Q(w[0],"BCDice")].concat(t),S=D=[Q(i[0],"DiceTable")].concat(V),Y=u(D[0],null,"ChainTable"),L=[Y].concat(S),Y.$$prototype.times=Y.$$prototype.sides=Y.$$prototype.items=Y.$$prototype.name=r,e.def(Y,"$initialize",z=function(m,_,d){var g=this,b=r;return g.name=m,g.items=d.$freeze(),b=/(\d+)D(\d+)/i.$match(_),N(b)||g.$raise($(L,"ArgumentError"),"Unexpected table type: "+_),g.times=b["$[]"](1).$to_i(),g.sides=b["$[]"](2).$to_i()},z.$$arity=3),void e.def(Y,"$roll",l=function(m){var d,g,_=this,b=r;return g=function(C,t){return"number"==typeof C&&"number"==typeof t?C-t:C["$-"](t)}(d=m.$roll_sum(_.times,_.sides),_.times),b=_.items["$[]"](g),N(b["$respond_to?"]("roll"))&&(b=b.$roll(m)),$(L,"RollResult").$new(_.name,d,b)},l.$$arity=1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){function w(E,i){return"number"==typeof E&&"number"==typeof i?E-i:E["$-"](i)}var i,D,L,n,m,_,z,l,U,V,x=[],$=e.nil,u=e.$$,N=e.module,C=e.klass,t=e.hash2;return i=x,D=V=[N(x[0],"BCDice")].concat(i),L=U=[N(V[0],"DiceTable")].concat(D),z=C(U[0],null,"D66GridTable"),l=[z].concat(L),z.$$prototype.name=z.$$prototype.items=$,e.defs(z,"$from_i18n",n=function(g,b){var y=$;return y=u(l,"I18n").$t(g,t(["locale","raise"],{locale:b,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items"))},n.$$arity=2),e.def(z,"$initialize",m=function(g,b){return this.name=g,this.items=b.$freeze()},m.$$arity=2),void e.def(z,"$roll",_=function(g){var p,y,B,W,v,E;return p=g.$roll_once(6),y=g.$roll_once(6),B=function(E,i){return"number"==typeof E&&"number"==typeof i?E+i:E["$+"](i)}("number"==typeof(E=p)?10*E:E["$*"](10),y),W=w(p,1),v=w(y,1),u(l,"RollResult").$new(this.name,B,this.items["$[]"](W)["$[]"](v))},_.$$arity=1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var C,A,U,L,z,S,Y,f,E,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.klass,u=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),C=X,A=E=[$(X[0],"BCDice")].concat(C),U=f=[$(E[0],"DiceTable")].concat(A),S=Q(f[0],x(f,"D66GridTable"),"D66HalfGridTable"),Y=[S].concat(U),e.defs(S,"$from_i18n",L=function(n,m){var d=w;return d=x(Y,"I18n").$t(n,u(["locale","raise"],{locale:m,raise:!0})),this.$new(d["$[]"]("name"),d["$[]"]("items_1_2_3"),d["$[]"]("items_4_5_6"))},L.$$arity=2),void e.def(S,"$initialize",z=function(n,m,_){return this.name=n,this.items=[m,m,m,_,_,_].$freeze()},z.$$arity=3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var C,A,U,L,z,S,Y,f,E,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.klass,u=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),C=X,A=E=[$(X[0],"BCDice")].concat(C),U=f=[$(E[0],"DiceTable")].concat(A),S=Q(f[0],x(f,"D66GridTable"),"D66OneThirdTable"),Y=[S].concat(U),e.defs(S,"$from_i18n",L=function(n,m){var d=w;return d=x(Y,"I18n").$t(n,u(["locale","raise"],{locale:m,raise:!0})),this.$new(d["$[]"]("name"),d["$[]"]("items_1_2"),d["$[]"]("items_3_4"),d["$[]"]("items_5_6"))},L.$$arity=2),void e.def(S,"$initialize",z=function(n,m,_,d){return this.name=n,this.items=[m,m,_,_,d,d].$freeze()},z.$$arity=4)},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var i,D,L,n,m,_,z,l,U,V,r=[],x=e.nil,$=e.$$$,Q=e.$$,u=e.module,N=e.klass,C=e.hash2,t=e.truthy;return i=r,D=V=[u(r[0],"BCDice")].concat(i),L=U=[u(V[0],"DiceTable")].concat(D),z=N(U[0],null,"D66Table"),l=[z].concat(L),z.$$prototype.sort_type=z.$$prototype.items=z.$$prototype.name=x,e.defs(z,"$from_i18n",n=function(g,b){var B,y=x;return y=Q(l,"I18n").$t(g,C(["locale"],{locale:b})),B=Q(l,"D66SortType").$const_get(y["$[]"]("d66_sort_type")),this.$new(y["$[]"]("name"),B,y["$[]"]("items"))},n.$$arity=2),e.def(z,"$initialize",m=function(g,b,p){var y=this;return y.name=g,y.sort_type=b,y.items=p.$freeze()},m.$$arity=3),void e.def(z,"$roll",_=function(g){var y,v,E,b=this,p=x,B=x,W=x;return p=g.$roll_barabara(2,6),y=b.sort_type,$(Q(l,"D66SortType"),"ASC")["$==="](y)?p["$sort!"]():$(Q(l,"D66SortType"),"DESC")["$==="](y)&&p["$sort!"]()["$reverse!"](),B=function(E,i){return"number"==typeof E&&"number"==typeof i?E+i:E["$+"](i)}("number"==typeof(E=p["$[]"](0))?10*E:E["$*"](10),p["$[]"](1)),W=t(v=b.items["$[]"](B))?v:b.items["$[]"](B.$to_s()),t(W["$respond_to?"]("roll"))&&(W=W.$roll(g)),Q(l,"RollResult").$new(b.name,B,W)},_.$$arity=1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){function j(A,V){return"number"==typeof A&&"number"==typeof V?A+V:A["$+"](V)}var V,l,_,n,U,Y,D,x=[],$=e.nil,u=e.$$,N=e.module,C=e.klass,t=e.hash2,E=e.send,i=e.send2;return e.top.$require("bcdice/dice_table/d66_table"),V=x,U=D=[N(x[0],"BCDice")].concat(V),l=Y=[N(D[0],"DiceTable")].concat(U),[n=C(Y[0],u(Y,"D66Table"),"D66LeftRangeTable")].concat(l),void e.def(n,"$initialize",_=function(g,b,p){var y,o,v=this;return _.$$p&&(_.$$p=null),o=t([],{}),E(p,"each",[],((y=function(c){function h(R){return c.apply(this,arguments)}return h.toString=function(){return c.toString()},h}(function(c){var R,a,K,h=null==y.$$s?this:y.$$s;return null==c&&(c=$),R=e.to_ary(c),K=null==R[1]?$:R[1],E(null==R[0]?$:R[0],"each",[],((a=function($e){var ge;return null==$e&&($e=$),E(K,"each_with_index",[],((ge=function(Be,ze){var Ae,fe,A;return null==Be&&(Be=$),null==ze&&(ze=$),Ae=j("number"==typeof(A=$e)?10*A:A["$*"](10),j(ze,1)),E(o,"[]=",e.to_a(fe=[Ae,Be])),fe[function(A,V){return"number"==typeof A?A-1:A["$-"](1)}(fe.length)]}).$$s=null==a.$$s?this:a.$$s,ge.$$arity=2,ge))}).$$s=h,a.$$arity=1,a))})).$$s=v,y.$$arity=1,y)),i(v,e.find_super_dispatcher(v,"initialize",_,!1,!0),"initialize",[g,b,o],null)},_.$$arity=3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var i,D,L,n,m,z,l,U,V,x=[],$=e.nil,u=e.$$,N=e.module,C=e.klass,t=e.truthy;return i=x,D=V=[N(x[0],"BCDice")].concat(i),L=U=[N(V[0],"DiceTable")].concat(D),z=C(U[0],null,"D66ParityTable"),l=[z].concat(L),z.$$prototype.odd=z.$$prototype.even=z.$$prototype.name=$,e.def(z,"$initialize",n=function(d,g,b){var p=this;return p.name=d,p.odd=g.$freeze(),p.even=b.$freeze()},n.$$arity=3),void e.def(z,"$roll",m=function(d){var p,B,W,E,g=this,b=$;return b=d.$roll_once(6),p=d.$roll_once(6),B=(t(b["$odd?"]())?g.odd:g.even)["$[]"]("number"==typeof(E=p)?E-1:E["$-"](1)),W=function(E,i){return"number"==typeof E&&"number"==typeof i?E+i:E["$+"](i)}(function(E,i){return"number"==typeof E?10*E:E["$*"](10)}(b),p),u(l,"RollResult").$new(g.name,W,B)},m.$$arity=1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var E,f,Y,l,n,L,z,H,A,r=[],x=e.nil,Q=e.$$,u=e.module,N=e.klass,C=e.send;return E=r,f=A=[u(r[0],"BCDice")].concat(E),Y=H=[u(A[0],"DiceTable")].concat(f),L=N(H[0],null,"D66RangeTable"),z=[L].concat(Y),L.$$prototype.items=L.$$prototype.name=x,e.def(L,"$initialize",l=function(_,d){return this.name=_,this.items=d.$freeze()},l.$$arity=2),void e.def(L,"$roll",n=function(_){var d,b,p,y,t,g=this,B=x;return b=_.$roll_once(6),p=_.$roll_once(6),y=function(t,E){return"number"==typeof t&&"number"==typeof E?t+E:t["$+"](E)}("number"==typeof(t=b)?10*t:t["$*"](10),p),B=C(g.items,"find",[],((d=function(v){return null==v&&(v=x),v["$[]"](0)["$include?"](y)}).$$s=g,d.$$arity=1,d)),Q(z,"RollResult").$new(g.name,y,B["$[]"](1))},n.$$arity=1)},Opal.modules["bcdice/dice_table/range_table"]=function(e){var A,H,z,m,_,d,g,b,p,y,B,W,l,n,S,f,x=[],$=e.nil,u=e.$$,N=e.module,C=e.klass,t=e.send,E=e.truthy;return A=x,H=f=[N(x[0],"BCDice")].concat(A),z=S=[N(f[0],"DiceTable")].concat(H),l=C(S[0],null,"RangeTable"),n=[l].concat(z),l.$$prototype.name=l.$$prototype.items=l.$$prototype.num_of_dice=l.$$prototype.num_of_sides=l.$$prototype.formatter=$,e.const_set(n[0],"RollResult",t(u(n,"Struct"),"new",["sum","values","content","formatted"],((m=function(){return(null==m.$$s?this:m.$$s).$alias_method("to_s","formatted")}).$$s=l,m.$$arity=0,m))),e.const_set(n[0],"Item",u(n,"Struct").$new("range","content")),e.const_set(n[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),e.const_set(n[0],"DEFAULT_FORMATTER",t(l,"lambda",[],($$2=function(v){function o(c,h){return v.apply(this,arguments)}return o.toString=function(){return v.toString()},o}(function(v,o){return null==$$2.$$s||$$2,null==v&&(v=$),null==o&&(o=$),v.$name()+"("+o.$sum()+") \uff1e "+o.$content()}),$$2.$$s=l,$$2.$$arity=2,$$2))),l.$attr_reader("name"),l.$attr_reader("num_of_dice"),l.$attr_reader("num_of_sides"),e.def(l,"$initialize",_=function(o,c,h){var T,R=_.$$p,I=R||$,a=this,K=$;return R&&(_.$$p=null),R&&(_.$$p=null),a.name=o.$freeze(),a.formatter=E(T=I)?T:u(n,"DEFAULT_FORMATTER"),K=u(n,"DICE_ROLL_METHOD_RE").$match(c),E(K)||a.$raise(u(n,"ArgumentError"),a.name+": invalid dice roll method: "+c),a.num_of_dice=K["$[]"](1).$to_i(),a.num_of_sides=K["$[]"](2).$to_i(),a.$store(h)},_.$$arity=3),e.def(l,"$fetch",d=function(o){var c,R,h=this;return R=t(h.items,"find",[],((c=function(a){return null==a&&(a=$),a.$range()["$include?"](o)}).$$s=h,c.$$arity=1,c)),E(R)||h.$raise(u(n,"RangeError"),h.name+": value is out of range: "+o),R},d.$$arity=1),e.def(l,"$roll",g=function(o){var R,I,a,i,c=this,h=$;return R=(h=o.$roll_barabara(c.num_of_dice,c.num_of_sides)).$sum(),I=u(n,"RollResult").$new(R,h,c.$fetch(R).$content()),a=[c.formatter["$[]"](c,I)],t(I,"formatted=",e.to_a(a)),"number"==typeof(i=a.length)||i["$-"](1),I},g.$$arity=1),l.$private(),e.def(l,"$store",b=function(o){var c,h,R,a,T,I=this;return a=t(o,"map",[],((c=function(te,$e){return null==te&&(te=$),null==$e&&($e=$),[(null==c.$$s?this:c.$$s).$coerce_to_int_range(te),$e]}).$$s=I,c.$$arity=2,c)),T=t(a,"sort_by",[],((h=function(te,$e){return null==te&&(te=$),null==$e&&($e=$),te.$min()}).$$s=I,h.$$arity=2,h)),I.$assert_min_sum_is_covered(T),I.$assert_max_sum_is_covered(T),I.$assert_no_gap_or_overlap_in_ranges(T),I.items=t(T,"map",[],(R=function(te,$e){return null==te&&(te=$),null==$e&&($e=$),u(n,"Item").$new(te,$e.$freeze()).$freeze()},R.$$s=I,R.$$arity=2,R)).$freeze(),I},b.$$arity=1),e.def(l,"$coerce_to_int_range",p=function(o){var h,R=$;return h=o,u(n,"Integer")["$==="](h)?u(n,"Range").$new(o,o):u(n,"Range")["$==="](h)&&E(E(R=o.$begin()["$is_a?"](u(n,"Integer")))?o.$end()["$is_a?"](u(n,"Integer")):R)?o:this.$raise(u(n,"TypeError"),this.name+": "+o+" ("+o.$class()+") must be an Integer or a Range with Integers ")},p.$$arity=1),e.def(l,"$assert_min_sum_is_covered",y=function(o){var h,c=this,R=$;return h=c.num_of_dice,R=o.$first()["$[]"](0),E(R["$include?"](h))||c.$raise(u(n,"RangeError"),c.name+": min value ("+h+") is not covered: "+R),c},y.$$arity=1),e.def(l,"$assert_max_sum_is_covered",B=function(o){var h,c=this,R=$;return h=function(i,A){return"number"==typeof i&&"number"==typeof A?i*A:i["$*"](A)}(c.num_of_dice,c.num_of_sides),R=o.$last()["$[]"](0),E(R["$include?"](h))||c.$raise(u(n,"RangeError"),c.name+": max value ("+h+") is not covered: "+R),c},B.$$arity=1),void e.def(l,"$assert_no_gap_or_overlap_in_ranges",W=function(o){var c;return t(o,"each_cons",[2],((c=function(I,a){var $e,ye,i,T=null==c.$$s?this:c.$$s,K=$,te=$;return null==T.name&&(T.name=$),null==I&&(I=$),null==a&&(a=$),K=I["$[]"](0),te=a["$[]"](0),ye="number"==typeof(i=$e=K.$max())?i+1:i["$+"](1),E(te["$include?"]($e))&&T.$raise(u(n,"RangeError"),T.name+": Range overlap: "+K+" and "+te),E(te["$include?"](ye))?$:T.$raise(u(n,"RangeError"),T.name+": Range gap: "+K+" and "+te)}).$$s=this,c.$$arity=2,c)),this},W.$$arity=1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var t,V,S,n,d,g,b,m,_,L,D,i,w=[],r=e.nil,x=e.$$$,$=e.$$,Q=e.module,u=e.klass,N=e.send;return t=w,V=i=[Q(w[0],"BCDice")].concat(t),S=D=[Q(i[0],"DiceTable")].concat(V),n=L=[u(D[0],null,"SaiFicSkillTable")].concat(S),m=u(L[0],null,"Category"),_=[m].concat(n),m.$$prototype.name=r,e.def(m,"$initialize",d=function(y,B,W,v){var o,c=this;return c.name=y,c.skills=N(B.$map(),"with_index",[2],((o=function(h){function R(I,a){return h.apply(this,arguments)}return R.toString=function(){return h.toString()},R}(function(h,R){return null==h&&(h=r),null==R&&(R=r),x($(_,"SaiFicSkillTable"),"Skill").$new(y,h,W,R,v)})).$$s=c,o.$$arity=2,o)),c.dice=W},d.$$arity=4),e.def(m,"$roll",g=function(y){return this.$skills()["$[]"]("number"==typeof(C=y.$roll_sum(2,6))?C-2:C["$-"](2));var C},g.$$arity=1),e.def(m,"$to_s",b=function(){return this.name},b.$$arity=0),void m.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var C,A,l,_,d,n,U,Y,f,E,X=[],w=e.nil,$=e.module,Q=e.klass,u=e.hash2;return C=X,A=E=[$(X[0],"BCDice")].concat(C),U=f=[$(E[0],"DiceTable")].concat(A),l=Y=[Q(f[0],null,"SaiFicSkillTable")].concat(U),[n=Q(Y[0],null,"Skill")].concat(l),n.$$prototype.s_format=n.$$prototype.category_dice=n.$$prototype.row_dice=n.$$prototype.category_name=n.$$prototype.name=w,e.def(n,"$initialize",_=function(b,p,y,B,W){var v=this;return v.category_name=b,v.name=p,v.category_dice=y,v.row_dice=B,v.s_format=W},_.$$arity=5),e.def(n,"$to_s",d=function(){var b=this;return b.$format(b.s_format,u(["category_dice","row_dice","category_name","skill_name"],{category_dice:b.category_dice,row_dice:b.row_dice,category_name:b.category_name,skill_name:b.name}))},d.$$arity=0),void n.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var V,U,l,_,d,g,b,p,y,B,n,m,Y,D,w=e.top,r=[],x=e.nil,$=e.$$$,Q=e.$$,u=e.module,N=e.klass,C=e.hash2,t=e.send,i=e.truthy;return w.$require("bcdice/dice_table/sai_fic_skill_table/category"),w.$require("bcdice/dice_table/sai_fic_skill_table/skill"),V=r,U=D=[u(r[0],"BCDice")].concat(V),l=Y=[u(D[0],"DiceTable")].concat(U),n=N(Y[0],null,"SaiFicSkillTable"),m=[n].concat(l),n.$$prototype.rtt=n.$$prototype.rtt_format=n.$$prototype.rct=n.$$prototype.rct_format=n.$$prototype.rttn=n.$$prototype.rttn_format=n.$$prototype.categories=x,e.defs(n,"$from_i18n",_=function(v,o,c){var h,R,I,a,$e,te=x;if(null==c)c=C([],{});else if(!c.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(h=c.$$smap.rtt)&&(h=x),null==(R=c.$$smap.rct)&&(R=x),null==(I=c.$$smap.rttn)&&(I=x),$e=(te=Q(m,"I18n").$t("RTT",C(["locale","raise","default"],{locale:o,raise:!1,default:C([],{})})).$merge(Q(m,"I18n").$t(v,C(["locale","raise"],{locale:o,raise:!0}))))["$[]"]("items"),te=t(te,"select",[],((a=function(ye){function ge(Te,Be){return ye.apply(this,arguments)}return ge.toString=function(){return ye.toString()},ge}(function(ye,ge){return null==ye&&(ye=x),null==ge&&(ge=x),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](ye)})).$$s=this,a.$$arity=2,a)),this.$new($e,e.to_hash(te).$merge(C(["rtt","rct","rttn"],{rtt:h,rct:R,rttn:I})))},_.$$arity=-3),e.const_set(m[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),e.const_set(m[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),e.const_set(m[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),e.const_set(m[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),e.def(n,"$initialize",d=function(v,o){var c,h,R,I,a,T,K,te,$e=this;if(null==o)o=C([],{});else if(!o.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(c=o.$$smap.rtt)&&(c=x),null==(h=o.$$smap.rct)&&(h=x),null==(R=o.$$smap.rttn)&&(R=x),null==(I=o.$$smap.rtt_format)&&(I=Q(m,"DEFAULT_RTT")),null==(a=o.$$smap.rct_format)&&(a=Q(m,"DEFAULT_RCT")),null==(T=o.$$smap.rttn_format)&&(T=Q(m,"DEFAULT_RTTN")),null==(K=o.$$smap.s_format)&&(K=Q(m,"DEFAULT_S")),$e.categories=t(v.$map(),"with_index",[1],((te=function(ge,Te){var ze,Ae,fe;return null==ge&&(ge=x),null==Te&&(Te=x),Ae=null==(ze=e.to_ary(ge))[0]?x:ze[0],fe=null==ze[1]?x:ze[1],$(Q(m,"SaiFicSkillTable"),"Category").$new(Ae,fe,Te,K)}).$$s=$e,te.$$arity=2,te.$$has_top_level_mlhs_arg=!0,te)),$e.rtt=c,$e.rct=h,$e.rttn=R.$to_a(),$e.rtt_format=I,$e.rct_format=a,$e.rttn_format=T},d.$$arity=-2),e.const_set(m[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),n.$attr_reader("categories"),e.def(n,"$roll_command",g=function(v,o){var h,c=this,R=x,I=x,a=x;return i(["RTT",c.rtt]["$include?"](h=o))?c.$format_skill(c.rtt_format,c.$roll_skill(v)):i(["RCT",c.rct]["$include?"](h))?(R=c.$roll_category(v),c.$format(c.rct_format,C(["category_dice","category_name"],{category_dice:R.$dice(),category_name:R.$name()}))):i(i(I=a=Q(m,"RTTN").$index(h))?I:a=c.rttn.$index(h))?c.$format_skill(c.rttn_format,c.categories["$[]"](a).$roll(v)):x},g.$$arity=2),e.def(n,"$roll_category",b=function(v){return this.categories["$[]"]("number"==typeof(A=v.$roll_once(6))?A-1:A["$-"](1));var A},b.$$arity=1),e.def(n,"$roll_skill",p=function(v){return this.$roll_category(v).$roll(v)},p.$$arity=1),e.def(n,"$prefixes",y=function(){var v=this;return function(A,V){return"number"==typeof A&&"number"==typeof V?A+V:A["$+"](V)}(["RTT[1-6]?","RCT",v.rtt,v.rct],v.rttn).$compact()},y.$$arity=0),n.$private(),void e.def(n,"$format_skill",B=function(v,o){return this.$format(v,C(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:o.$category_dice(),row_dice:o.$row_dice(),category_name:o.$category_name(),skill_name:o.$name(),text:o.$to_s()}))},B.$$arity=2)},Opal.modules["bcdice/dice_table/table"]=function(e){var E,f,Y,l,n,m,_,L,z,H,A,w=[],r=e.nil,$=e.$$,Q=e.module,u=e.klass,N=e.hash2,C=e.truthy;return E=w,f=A=[Q(w[0],"BCDice")].concat(E),Y=H=[Q(A[0],"DiceTable")].concat(f),L=u(H[0],null,"Table"),z=[L].concat(Y),L.$$prototype.times=L.$$prototype.sides=L.$$prototype.name=L.$$prototype.items=r,e.defs(L,"$from_i18n",l=function(g,b){var y=r;return y=$(z,"I18n").$t(g,N(["locale"],{locale:b})),this.$new(y["$[]"]("name"),y["$[]"]("type"),y["$[]"]("items"))},l.$$arity=2),e.def(L,"$initialize",n=function(g,b,p){var y=this,B=r;return y.name=g,y.items=p.$freeze(),B=/(\d+)D(\d+)/i.$match(b),C(B)||y.$raise($(z,"ArgumentError"),"Unexpected table type: "+b),y.times=B["$[]"](1).$to_i(),y.sides=B["$[]"](2).$to_i()},n.$$arity=3),e.def(L,"$roll",m=function(g){var p,b=this;return p=g.$roll_sum(b.times,b.sides),b.$choice(p)},m.$$arity=1),void e.def(L,"$choice",_=function(g){var p,b=this;return p=function(t,E){return"number"==typeof t&&"number"==typeof E?t-E:t["$-"](E)}(g,b.times),$(z,"RollResult").$new(b.name,g,b.items["$[]"](p))},_.$$arity=1)},Opal.modules["bcdice/dice_table"]=function(e){var j=e.top;return j.$require("bcdice/dice_table/roll_result"),j.$require("bcdice/dice_table/chain_table"),j.$require("bcdice/dice_table/d66_grid_table"),j.$require("bcdice/dice_table/d66_half_grid_table"),j.$require("bcdice/dice_table/d66_one_third_table"),j.$require("bcdice/dice_table/d66_left_range_table"),j.$require("bcdice/dice_table/d66_parity_table"),j.$require("bcdice/dice_table/d66_range_table"),j.$require("bcdice/dice_table/d66_table"),j.$require("bcdice/dice_table/range_table"),j.$require("bcdice/dice_table/sai_fic_skill_table"),j.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var u,E,A,C,X=[],$=e.module;return u=X,E=C=[$(X[0],"BCDice")].concat(u),A=[$(C[0],"D66SortType")].concat(E),e.const_set(A[0],"NO_SORT","no_sort"),e.const_set(A[0],"ASC","asc"),e.const_set(A[0],"DESC","desc"),void function(t,E){var A=[$(t,"RoundType")].concat(E);e.const_set(A[0],"CEIL","ceil"),e.const_set(A[0],"FLOOR","floor"),e.const_set(A[0],"ROUND","round")}(C[0],C)},Opal.modules["bcdice/translate"]=function(e){var C,A,D,V,f,E,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.hash2;return C=X,A=E=[$(X[0],"BCDice")].concat(C),V=$(E[0],"Translate"),f=[V].concat(A),void e.def(V,"$translate",D=function(U,S){var Y,L=this;if(null==L.locale&&(L.locale=w),null==S)S=Q([],{});else if(!S.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return Y=e.kwrestargs(S,{}),x(f,"I18n").$translate(U,Q(["locale","raise"],{locale:L.locale,raise:!0}).$merge(e.to_hash(Y)))},D.$$arity=-2)},Opal.modules["bcdice/result"]=function(e){function j(C,t){return"number"==typeof C&&"number"==typeof t?C-t:C["$-"](t)}var t,m,g,b,p,y,B,f,U,S,Y,L,z,l,n,D,H,i,w=[],r=e.nil,u=e.klass,N=e.send;return t=w,f=i=[(0,e.module)(w[0],"BCDice")].concat(t),H=[D=u(i[0],null,"Result")].concat(f),D.$$prototype.secret=D.$$prototype.success=D.$$prototype.failure=D.$$prototype.critical=D.$$prototype.fumble=r,[m=e.get_singleton_class(D)].concat(H),e.def(m,"$success",g=function(v){var o;return N(this.$new(),"tap",[],((o=function(h){function R(I){return h.apply(this,arguments)}return R.toString=function(){return h.toString()},R}(function(h){var I=r;return null==h&&(h=r),N(h,"text=",e.to_a(I=[v])),j(I.length,1),N(h,"success=",e.to_a(I=[!0])),I[j(I.length,1)]})).$$s=this,o.$$arity=1,o))},g.$$arity=1),e.def(m,"$failure",b=function(v){var o;return N(this.$new(),"tap",[],((o=function(R){var a=r;return null==R&&(R=r),N(R,"text=",e.to_a(a=[v])),j(a.length,1),N(R,"failure=",e.to_a(a=[!0])),a[j(a.length,1)]}).$$s=this,o.$$arity=1,o))},b.$$arity=1),e.def(m,"$critical",p=function(v){var o;return N(this.$new(),"tap",[],((o=function(R){var a=r;return null==R&&(R=r),N(R,"text=",e.to_a(a=[v])),j(a.length,1),N(R,"critical=",e.to_a(a=[!0])),j(a.length,1),N(R,"success=",e.to_a(a=[!0])),a[j(a.length,1)]}).$$s=this,o.$$arity=1,o))},p.$$arity=1),e.def(m,"$fumble",y=function(v){var o;return N(this.$new(),"tap",[],((o=function(R){var a=r;return null==R&&(R=r),N(R,"text=",e.to_a(a=[v])),j(a.length,1),N(R,"fumble=",e.to_a(a=[!0])),j(a.length,1),N(R,"failure=",e.to_a(a=[!0])),a[j(a.length,1)]}).$$s=this,o.$$arity=1,o))},y.$$arity=1),e.def(m,"$nothing",B=function(){return"nothing"},B.$$arity=0),e.def(D,"$initialize",U=function(_){var d=this;return null==_&&(_=r),d.text=_,d.rands=r,d.detailed_rands=r,d.secret=!1,d.success=!1,d.failure=!1,d.critical=!1,d.fumble=!1},U.$$arity=-1),D.$attr_accessor("text","rands","detailed_rands"),D.$attr_writer("secret","success","failure","critical","fumble"),e.def(D,"$secret?",S=function(){return this.secret},S.$$arity=0),e.def(D,"$success?",Y=function(){return this.success},Y.$$arity=0),e.def(D,"$failure?",L=function(){return this.failure},L.$$arity=0),e.def(D,"$critical?",z=function(){return this.critical},z.$$arity=0),e.def(D,"$fumble?",l=function(){return this.fumble},l.$$arity=0),void e.def(D,"$condition=",n=function(_){return this.success=_,this.failure=_["$!"]()},n.$$arity=1)},Opal.modules["racc/parser"]=function(e){function j(U,S){return"number"==typeof U&&"number"==typeof S?U<S:U["$<"](S)}function X(U,S){return"number"==typeof U&&"number"==typeof S?U-S:U["$-"](S)}function w(U,S){return"number"==typeof U&&"number"==typeof S?U+S:U["$+"](S)}function r(U,S){return"number"==typeof U&&"number"==typeof S?U>=S:U["$>="](S)}function x(U,S){return"number"==typeof U&&"number"==typeof S?U>S:U["$>"](S)}function $(U,S){return"number"==typeof U&&"number"==typeof S?U<=S:U["$<="](S)}var z,l,n,S,L,C=[],t=e.nil,E=e.$$$,i=e.$$,A=e.module,V=e.klass,f=e.truthy,D=e.gvars,H=e.send;return S=C,z=(L=[A(C[0],"Racc")].concat(S))[0],l=i(L,"StandardError"),n=L,[V(z,l,"ParseError")].concat(n),f(E("::","ParseError","skip_raise")?"constant":t)||e.const_set(C[0],"ParseError",E(i(C,"Racc"),"ParseError")),function(U,S){var m,g,b,p,y,B,W,v,o,c,h,R,I,a,T,K,te,$e,ye,ge,Te,Be,ze,qe,Ae,_,d,L=[A(U,"Racc")].concat(S);f(i(L,"Racc_No_Extensions","skip_raise")?"constant":t)||e.const_set(L[0],"Racc_No_Extensions",!1),m=L,_=V(L[0],null,"Parser"),d=[_].concat(m),_.$$prototype.yydebug=_.$$prototype.racc_debug_out=_.$$prototype.racc_error_status=_.$$prototype.racc_t=_.$$prototype.racc_vstack=_.$$prototype.racc_val=_.$$prototype.racc_state=_.$$prototype.racc_tstack=t,e.const_set(d[0],"Racc_Runtime_Version","1.4.6"),e.const_set(d[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),e.const_set(d[0],"Racc_Runtime_Core_Version_R","1.4.6"),e.const_set(d[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),e.const_set(d[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),e.const_set(d[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),e.const_set(d[0],"Racc_Runtime_Core_Version",i(d,"Racc_Runtime_Core_Version_R")),e.const_set(d[0],"Racc_Runtime_Core_Revision",i(d,"Racc_Runtime_Core_Revision_R")),e.const_set(d[0],"Racc_Runtime_Type","ruby"),e.defs(i(d,"Parser"),"$racc_runtime_type",g=function(){return i(d,"Racc_Runtime_Type")},g.$$arity=0),e.def(_,"$_racc_setup",b=function(){var O,J,s=this,q=t,P=t,k=t;return null==D.stderr&&(D.stderr=t),f(E(s.$class(),"Racc_debug_parser"))||(s.yydebug=!1),f(null!=(O=s.yydebug)&&O!==t?"instance-variable":t)||(s.yydebug=!1),f(s.yydebug)&&(f(null!=(J=s.racc_debug_out)&&J!==t?"instance-variable":t)||(s.racc_debug_out=D.stderr),s.racc_debug_out=f(q=s.racc_debug_out)?q:D.stderr),P=E(s.$class(),"Racc_arg"),f(j(P.$size(),14))&&(H(P,"[]=",e.to_a(k=[13,!0])),X(k.length,1)),P},b.$$arity=0),e.def(_,"$_racc_init_sysvars",p=function(){var O=this;return O.racc_state=[0],O.racc_tstack=[],O.racc_vstack=[],O.racc_t=t,O.racc_val=t,O.racc_read_next=!0,O.racc_user_yyerror=!1,O.racc_error_status=0},p.$$arity=0),e.def(_,"$do_parse",y=function(){return this.$__send__(i(d,"Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},y.$$arity=0),e.def(_,"$next_token",B=function(){return this.$raise(i(d,"NotImplementedError"),this.$class()+"#next_token is not defined")},B.$$arity=0),e.def(_,"$_racc_do_parse_rb",W=function(O,J){var s,P,k=this,Z=t,ee=t,ne=t,de=t,ie=t,me=t,be=t,le=t;return s=e.to_ary(O),Z=null==s[0]?t:s[0],ee=null==s[1]?t:s[1],ne=null==s[2]?t:s[2],de=null==s[3]?t:s[3],ie=null==s[10]?t:s[10],k.$_racc_init_sysvars(),me=be=le=t,H(k,"catch",["racc_end_parse"],((P=function(){var Ee,Ne,ae=null==P.$$s?this:P.$$s,De=t,Ie=t,Ce=t;for(null==ae.racc_state&&(ae.racc_state=t),null==ae.racc_read_next&&(ae.racc_read_next=t),null==ae.racc_t&&(ae.racc_t=t),null==ae.yydebug&&(ae.yydebug=t),null==ae.racc_val&&(ae.racc_val=t);f(!0);)for(f(le=de["$[]"](ae.racc_state["$[]"](-1)))?(f(ae.racc_read_next)&&f(ae.racc_t["$!="](0))&&(Ne=ae.$next_token(),Ee=e.to_ary(Ne),me=null==Ee[0]?t:Ee[0],ae.racc_val=null==Ee[1]?t:Ee[1],ae.racc_t=f(me)?f(De=ie["$[]"](me))?De:1:0,f(ae.yydebug)&&ae.$racc_read_token(ae.racc_t,me,ae.racc_val),ae.racc_read_next=!1),le=w(le,ae.racc_t),f(f(Ie=f(Ce=r(le,0))?be=Z["$[]"](le):Ce)?ee["$[]"](le)["$=="](ae.racc_state["$[]"](-1)):Ie)||(be=ne["$[]"](ae.racc_state["$[]"](-1)))):be=ne["$[]"](ae.racc_state["$[]"](-1));f(be=ae.$_racc_evalact(be,O)););}).$$s=k,P.$$arity=0,P))},W.$$arity=2),e.def(_,"$yyparse",v=function(O,J){return this.$__send__(i(d,"Racc_YY_Parse_Method"),O,J,this.$_racc_setup(),!0)},v.$$arity=2),e.def(_,"$_racc_yyparse_rb",o=function(O,J,s,q){var P,Z,ne=t,de=t,re=t,ie=t,be=t,le=t,he=t;return P=e.to_ary(s),ne=null==P[0]?t:P[0],de=null==P[1]?t:P[1],re=null==P[2]?t:P[2],ie=null==P[3]?t:P[3],be=null==P[10]?t:P[10],this.$_racc_init_sysvars(),le=t,he=t,H(this,"catch",["racc_end_parse"],((Z=function(){var De,xe=null==Z.$$s?this:Z.$$s;for(null==xe.racc_state&&(xe.racc_state=t);!f(he=ie["$[]"](xe.racc_state["$[]"](-1)));)for(;f(le=xe.$_racc_evalact(re["$[]"](xe.racc_state["$[]"](-1)),s)););return H(O,"__send__",[J],((De=function(Ce,Se){var Ue,Ge,ke=null==De.$$s?this:De.$$s,Le=t,He=t,je=t,We=t,ue=t,M=t,ce=t;for(null==ke.racc_t&&(ke.racc_t=t),null==ke.racc_state&&(ke.racc_state=t),null==ke.racc_read_next&&(ke.racc_read_next=t),null==Ce&&(Ce=t),null==Se&&(Se=t),ke.racc_t=f(Ce)?f(Le=be["$[]"](Ce))?Le:1:0,ke.racc_val=Se,ke.racc_read_next=!1,he=w(he,ke.racc_t),f(f(Ue=f(Ge=r(he,0))?le=ne["$[]"](he):Ge)?de["$[]"](he)["$=="](ke.racc_state["$[]"](-1)):Ue)||(le=re["$[]"](ke.racc_state["$[]"](-1)));f(le=ke.$_racc_evalact(le,s)););for(;f(f(He=f(je=(he=ie["$[]"](ke.racc_state["$[]"](-1)))["$!"]())?je:ke.racc_read_next["$!"]())?He:ke.racc_t["$=="](0));)for(f(f(We=f(ue=f(M=f(ce=he)?he=w(he,ke.racc_t):ce)?r(he,0):M)?le=ne["$[]"](he):ue)?de["$[]"](he)["$=="](ke.racc_state["$[]"](-1)):We)||(le=re["$[]"](ke.racc_state["$[]"](-1)));f(le=ke.$_racc_evalact(le,s)););}).$$s=xe,De.$$arity=2,De))}).$$s=this,Z.$$arity=0,Z))},o.$$arity=4),e.def(_,"$_racc_evalact",c=function(O,J){var s,P,re,me,k=this,Z=t,ee=t,de=t,ie=t,be=t,le=t,he=t,ae=t,xe=t,Ee=t;if(Z=null==(s=e.to_ary(J))[0]?t:s[0],ee=null==s[1]?t:s[1],de=null==s[3]?t:s[3],re=null==s[11]?t:s[11],ie=null==s[12]?t:s[12],f(f(me=x(O,0))?j(O,re):me))f(x(k.racc_error_status,0))&&(k.racc_t["$=="](1)||(k.racc_error_status=X(k.racc_error_status,1))),k.racc_vstack.$push(k.racc_val),k.racc_state.$push(O),k.racc_read_next=!0,f(k.yydebug)&&(k.racc_tstack.$push(k.racc_t),k.$racc_shift(k.racc_t,k.racc_tstack,k.racc_vstack));else if(f(f(be=j(O,0))?x(O,ie["$-@"]()):be)){if(le=H(k,"catch",["racc_jump"],((P=function(){var De=null==P.$$s?this:P.$$s;return null==De.racc_state&&(De.racc_state=t),De.racc_state.$push(De.$_racc_do_reduce(J,O)),!1}).$$s=k,P.$$arity=0,P)),f(le)){if(1["$==="](he=le))return k.racc_user_yyerror=!0,ie["$-@"]();if(2["$==="](he))return re;k.$raise("[Racc Bug] unknown jump code")}}else if(O["$=="](re))f(k.yydebug)&&k.$racc_accept(),k.$throw("racc_end_parse",k.racc_vstack["$[]"](0));else{if(O["$=="](ie["$-@"]())){for((0)["$==="](he=k.racc_error_status)?f(J["$[]"](21))||k.$on_error(k.racc_t,k.racc_val,k.racc_vstack):3["$==="](he)&&(k.racc_t["$=="](0)&&k.$throw("racc_end_parse",t),k.racc_read_next=!0),k.racc_user_yyerror=!1,k.racc_error_status=3;f(!0)&&(!f(ae=de["$[]"](k.racc_state["$[]"](-1)))||(ae=w(ae,1),!f(f(xe=f(Ee=r(ae,0))?O=Z["$[]"](ae):Ee)?ee["$[]"](ae)["$=="](k.racc_state["$[]"](-1)):xe)));)f($(k.racc_state.$size(),1))&&k.$throw("racc_end_parse",t),k.racc_state.$pop(),k.racc_vstack.$pop(),f(k.yydebug)&&(k.racc_tstack.$pop(),k.$racc_e_pop(k.racc_state,k.racc_tstack,k.racc_vstack));return O}k.$raise("[Racc Bug] unknown action "+O.$inspect())}return f(k.yydebug)&&k.$racc_next_state(k.racc_state["$[]"](-1),k.racc_state),t},c.$$arity=2),e.def(_,"$_racc_do_reduce",h=function(O,J){var s,re,me,Ee,Ne,De,ke,P=this,Z=t,ee=t,ne=t,de=t,ie=t,be=t,le=t,he=t,ae=t,xe=t,Ie=t,Ce=t,Se=t,Fe=t,Me=t,Le=t;return Z=null==(s=e.to_ary(O))[4]?t:s[4],ee=null==s[5]?t:s[5],ne=null==s[6]?t:s[6],de=null==s[7]?t:s[7],re=null==s[8]?t:s[8],ie=null==s[9]?t:s[9],me=null==s[13]?t:s[13],be=P.racc_state,le=P.racc_vstack,he=P.racc_tstack,ae=function(U,S){return"number"==typeof U?-3*U:U["$*"](-3)}(J),xe=ie["$[]"](ae),Ee=ie["$[]"](w(ae,1)),Ne=ie["$[]"](w(ae,2)),De=[],f(P.yydebug)&&(Ie=he["$[]"](xe["$-@"](),xe)),Ce=le["$[]"](xe["$-@"](),xe),f(P.yydebug)&&(Se=[xe["$-@"](),xe,De],H(he,"[]=",e.to_a(Se)),X(Se.length,1)),Se=[xe["$-@"](),xe,De],H(le,"[]=",e.to_a(Se)),X(Se.length,1),Se=[xe["$-@"](),xe,De],H(be,"[]=",e.to_a(Se)),X(Se.length,1),f(me)?le.$push(P.$__send__(Ne,Ce,le,Ce["$[]"](0))):le.$push(P.$__send__(Ne,Ce,le)),he.$push(Ee),f(P.yydebug)&&P.$racc_reduce(Ie,Ee,he,le),ke=X(Ee,re),f(ae=de["$[]"](ke))&&(ae=w(ae,be["$[]"](-1)),f(f(Fe=f(Me=r(ae,0))?Le=Z["$[]"](ae):Me)?ee["$[]"](ae)["$=="](ke):Fe))?Le:ne["$[]"](ke)},h.$$arity=2),e.def(_,"$on_error",R=function(O,J,s){var P,q=this;return q.$raise(i(d,"ParseError"),q.$sprintf("\nparse error on value %s (%s)",J.$inspect(),f(P=q.$token_to_str(O))?P:"?"))},R.$$arity=3),e.def(_,"$yyerror",I=function(){return this.$throw("racc_jump",1)},I.$$arity=0),e.def(_,"$yyaccept",a=function(){return this.$throw("racc_jump",2)},a.$$arity=0),e.def(_,"$yyerrok",T=function(){return this.racc_error_status=0},T.$$arity=0),e.def(_,"$racc_read_token",K=function(O,J,s){var q=this;return q.racc_debug_out.$print("read    "),q.racc_debug_out.$print(J.$inspect(),"(",q.$racc_token2str(O),") "),q.racc_debug_out.$puts(s.$inspect()),q.racc_debug_out.$puts()},K.$$arity=3),e.def(_,"$racc_shift",te=function(O,J,s){var q=this;return q.racc_debug_out.$puts("shift   "+q.$racc_token2str(O)),q.$racc_print_stacks(J,s),q.racc_debug_out.$puts()},te.$$arity=3),e.def(_,"$racc_reduce",$e=function(O,J,s,q){var P,k=this,Z=t;return(Z=k.racc_debug_out).$print("reduce "),f(O["$empty?"]())?Z.$print(" <none>"):H(O,"each",[],((P=function(ne){return null==ne&&(ne=t),Z.$print(" ",(null==P.$$s?this:P.$$s).$racc_token2str(ne))}).$$s=k,P.$$arity=1,P)),Z.$puts(" --\x3e "+k.$racc_token2str(J)),k.$racc_print_stacks(s,q),k.racc_debug_out.$puts()},$e.$$arity=4),e.def(_,"$racc_accept",ye=function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},ye.$$arity=0),e.def(_,"$racc_e_pop",ge=function(O,J,s){var q=this;return q.racc_debug_out.$puts("error recovering mode: pop token"),q.$racc_print_states(O),q.$racc_print_stacks(J,s),q.racc_debug_out.$puts()},ge.$$arity=3),e.def(_,"$racc_next_state",Te=function(O,J){var s=this;return s.racc_debug_out.$puts("goto    "+O),s.$racc_print_states(J),s.racc_debug_out.$puts()},Te.$$arity=2),e.def(_,"$racc_print_stacks",Be=function(O,J){var s,P=t;return(P=this.racc_debug_out).$print("        ["),H(O,"each_index",[],((s=function(Z){return null==Z&&(Z=t),P.$print(" (",(null==s.$$s?this:s.$$s).$racc_token2str(O["$[]"](Z))," ",J["$[]"](Z).$inspect(),")")}).$$s=this,s.$$arity=1,s)),P.$puts(" ]")},Be.$$arity=2),e.def(_,"$racc_print_states",ze=function(O){var J,q=t;return(q=this.racc_debug_out).$print("        ["),H(O,"each",[],((J=function(k){return null==k&&(k=t),q.$print(" ",k)}).$$s=this,J.$$arity=1,J)),q.$puts(" ]")},ze.$$arity=1),e.def(_,"$racc_token2str",qe=function(O){var s;return f(s=E(this.$class(),"Racc_token_to_s_table")["$[]"](O))?s:this.$raise("[Racc Bug] can't convert token "+O+" to string")},qe.$$arity=1),e.def(_,"$token_to_str",Ae=function(O){return E(this.$class(),"Racc_token_to_s_table")["$[]"](O)},Ae.$$arity=1)}(C[0],C)},Opal.modules["bcdice/arithmetic/node"]=function(e){function j(C,t){return"number"==typeof C&&"number"==typeof t?C/t:C["$/"](t)}var t,V,U,L,z,l,_,d,g,b,p,y,n,m,Y,D,i,w=[],r=e.nil,x=e.$$$,$=e.$$,Q=e.module,u=e.klass,N=e.send2;return t=w,V=i=[Q(w[0],"BCDice")].concat(t),U=D=[Q(i[0],"Arithmetic")].concat(V),function(L,z,l){var _,d,g,b,p,n=u(L,null,"BinaryOp");[n].concat(l),n.$$prototype.lhs=n.$$prototype.rhs=n.$$prototype.op=r,e.def(n,"$initialize",_=function(B,W,v){var o=this;return o.lhs=B,o.op=W,o.rhs=v},_.$$arity=3),e.def(n,"$eval",d=function(B){var o,W=this,v=r;return v=W.lhs.$eval(B),o=W.rhs.$eval(B),v.$send(W.op,o)},d.$$arity=1),e.def(n,"$output",g=function(){var B=this;return""+B.lhs.$output()+B.op+B.rhs.$output()},g.$$arity=0),e.def(n,"$s_exp",b=function(){var B=this;return"("+B.$op_for_s_exp()+" "+B.lhs.$s_exp()+" "+B.rhs.$s_exp()+")"},b.$$arity=0),e.def(n,"$op_for_s_exp",p=function(){return this.op},p.$$arity=0)}((Y=[Q(D[0],"Node")].concat(U))[0],0,Y),L=Y[0],z=$(Y,"BinaryOp"),l=Y,n=u(L,z,"DivideBase"),m=[n].concat(l),n.$$prototype.lhs=n.$$prototype.rhs=n.$$prototype.op=r,e.def(n,"$initialize",_=function(W,v){return _.$$p&&(_.$$p=null),N(this,e.find_super_dispatcher(this,"initialize",_,!1,!0),"initialize",[W,"/",v],null)},_.$$arity=2),e.def(n,"$eval",d=function(W){var o,v=this,c=r;return o=v.lhs.$eval(W),(c=v.rhs.$eval(W))["$=="](0)&&v.$raise($(m,"ZeroDivisionError")),v.$divide_and_round(o,c,W)},d.$$arity=1),e.def(n,"$output",g=function(){var W=g.$$p,o=this,c=r,h=r,R=r;for(W&&(g.$$p=null),h=0,R=arguments.length,c=new Array(R);h<R;h++)c[h]=arguments[h];return""+N(o,e.find_super_dispatcher(o,"output",g,!1,!0),"output",c,W)+o.$rounding_method()},g.$$arity=0),n.$private(),e.def(n,"$rounding_method",b=function(){return x(this.$class(),"ROUNDING_METHOD")},b.$$arity=0),e.def(n,"$op_for_s_exp",p=function(){return""+this.op+this.$rounding_method()},p.$$arity=0),e.def(n,"$divide_and_round",y=function(W,v,o){return this.$raise($(m,"NotImplementedError"))},y.$$arity=3),function(L,z,l){var _,n=u(L,z,"DivideWithGameSystemDefault"),m=[n].concat(l);e.const_set(m[0],"ROUNDING_METHOD",""),n.$private(),e.def(n,"$divide_and_round",_=function(g,b,p){var B;return B=p,x($(m,"RoundType"),"CEIL")["$==="](B)?j(g.$to_f(),b).$ceil():x($(m,"RoundType"),"ROUND")["$==="](B)?j(g.$to_f(),b).$round():j(g,b).$to_i()},_.$$arity=3)}(Y[0],$(Y,"DivideBase"),Y),function(L,z,l){var _,n=u(L,z,"DivideWithCeil"),m=[n].concat(l);e.const_set(m[0],"ROUNDING_METHOD","C"),n.$private(),e.def(n,"$divide_and_round",_=function(g,b,p){return j(g.$to_f(),b).$ceil()},_.$$arity=3)}(Y[0],$(Y,"DivideBase"),Y),function(L,z,l){var _,n=u(L,z,"DivideWithRound"),m=[n].concat(l);e.const_set(m[0],"ROUNDING_METHOD","R"),n.$private(),e.def(n,"$divide_and_round",_=function(g,b,p){return j(g.$to_f(),b).$round()},_.$$arity=3)}(Y[0],$(Y,"DivideBase"),Y),function(L,z,l){var _,n=u(L,z,"DivideWithFloor"),m=[n].concat(l);e.const_set(m[0],"ROUNDING_METHOD","F"),n.$private(),e.def(n,"$divide_and_round",_=function(g,b,p){return j(g,b).$to_i()},_.$$arity=3)}(Y[0],$(Y,"DivideBase"),Y),function(L,z,l){var _,d,g,b,n=u(L,null,"Negative");[n].concat(l),n.$$prototype.body=r,e.def(n,"$initialize",_=function(y){return this.body=y},_.$$arity=1),e.def(n,"$eval",d=function(y){return this.body.$eval(y)["$-@"]()},d.$$arity=1),e.def(n,"$output",g=function(){return"-"+this.body.$output()},g.$$arity=0),e.def(n,"$s_exp",b=function(){return"(- "+this.body.$s_exp()+")"},b.$$arity=0)}(Y[0],0,Y),function(L,z,l){var _,d,g,b,n=u(L,null,"Parenthesis");[n].concat(l),n.$$prototype.expr=r,e.def(n,"$initialize",_=function(y){return this.expr=y},_.$$arity=1),e.def(n,"$eval",d=function(y){return this.expr.$eval(y)},d.$$arity=1),e.def(n,"$output",g=function(){return"("+this.expr.$output()+")"},g.$$arity=0),e.def(n,"$s_exp",b=function(){return"(Parenthesis "+this.expr.$s_exp()+")"},b.$$arity=0)}(Y[0],0,Y),void function(L,z,l){var _,d,g,n=u(L,null,"Number");[n].concat(l),n.$$prototype.value=r,e.def(n,"$initialize",_=function(p){return this.value=p},_.$$arity=1),e.def(n,"$eval",d=function(p){return this.value},d.$$arity=1),e.def(n,"$output",g=function(){return this.value.$to_s()},g.$$arity=0),e.alias(n,"s_exp","output")}(Y[0],0,Y)},Opal.modules.strscan=function(e){var E,V,f,D,H,U,S,Y,L,z,l,n,m,_,d,g,b,p,y,B,W,v,o,c,h,R,i,A,w=[],r=e.nil,$=e.$$,u=e.truthy,N=e.send;return E=w,i=(0,e.klass)(w[0],null,"StringScanner"),A=[i].concat(E),i.$$prototype.pos=i.$$prototype.string=i.$$prototype.working=i.$$prototype.matched=i.$$prototype.prev_pos=i.$$prototype.match=r,i.$attr_reader("pos"),i.$attr_reader("matched"),e.def(i,"$initialize",V=function(a){var T=this;return T.string=a,T.pos=0,T.matched=r,T.working=a,T.match=[]},V.$$arity=1),i.$attr_reader("string"),e.def(i,"$beginning_of_line?",f=function(){var a=this;return 0===a.pos||"\n"===a.string.charAt(a.pos-1)},f.$$arity=0),e.alias(i,"bol?","beginning_of_line?"),e.def(i,"$scan",D=function(a){var T=this,K=(a=T.$anchor(a)).exec(T.working);return null==K?T.matched=r:"object"==typeof K?(T.prev_pos=T.pos,T.pos+=K[0].length,T.working=T.working.substring(K[0].length),T.matched=K[0],T.match=K,K[0]):"string"==typeof K?(T.pos+=K.length,T.working=T.working.substring(K.length),K):r},D.$$arity=1),e.def(i,"$scan_until",H=function(a){var T=this;a=T.$anchor(a);for(var $e,K=T.pos,te=T.working;;){if($e=a.exec(te),K+=1,te=te.substr(1),null!=$e)return T.matched=T.string.substr(T.pos,K-T.pos-1+$e[0].length),T.match=$e,T.prev_pos=K-1,T.pos=K,T.working=te.substr($e[0].length),T.matched;if(0===te.length)return T.match=[],T.matched=r}},H.$$arity=1),e.def(i,"$[]",U=function(a){var K;if(u(this.match["$empty?"]()))return r;K=a,$(A,"Symbol")["$==="](K)?a=a.$to_s():$(A,"String")["$==="](K)||(a=$(A,"Opal")["$coerce_to!"](a,$(A,"Integer"),"to_int"));var te=this.match;return a<0&&(a+=te.length),a<0||a>=te.length||null==te[a]?r:te[a]},U.$$arity=1),e.def(i,"$check",S=function(a){var T=this,K=(a=T.$anchor(a)).exec(T.working);return T.matched=null==K?r:K[0]},S.$$arity=1),e.def(i,"$check_until",Y=function(a){var T=this,K=T.prev_pos,te=T.pos,$e=T.$scan_until(a);return $e!==r&&(T.matched=$e.substr(-1),T.working=T.string.substr(te)),T.prev_pos=K,T.pos=te,$e},Y.$$arity=1),e.def(i,"$peek",L=function(a){return this.working.substring(0,a)},L.$$arity=1),e.def(i,"$eos?",z=function(){return 0===this.working.length},z.$$arity=0),e.def(i,"$exist?",l=function(a){var K=a.exec(this.working);return null==K?r:0==K.index?0:K.index+1},l.$$arity=1),e.def(i,"$skip",n=function(a){var T=this,K=(a=T.$anchor(a)).exec(T.working);if(null==K)return T.match=[],T.matched=r;var te=K[0],$e=te.length;return T.matched=te,T.match=K,T.prev_pos=T.pos,T.pos+=$e,T.working=T.working.substring($e),$e},n.$$arity=1),e.def(i,"$skip_until",m=function(a){var K=this.$scan_until(a);return K===r?r:(this.matched=K.substr(-1),K.length)},m.$$arity=1),e.def(i,"$get_byte",_=function(){var a=this,T=r;return a.pos<a.string.length?(a.prev_pos=a.pos,a.pos+=1,T=a.matched=a.working.substring(0,1),a.working=a.working.substring(1)):a.matched=r,T},_.$$arity=0),e.alias(i,"getch","get_byte"),e.def(i,"$match?",d=function(a){var T=this,K=(a=T.$anchor(a)).exec(T.working);return null==K?r:(T.prev_pos=T.pos,K[0].length)},d.$$arity=1),e.def(i,"$pos=",g=function(a){var T=this;return a<0&&(a+=T.string.$length()),T.pos=a,T.working=T.string.slice(a)},g.$$arity=1),e.def(i,"$matched_size",b=function(){return this.matched===r?r:this.matched.length},b.$$arity=0),e.def(i,"$post_match",p=function(){var a=this;return a.matched===r?r:a.string.substr(a.pos)},p.$$arity=0),e.def(i,"$pre_match",y=function(){var a=this;return a.matched===r?r:a.string.substr(0,a.prev_pos)},y.$$arity=0),e.def(i,"$reset",B=function(){var a=this;return a.working=a.string,a.matched=r,a.pos=0},B.$$arity=0),e.def(i,"$rest",W=function(){return this.working},W.$$arity=0),e.def(i,"$rest?",v=function(){return 0!==this.working.length},v.$$arity=0),e.def(i,"$rest_size",o=function(){return this.$rest().$size()},o.$$arity=0),e.def(i,"$terminate",c=function(){var T,C,a=this;return a.match=r,T=[a.string.$length()],N(a,"pos=",e.to_a(T)),T[(C=T.length,"number"==typeof C?C-1:C["$-"](1))]},c.$$arity=0),e.def(i,"$unscan",h=function(){var a=this;return a.pos=a.prev_pos,a.prev_pos=r,a.match=r,a},h.$$arity=0),i.$private(),e.def(i,"$anchor",R=function(a){var K=a.toString().match(/\/([^\/]+)$/);return K=K?K[1]:void 0,new RegExp("^(?:"+a.source+")",K)},R.$$arity=1),r&&"anchor"},Opal.modules["bcdice/normalize"]=function(e){var E,V,f,i,u,C,X=[],w=e.nil,$=e.module;return u=X,E=C=[$(X[0],"BCDice")].concat(u),[i=$(C[0],"Normalize")].concat(E),i.$module_function(),e.def(i,"$comparison_operator",V=function(H){var S;return/<=|=</["$==="](S=H)?"<=":/>=|=>/["$==="](S)?">=":/<>|!=|=!/["$==="](S)?"!=":/</["$==="](S)?"<":/>/["$==="](S)?">":/=/["$==="](S)?"==":w},V.$$arity=1),void e.def(i,"$target_number",f=function(H){return H["$=="]("?")?H:H.$to_i()},f.$$arity=1)},Opal.modules["bcdice/command/lexer"]=function(e){var E,f,Y,l,n,m,L,z,H,A,j=e.top,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.klass,u=e.hash2,N=e.truthy,C=e.send;return j.$require("strscan"),j.$require("bcdice/normalize"),E=X,f=A=[$(X[0],"BCDice")].concat(E),Y=H=[$(A[0],"Command")].concat(f),L=Q(H[0],null,"Lexer"),z=[L].concat(Y),L.$$prototype.scanner=L.$$prototype.notations=w,e.const_set(z[0],"SYMBOLS",u(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),e.def(L,"$initialize",l=function(d,g){var b,p,y,W,B=this;return d=N(W=(p=(b=d)===w||null==b?w:C(b,"split",[" ",2]))===w||null==p?w:C(p,"first",[]))?W:"",B.scanner=x(z,"StringScanner").$new(d),B.notations=C(g,"map",[],((y=function(v){function o(c){return v.apply(this,arguments)}return o.toString=function(){return v.toString()},o}(function(v){return null==v&&(v=w),N(v["$is_a?"](x(z,"String")))?x(z,"Regexp").$new(v):v})).$$s=B,y.$$arity=1,y))},l.$$arity=2),e.def(L,"$next_token",n=function(){try{var d,g=this,b=w,p=w,B=w,W=w;return N(g.scanner["$eos?"]())?[!1,"$"]:(C(g.notations,"each",[],((d=function(o){var h,c=null==d.$$s?this:d.$$s;if(null==c.scanner&&(c.scanner=w),null==o&&(o=w),h=c.scanner.$scan(o),!N(h))return w;e.ret(["NOTATION",h])}).$$s=g,d.$$arity=1,d)),N(b=g.scanner.$scan(/\d+/))?["NUMBER",b.$to_i()]:N(p=g.scanner.$scan(/[<>!=]+/))?(p=x(z,"Normalize").$comparison_operator(p),[N(p)?"CMP_OP":"ILLEGAL",p]):(B=g.scanner.$getch().$upcase(),[N(W=x(z,"SYMBOLS")["$[]"](B))?W:B.$to_sym(),B]))}catch(v){if(v===e.returner)return v.$v;throw v}},n.$$arity=0),void e.def(L,"$source",m=function(){return this.scanner.$string()},m.$$arity=0)},Opal.modules["bcdice/command/parsed"]=function(e){var C,A,U,L,z,l,S,Y,f,E,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.klass,u=e.truthy;return C=X,A=E=[$(X[0],"BCDice")].concat(C),U=f=[$(E[0],"Command")].concat(A),S=Q(f[0],null,"Parsed"),Y=[S].concat(U),S.$$prototype.question_target=S.$$prototype.critical=S.$$prototype.fumble=S.$$prototype.dollar=S.$$prototype.modify_number=S.$$prototype.target_number=S.$$prototype.prefix_number=S.$$prototype.command=S.$$prototype.suffix_number=S.$$prototype.cmp_op=w,S.$attr_accessor("command"),S.$attr_accessor("prefix_number"),S.$attr_accessor("suffix_number"),S.$attr_accessor("critical"),S.$attr_accessor("fumble"),S.$attr_accessor("dollar"),S.$attr_accessor("modify_number"),S.$attr_accessor("cmp_op"),S.$attr_accessor("target_number"),S.$attr_writer("question_target"),e.def(S,"$initialize",L=function(){var m=this;return m.prefix_number=w,m.suffix_number=w,m.critical=w,m.fumble=w,m.dollar=w,m.cmp_op=w,m.target_number=w,m.question_target=!1},L.$$arity=0),e.def(S,"$question_target?",z=function(){return this.question_target},z.$$arity=0),void e.def(S,"$to_s",l=function(m){var B,_=this,d=w,g=w,b=w,p=w,y=w;return null==m&&(m="after_command"),d=u(_.critical)?"@"+_.critical:w,g=u(_.fumble)?"#"+_.fumble:w,b=u(_.dollar)?"$"+_.dollar:w,p=x(Y,"Format").$modifier(_.modify_number),y=u(_.question_target)?"?":_.target_number,"after_command"["$==="](B=m)?[_.prefix_number,_.command,_.suffix_number,d,g,b,p,_.cmp_op,y].$join():"after_modify_number"["$==="](B)?[_.prefix_number,_.command,_.suffix_number,p,d,g,b,_.cmp_op,y].$join():"after_target_number"["$==="](B)?[_.prefix_number,_.command,_.suffix_number,p,_.cmp_op,y,d,g,b].$join():w},l.$$arity=-1)},Opal.modules["bcdice/command/parser"]=function(e){function j(A,V){return"number"==typeof A&&"number"==typeof V?A-V:A["$-"](V)}var V,U,L,z,l,_,d,g,b,p,y,B,W,v,o,c,h,R,I,a,T,K,te,$e,ye,ge,Te,Be,ze,qe,Ae,fe,O,J,s,q,P,k,Z,ee,ne,de,re,ie,me,be,le,he,ae,xe,Ee,Ne,De,Ie,Ce,Se,ke,Fe,Me,Le,He,n,m,Y,D,X=e.top,w=[],r=e.nil,x=e.$$$,$=e.$$,Q=e.klass,u=e.module,N=e.hash2,C=e.send2,t=e.send,E=e.hash,i=e.truthy;return X.$require("racc/parser.rb"),X.$require("bcdice/arithmetic/node"),X.$require("bcdice/command/lexer"),X.$require("bcdice/command/parsed"),function(A,V,f){[Q(A,V,"Parser")].concat(f)}(x($(w,"BCDice"),"Command"),x($(w,"Racc"),"Parser"),w),V=w,U=D=[u(w[0],"BCDice")].concat(V),L=(Y=[u(D[0],"Command")].concat(U))[0],z=x($(Y,"Racc"),"Parser"),l=Y,n=Q(L,z,"Parser"),m=[n].concat(l),n.$$prototype.notations=n.$$prototype.lexer=n.$$prototype.modifier=n.$$prototype.prefix_number=n.$$prototype.suffix_number=n.$$prototype.need_suffix_number=n.$$prototype.need_prefix_number=n.$$prototype.critical=n.$$prototype.fumble=n.$$prototype.dollar=n.$$prototype.allowed_cmp_op=n.$$prototype.question_target=r,e.def(n,"$initialize",_=function(M,ce){var G,F,se,Re,pe=_.$$p,oe=this;if(pe&&(_.$$p=null),G=e.slice.call(arguments,0,arguments.length),null==(F=e.extract_kwargs(G)))F=N([],{});else if(!F.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(se=G,!e.hasOwnProperty.call(F.$$smap,"round_type"))throw e.ArgumentError.$new("missing keyword: round_type");return Re=F.$$smap.round_type,C(oe,e.find_super_dispatcher(oe,"initialize",_,!1,!0),"initialize",[],null),oe.notations=se,oe.round_type=Re,oe.prefix_number=!1,oe.suffix_number=!1,oe.need_prefix_number=!1,oe.need_suffix_number=!1,oe.modifier=!0,oe.critical=!1,oe.fumble=!1,oe.dollar=!1,oe.allowed_cmp_op=[r,">=",">","<=","<","==","!="],oe.question_target=!1},_.$$arity=-2),e.def(n,"$disable_modifier",d=function(){return this.modifier=!1,this},d.$$arity=0),e.def(n,"$enable_prefix_number",g=function(){return this.prefix_number=!0,this},g.$$arity=0),e.def(n,"$enable_suffix_number",b=function(){return this.suffix_number=!0,this},b.$$arity=0),e.def(n,"$has_prefix_number",p=function(){var M=this;return M.prefix_number=!0,M.need_prefix_number=!0,M},p.$$arity=0),e.def(n,"$has_suffix_number",y=function(){var M=this;return M.suffix_number=!0,M.need_suffix_number=!0,M},y.$$arity=0),e.def(n,"$enable_critical",B=function(){return this.critical=!0,this},B.$$arity=0),e.def(n,"$enable_fumble",W=function(){return this.fumble=!0,this},W.$$arity=0),e.def(n,"$enable_dollar",v=function(){return this.dollar=!0,this},v.$$arity=0),e.def(n,"$restrict_cmp_op_to",o=function(M){var ce,F=this;return ce=e.slice.call(arguments,0,arguments.length),F.allowed_cmp_op=ce,F},o.$$arity=-1),e.def(n,"$enable_question_target",c=function(){return this.question_target=!0,this},c.$$arity=0),e.def(n,"$parse",h=function(M){try{return this.lexer=$(m,"Lexer").$new(M,this.notations),this.$do_parse()}catch(G){if(!e.rescue(G,[$(m,"ParseError"),$(m,"ZeroDivisionError")]))throw G;try{return r}finally{e.pop_exception()}}},h.$$arity=1),n.$private(),e.def(n,"$parsed",R=function(M,ce,G,F){var se;return t($(m,"Parsed").$new(),"tap",[],((se=function(ve){var we,Pe,Ye,Ke,Ve,Qe,oe=null==se.$$s?this:se.$$s,_e=r;return null==oe.round_type&&(oe.round_type=r),null==ve&&(ve=r),_e=[M["$[]"]("command")],t(ve,"command=",e.to_a(_e)),j(_e.length,1),_e=[(we=M["$[]"]("prefix"),we===r||null==we?r:t(we,"eval",[oe.round_type]))],t(ve,"prefix_number=",e.to_a(_e)),j(_e.length,1),_e=[(Pe=M["$[]"]("suffix"),Pe===r||null==Pe?r:t(Pe,"eval",[oe.round_type]))],t(ve,"suffix_number=",e.to_a(_e)),j(_e.length,1),_e=[(Ye=ce["$[]"]("critical"),Ye===r||null==Ye?r:t(Ye,"eval",[oe.round_type]))],t(ve,"critical=",e.to_a(_e)),j(_e.length,1),_e=[(Ke=ce["$[]"]("fumble"),Ke===r||null==Ke?r:t(Ke,"eval",[oe.round_type]))],t(ve,"fumble=",e.to_a(_e)),j(_e.length,1),_e=[(Ve=ce["$[]"]("dollar"),Ve===r||null==Ve?r:t(Ve,"eval",[oe.round_type]))],t(ve,"dollar=",e.to_a(_e)),j(_e.length,1),_e=[G.$eval(oe.round_type)],t(ve,"modify_number=",e.to_a(_e)),j(_e.length,1),_e=[F["$[]"]("cmp_op")],t(ve,"cmp_op=",e.to_a(_e)),j(_e.length,1),F["$[]"]("target")["$=="]("?")?(t(ve,"question_target=",e.to_a(_e=[!0])),j(_e.length,1),t(ve,"target_number=",e.to_a(_e=[0])),_e[j(_e.length,1)]):(t(ve,"question_target=",e.to_a(_e=[!1])),j(_e.length,1),_e=[(Qe=F["$[]"]("target"),Qe===r||null==Qe?r:t(Qe,"eval",[oe.round_type]))],t(ve,"target_number=",e.to_a(_e)),_e[j(_e.length,1)])}).$$s=this,se.$$arity=1,se))},R.$$arity=4),e.def(n,"$next_token",I=function(){return this.lexer.$next_token()},I.$$arity=0),Ne=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,33,34,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,r,r,17,18,6,r,5,r,r,17,18,r,r,5,23,24,25,26,56,54,55,57],De=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,r,17,15,15,18,18,23,r,18,30,30,23,23,24,r,23,31,31,24,24,25,r,24,44,44,25,25,28,r,25,47,47,28,28,29,r,28,48,48,29,29,33,r,29,49,49,33,33,34,r,33,50,50,34,34,36,r,34,r,r,36,36,37,r,36,r,r,37,37,r,r,37,27,27,27,27,52,52,52,52],Ie=[-2,4,16,-3,-1,11,r,33,13,35,23,30,1,r,28,40,r,37,44,r,r,-2,r,51,58,65,0,106,72,79,47,54,r,86,93,r,100,107,r,r,r,r,r,r,63,r,r,68,75,82,89,r,120,r,r,r,r,r],Ce=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],Se=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,r,r,21,47,48,40,51,52,49,50,44,46,3,r,r,r,13,r,r,r,r,r,r,r,32],ke=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,r,r,4,8,8,5,7,7,8,8,9,5,6,r,r,r,6,r,r,r,r,r,r,r,6],Fe=[r,6,13,3,9,-1,27,-15,-10,-1,-38],Me=[r,r,r,r,r,r,19,16,15,r,r],Le=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],He=E(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),e.const_set(m[0],"Racc_arg",[Ne,De,Ce,Ie,Se,ke,Me,Fe,19,Le,He,58,35,!0]),e.const_set(m[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),e.const_set(m[0],"Racc_debug_parser",!1),e.def(n,"$_reduce_1",a=function(M,ce,G){var F;return i(this.modifier)||this.$raise($(m,"ParseError")),F=e.to_ary(M),this.$parsed(null==F[0]?r:F[0],null==F[1]?r:F[1],null==F[2]?r:F[2],null==F[3]?r:F[3])},a.$$arity=3),e.def(n,"$_reduce_2",T=function(M,ce,G){var F;return i(this.modifier)||this.$raise($(m,"ParseError")),F=e.to_ary(M),this.$parsed(null==F[0]?r:F[0],null==F[2]?r:F[2],null==F[1]?r:F[1],null==F[3]?r:F[3])},T.$$arity=3),e.def(n,"$_reduce_3",K=function(M,ce,G){var F,oe;return oe=null==(F=e.to_ary(M))[2]?r:F[2],this.$parsed(null==F[0]?r:F[0],null==F[1]?r:F[1],x(x($(m,"Arithmetic"),"Node"),"Number").$new(0),oe)},K.$$arity=3),e.def(n,"$_reduce_4",te=function(M,ce,G){var se,F=this;return i(i(se=F.prefix_number)?F.suffix_number:se)||F.$raise($(m,"ParseError")),N(["command","prefix","suffix"],{command:M["$[]"](1),prefix:M["$[]"](0),suffix:M["$[]"](2)})},te.$$arity=3),e.def(n,"$_reduce_5",$e=function(M,ce,G){var F=this;return i(F.prefix_number)||F.$raise($(m,"ParseError")),i(F.need_suffix_number)&&F.$raise($(m,"ParseError")),N(["command","prefix"],{command:M["$[]"](1),prefix:M["$[]"](0)})},$e.$$arity=3),e.def(n,"$_reduce_6",ye=function(M,ce,G){var F=this;return i(F.suffix_number)||F.$raise($(m,"ParseError")),i(F.need_prefix_number)&&F.$raise($(m,"ParseError")),N(["command","suffix"],{command:M["$[]"](0),suffix:M["$[]"](1)})},ye.$$arity=3),e.def(n,"$_reduce_7",ge=function(M,ce,G){var se,F=this;return i(i(se=F.need_prefix_number)?se:F.need_suffix_number)&&F.$raise($(m,"ParseError")),N(["command"],{command:M["$[]"](0)})},ge.$$arity=3),e.def(n,"$_reduce_8",Te=function(M,ce,G){return N([],{})},Te.$$arity=3),e.def(n,"$_reduce_9",Be=function(M,ce,G){var F,oe,Pe,we,pe=r;return pe=null==(F=e.to_ary(M))[0]?r:F[0],oe=null==F[2]?r:F[2],i(i(we=this.critical)?pe["$[]"]("critical")["$nil?"]():we)||this.$raise($(m,"ParseError")),t(pe,"[]=",e.to_a(Pe=["critical",oe])),j(Pe.length,1),pe},Be.$$arity=3),e.def(n,"$_reduce_10",ze=function(M,ce,G){var F,oe,Pe,we,pe=r;return pe=null==(F=e.to_ary(M))[0]?r:F[0],oe=null==F[2]?r:F[2],i(i(we=this.fumble)?pe["$[]"]("fumble")["$nil?"]():we)||this.$raise($(m,"ParseError")),t(pe,"[]=",e.to_a(Pe=["fumble",oe])),j(Pe.length,1),pe},ze.$$arity=3),e.def(n,"$_reduce_11",qe=function(M,ce,G){var F,oe,Pe,we,pe=r;return pe=null==(F=e.to_ary(M))[0]?r:F[0],oe=null==F[2]?r:F[2],i(i(we=this.dollar)?pe["$[]"]("dollar")["$nil?"]():we)||this.$raise($(m,"ParseError")),t(pe,"[]=",e.to_a(Pe=["dollar",oe])),j(Pe.length,1),pe},qe.$$arity=3),e.def(n,"$_reduce_12",Ae=function(M,ce,G){return M["$[]"](1)},Ae.$$arity=3),e.def(n,"$_reduce_13",fe=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"Negative").$new(M["$[]"](1))},fe.$$arity=3),e.def(n,"$_reduce_14",O=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"+",M["$[]"](2))},O.$$arity=3),e.def(n,"$_reduce_15",J=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"-",M["$[]"](2))},J.$$arity=3),e.def(n,"$_reduce_16",s=function(M,ce,G){return i(this.allowed_cmp_op["$include?"](r))||this.$raise($(m,"ParseError")),N([],{})},s.$$arity=3),e.def(n,"$_reduce_17",q=function(M,ce,G){var F,pe,ve;return ve=null==(F=e.to_ary(M))[1]?r:F[1],i(this.allowed_cmp_op["$include?"](pe=null==F[0]?r:F[0]))||this.$raise($(m,"ParseError")),N(["cmp_op","target"],{cmp_op:pe,target:ve})},q.$$arity=3),e.def(n,"$_reduce_18",P=function(M,ce,G){var se,F=this;return se=M["$[]"](0),i(F.question_target)||F.$raise($(m,"ParseError")),i(F.allowed_cmp_op["$include?"](se))||F.$raise($(m,"ParseError")),N(["cmp_op","target"],{cmp_op:se,target:"?"})},P.$$arity=3),e.def(n,"$_reduce_19",k=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"+",M["$[]"](2))},k.$$arity=3),e.def(n,"$_reduce_20",Z=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"-",M["$[]"](2))},Z.$$arity=3),e.def(n,"$_reduce_22",ee=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"*",M["$[]"](2))},ee.$$arity=3),e.def(n,"$_reduce_23",ne=function(M,ce,G){return M["$[]"](3).$new(M["$[]"](0),M["$[]"](2))},ne.$$arity=3),e.def(n,"$_reduce_25",de=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"DivideWithGameSystemDefault")},de.$$arity=3),e.def(n,"$_reduce_26",re=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"DivideWithCeil")},re.$$arity=3),e.def(n,"$_reduce_27",ie=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"DivideWithCeil")},ie.$$arity=3),e.def(n,"$_reduce_28",me=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"DivideWithRound")},me.$$arity=3),e.def(n,"$_reduce_29",be=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"DivideWithFloor")},be.$$arity=3),e.def(n,"$_reduce_30",le=function(M,ce,G){return M["$[]"](1)},le.$$arity=3),e.def(n,"$_reduce_31",he=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"Negative").$new(M["$[]"](1))},he.$$arity=3),e.def(n,"$_reduce_33",ae=function(M,ce,G){return M["$[]"](1)},ae.$$arity=3),e.def(n,"$_reduce_34",xe=function(M,ce,G){return x(x($(m,"Arithmetic"),"Node"),"Number").$new(M["$[]"](0))},xe.$$arity=3),void e.def(n,"$_reduce_none",Ee=function(M,ce,G){return M["$[]"](0)},Ee.$$arity=3)},Opal.modules["bcdice/deprecated/checker"]=function(e){var C,A,H,Y,L,z,l,n,m,U,S,f,E,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.send,u=e.truthy;return C=X,A=E=[$(X[0],"BCDice")].concat(C),H=f=[$(E[0],"Deprecated")].concat(A),U=$(f[0],"Checker"),S=[U].concat(H),U.$private(),e.def(U,"$check_result_legacy",Y=function(d,g,b,p){var v,h,y=this,B=w,W=w,o=w,c=w,R=w;return B=Q(g,"map",[],"sides".$to_proc()),v=(W=Q(g,"map",[],"value".$to_proc())).$sum(),o=[100]["$==="](c=B)?y.$check_1D100(d,v,b,p):[20]["$==="](c)?y.$check_1D20(d,v,b,p):[6,6]["$==="](c)?y.$check_2D6(d,v,W,b,p):w,u(u(h=o["$nil?"]())?h:o["$empty?"]())&&(c=B.$uniq(),o=[10]["$==="](c)?y.$check_nD10(d,v,W,b,p):[6]["$==="](c)?y.$check_nD6(d,v,W,b,p):w,u(u(R=o["$nil?"]())?R:o["$empty?"]()))?w:x(S,"Result").$new(o.$delete_prefix(" \uff1e "))},Y.$$arity=4),e.def(U,"$check_1D100",L=function(d,g,b,p){return w},L.$$arity=4),e.def(U,"$check_1D20",z=function(d,g,b,p){return w},z.$$arity=4),e.def(U,"$check_nD10",l=function(d,g,b,p,y){return w},l.$$arity=5),e.def(U,"$check_2D6",n=function(d,g,b,p,y){return w},n.$$arity=5),void e.def(U,"$check_nD6",m=function(d,g,b,p,y){return w},m.$$arity=5)},Opal.modules["bcdice/base"]=function(e){function j(D,H){return"number"==typeof D&&"number"==typeof H?D+H:D["$+"](H)}function X(D,H){return"number"==typeof D&&"number"==typeof H?D-H:D["$-"](H)}var H,z,m,_,d,g,b,p,y,B,W,v,o,c,h,R,I,a,T,K,te,$e,ye,ge,Te,Be,ze,qe,Ae,fe,O,J,P,k,Z,ee,ne,q,l,n,S,$=e.top,Q=[],u=e.nil,N=e.$$$,C=e.$$,t=e.module,E=e.klass,i=e.truthy,A=e.send,V=e.range,f=u;return $.$require("i18n"),$.$require("i18n/backend/fallbacks"),$.$require("bcdice/randomizer"),$.$require("bcdice/dice_table"),$.$require("bcdice/enum"),$.$require("bcdice/translate"),$.$require("bcdice/result"),$.$require("bcdice/command/parser"),$.$require("bcdice/deprecated/checker"),H=Q,z=S=[t(Q[0],"BCDice")].concat(H),l=E(S[0],null,"Base"),n=[l].concat(z),l.$$prototype.sort_add_dice=l.$$prototype.sort_barabara_dice=l.$$prototype.enabled_d9=l.$$prototype.raw_input=l.$$prototype.randomizer=l.$$prototype.enabled_upcase_input=l.$$prototype.debug=u,J=e.get_singleton_class(l),q=[J].concat(n),J.$attr_reader("prefixes"),e.def(J,"$register_prefix",P=function(re){var me,be=this,le=u;return null==be.prefixes&&(be.prefixes=u),me=e.slice.call(arguments,0,arguments.length),be.prefixes=i(le=be.prefixes)?le:[],be.prefixes.$concat(me.$flatten())},P.$$arity=-1),e.def(J,"$register_prefix_from_super_class",k=function(){return this.$register_prefix(this.$superclass().$prefixes())},k.$$arity=0),e.def(J,"$prefixes_pattern",Z=function(){var ie,re=this,me=u;return null==re.prefixes_pattern&&(re.prefixes_pattern=u),null==re.prefixes&&(re.prefixes=u),re.prefixes_pattern=i(ie=re.prefixes_pattern)?ie:u,i(re.prefixes_pattern)?re.prefixes_pattern:(re.prefixes=i(me=re.prefixes)?me:[],re.prefixes.$freeze(),re.prefixes_pattern=(i(re.prefixes["$empty?"]())?/(?!)/:e.regexp(["^(S)?(",re.prefixes.$join("|"),")"],"i")).$freeze())},Z.$$arity=0),e.def(J,"$command_pattern",ee=function(){var re,me,ie=this,be=u,le=u;return null==ie.command_pattern&&(ie.command_pattern=u),null==ie.prefixes&&(ie.prefixes=u),ie.command_pattern=i(me=ie.command_pattern)?me:u,i(ie.command_pattern)?ie.command_pattern:(ie.prefixes=i(be=ie.prefixes)?be:[],ie.prefixes.$freeze(),le=j(A(N(C(q,"CommonCommand"),"COMMANDS"),"map",[],((re=function(ae){return null==ae&&(ae=u),N(ae,"PREFIX_PATTERN").$source()}).$$s=ie,re.$$arity=1,re)),ie.prefixes),ie.command_pattern=e.regexp(["^S?(",le.$join("|"),")"],"i").$freeze())},ee.$$arity=0),e.def(J,"$eval",ne=function(re){return this.$new(re).$eval()},ne.$$arity=1),l.$include(C(n,"Translate")),l.$include(N(C(n,"Deprecated"),"Checker")),e.def(l,"$initialize",m=function(s){var q=this;return q.raw_input=s,q.sort_add_dice=!1,q.sort_barabara_dice=!1,q.d66_sort_type=N(C(n,"D66SortType"),"NO_SORT"),q.enabled_d9=!1,q.round_type=N(C(n,"RoundType"),"FLOOR"),q.sides_implicit_d=6,q.upper_dice_reroll_threshold=u,q.reroll_dice_reroll_threshold=u,q.default_cmp_op=u,q.default_target_number=u,q.enabled_upcase_input=!0,q.locale="ja_jp",q.randomizer=N(C(n,"BCDice"),"Randomizer").$new(),q.debug=!1},m.$$arity=1),l.$attr_accessor("randomizer"),l.$attr_reader("d66_sort_type"),l.$attr_reader("round_type"),l.$attr_reader("sides_implicit_d"),l.$attr_reader("upper_dice_reroll_threshold"),l.$attr_reader("reroll_dice_reroll_threshold"),l.$attr_reader("default_cmp_op"),l.$attr_reader("default_target_number"),e.def(l,"$sort_add_dice?",_=function(){return this.sort_add_dice},_.$$arity=0),e.def(l,"$sort_barabara_dice?",d=function(){return this.sort_barabara_dice},d.$$arity=0),e.def(l,"$enabled_d9?",g=function(){return this.enabled_d9},g.$$arity=0),e.def(l,"$enable_debug",b=function(){return this.debug=!0},b.$$arity=0),e.def(l,"$eval",p=function(){var q,P,k,s=this,Z=u;return q=N(C(n,"BCDice"),"Preprocessor").$process(s.raw_input,s),P=i(k=s.$dice_command(q))?k:s.$eval_common_command(s.raw_input),i(P)?(Z=[s.randomizer.$rand_results()],A(P,"rands=",e.to_a(Z)),X(Z.length,1),Z=[s.randomizer.$detailed_rand_results()],A(P,"detailed_rands=",e.to_a(Z)),X(Z.length,1),P):u},p.$$arity=0),e.def(l,"$change_text",y=function(s){return s},y.$$arity=1),e.def(l,"$check_result",B=function(s,q,P,k){var Z=this,ee=u,ne=u,de=u,re=u,ie=u;return ee=Z.$check_result_legacy(s,q,P,k),i(ee)?ee:(ne=A(q,"map",[],"sides".$to_proc()),re=(de=A(q,"map",[],"value".$to_proc())).$sum(),(ee=[100]["$==="](ie=ne)?Z.$result_1d100(s,re,P,k):[20]["$==="](ie)?Z.$result_1d20(s,re,P,k):[6,6]["$==="](ie)?Z.$result_2d6(s,re,de,P,k):u)["$=="](C(n,"Result").$nothing())?u:i(ee)?ee:(ie=ne.$uniq(),(ee=[10]["$==="](ie)?Z.$result_nd10(s,re,de,P,k):[6]["$==="](ie)?Z.$result_nd6(s,re,de,P,k):u)["$=="](C(n,"Result").$nothing())?u:i(ee)?ee:Z.$result_ndx(s,P,k)))},B.$$arity=4),e.def(l,"$grich_text",W=function(s,q,P){return u},W.$$arity=3),l.$private(),e.def(l,"$eval_common_command",v=function(s){try{var q;return s=this.$change_text(s),A(N(C(n,"CommonCommand"),"COMMANDS"),"each",[],((q=function(Z){var ne,ee=null==q.$$s?this:q.$$s;if(null==ee.randomizer&&(ee.randomizer=u),null==Z&&(Z=u),ne=Z.$eval(s,ee,ee.randomizer),!i(ne))return u;e.ret(ne)}).$$s=this,q.$$arity=1,q)),u}catch(k){if(k===e.returner)return k.$v;throw k}},v.$$arity=1),e.def(l,"$dice_command",o=function(s){var q,P=this,k=u,Z=u,ee=u,ne=u,de=u,re=u,ie=u;return i(P.enabled_upcase_input)&&(s=s.$upcase()),k=P.$class().$prefixes_pattern().$match(s),i(k)?(Z=k["$[]"](1)["$nil?"]()["$!"](),i(Z)&&(s=s["$[]"](V(1,-1,!1))),ee=P.$eval_game_system_specific_command(s),i(ee["$is_a?"](C(n,"Result")))?(ne=[i(de=ee["$secret?"]())?de:Z],A(ee,"secret=",e.to_a(ne)),X(ne.length,1),ee):i(i(re=i(ie=ee["$nil?"]())?ie:ee["$empty?"]())?re:ee["$=="]("1"))?u:A(C(n,"Result").$new(),"tap",[],((q=function(be){return null==be&&(be=u),ne=[ee.$to_s()],A(be,"text=",e.to_a(ne)),X(ne.length,1),A(be,"secret=",e.to_a(ne=[Z])),ne[X(ne.length,1)]}).$$s=P,q.$$arity=1,q))):u},o.$$arity=1),e.def(l,"$eval_game_system_specific_command",c=function(s){return u},c.$$arity=1),e.def(l,"$result_ndx",h=function(s,q,P){return i(P["$is_a?"](C(n,"String")))?u:i(s.$send(q,P))?C(n,"Result").$success(this.$translate("success")):C(n,"Result").$failure(this.$translate("failure"))},h.$$arity=3),e.def(l,"$result_1d100",R=function(s,q,P,k){return u},R.$$arity=4),e.def(l,"$result_1d20",I=function(s,q,P,k){return u},I.$$arity=4),e.def(l,"$result_nd10",a=function(s,q,P,k,Z){return u},a.$$arity=5),e.def(l,"$result_2d6",T=function(s,q,P,k,Z){return u},T.$$arity=5),e.def(l,"$result_nd6",K=function(s,q,P,k,Z){return u},K.$$arity=5),e.def(l,"$get_table_by_2d6",te=function(s){return this.$get_table_by_nD6(s,2)},te.$$arity=1),e.def(l,"$get_table_by_1d6",$e=function(s){return this.$get_table_by_nD6(s,1)},$e.$$arity=1),e.def(l,"$get_table_by_nD6",ye=function(s,q){return this.$get_table_by_nDx(s,q,6)},ye.$$arity=2),e.def(l,"$get_table_by_nDx",ge=function(s,q,P){var Z,ee=u;return Z=this.randomizer.$roll_sum(q,P),ee=this.$get_table_value(s["$[]"](X(Z,q))),i(ee["$nil?"]())?["1",0]:[ee,Z]},ge.$$arity=3),e.def(l,"$get_table_by_1d3",Te=function(s){var k,Z,D,q=this,ee=u;return q.$debug("get_table_by_1d3"),k=q.randomizer.$roll_sum(1,6),q.$debug("num",k),Z=(D=X(k,1),"number"==typeof D?D/2:D["$/"](2)).$to_i(),q.$debug("index",Z),ee=s["$[]"](Z),i(ee["$nil?"]())?["1",0]:[ee,k]},Te.$$arity=1),e.def(l,"$get_table_by_d66_swap",Be=function(s){var P;return P=this.randomizer.$roll_d66(N(C(n,"D66SortType"),"ASC")),[this.$get_table_by_number(P,s),P]},Be.$$arity=1),e.def(l,"$get_table_by_d66",ze=function(s){var P,k,Z,ne,D,ee=u;return P=this.randomizer.$roll_once(6),k=this.randomizer.$roll_once(6),Z=j("number"==typeof(D=X(P,1))?6*D:D["$*"](6),X(k,1)),ee=s["$[]"](Z),ne=""+P+k,i(ee["$nil?"]())?["1",ne]:[ee,ne]},ze.$$arity=1),e.def(l,"$get_table_by_number",qe=function(s,q,P){try{var k;return null==P&&(P="1"),A(q,"each",[],((k=function(ne){var re,de=null==k.$$s?this:k.$$s;if(null==ne&&(ne=u),re=ne["$[]"](0),!i(function(D,H){return"number"==typeof D&&"number"==typeof H?D>=H:D["$>="](H)}(re,s)))return u;e.ret(de.$get_table_value(ne["$[]"](1)))}).$$s=this,k.$$arity=1,k)),this.$get_table_value(P)}catch(ee){if(ee===e.returner)return ee.$v;throw ee}},qe.$$arity=-3),e.def(l,"$get_table_value",Ae=function(s){return i(s["$is_a?"](C(n,"Proc")))?s.$call():s},Ae.$$arity=1),e.def(l,"$roll_tables",fe=function(s,q){var k=u;return k=q["$[]"](s),i(k)?k.$roll(this.randomizer).$to_s():u},fe.$$arity=2),e.def(l,"$debug",O=function(s,q){var k,Z,ee=this,ne=u,de=u;return k=e.slice.call(arguments,1,arguments.length),i(ee.debug)?(ne=i(s["$is_a?"](C(n,"String")))?s:s.$inspect(),i(k["$empty?"]())?ee.$warn(ne):(de=A(k,"map",[],((Z=function(ie){return null==ie&&(ie=u),i(ie["$is_a?"](C(n,"String")))?'"'+ie+'"':ie.$inspect()}).$$s=ee,Z.$$arity=1,Z)),ee.$warn(ne+": "+de.$join(", ")))):u},O.$$arity=-2),N(N(C(Q,"I18n"),"Backend"),"Simple").$include(N(N(C(Q,"I18n"),"Backend"),"Fallbacks")),C(Q,"I18n").$load_path()["$<<"](C(Q,"Dir")["$[]"](C(Q,"File").$join($.$__dir__(),"../../i18n/**/*.yml"))),f=["ja_jp"],A(C(Q,"I18n"),"default_locale=",e.to_a(f)),X(f.length,1),f=[["ja_jp"]],A(C(Q,"I18n").$fallbacks(),"defaults=",e.to_a(f)),f[X(f.length,1)]},function(e){function j(f,D){return"number"==typeof f&&"number"==typeof D?f+D:f["$+"](D)}function w(f,D){return"number"==typeof f&&"number"==typeof D?f-D:f["$-"](D)}var D,Y,m,g,b,p,y,_,d,z,U,x=[],$=e.nil,Q=e.$$$,u=e.$$,N=e.module,C=e.klass,t=e.hash2,E=e.send2,i=e.truthy,A=e.range,V=e.send;e.top.$require("bcdice/base"),D=x,Y=U=[N(x[0],"BCDice")].concat(D),m=z=[N(U[0],"GameSystem")].concat(Y),_=C(z[0],u(z,"Base"),"DesperateRun"),d=[_].concat(m),_.$$prototype.randomizer=$,e.const_set(d[0],"ID","DesperateRun"),e.const_set(d[0],"NAME","Desperate Run TRPG"),e.const_set(d[0],"SORT_KEY","\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG"),e.const_set(d[0],"HELP_MESSAGE","\u30fb\u96e3\u6613\u5ea6\u7b97\u51fa\u30b3\u30de\u30f3\u30c9\u3000DDC\n\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3000RCx\u3000or\u3000RCx+y\u3000or\u3000RCx-y\uff08x\uff1d\u96e3\u6613\u5ea6\u3001y=\u4fee\u6b63\u5024\uff08\u7701\u7565\u53ef\u80fd\uff09\uff09\n\u30fb\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868\u3000ACT\n\u30fb\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868\u3000ITEMT\n\u30fb\u52d5\u6a5f\u8868\u3000DOUKIT\n\u30fb\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868\u3000FLAGT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868\u3000ENTRYT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3000ROADT\n"),e.const_set(d[0],"TABLES",t(["ACT","ITEMT","DOUKIT","FLAGT","ENTRYT","ROADT"],{ACT:Q(u(d,"DiceTable"),"Table").$new("\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868","1D6",["PC\u5168\u54e1\u3001\u968a\u5217\u30921D6\u3067\u6c7a\u3081\u308b\uff0812\uff1a\u524d\u5217\u300134\uff1a\u4e2d\u5217\u300156\uff1a\u5f8c\u5217\uff09","1\u30bf\u30fc\u30f3\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u5074\u306e\u307f\u884c\u52d5\u3059\u308b\u3002","\u3053\u306e\u6226\u95d8\u306e\u884c\u52d5\u9806\u304c\u3001PC\u2192\u30e2\u30f3\u30b9\u30bf\u30fc\u3001\u304b\u3089\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u2192PC\u306b\u5909\u308f\u308b\u3002","PC\u5168\u54e1\u3001\u30a2\u30a4\u30c6\u30e01\u3064\u3092\u9078\u3093\u3067\u5931\u3046\u3002","PC\u5168\u54e11D6\u3092\u632f\u308b\u3002\u3053\u306e\u6226\u95d8\u4e2d\u3001\u305d\u306e\u51fa\u76ee\u306f\u30ce\u30fc\u30d7\u30e9\u30f3\u306b\u306a\u308b\u3002","PC\u5168\u54e1\u3001Flag\u304c1\u5897\u52a0\u3059\u308b\u3002"]),ITEMT:Q(u(d,"DiceTable"),"Table").$new("\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868","2D6",["\u30ed\u30b1\u30c3\u30c8\u30e9\u30f3\u30c1\u30e3\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30de\u30ab\u30d6\u30ebLv+3\u3000\u56de\u6570\uff1a\u653b\u64831\u56de","\u30ad\u30fc\u30d4\u30c3\u30af\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002\u5224\u5b9a\u306e\u51fa\u76ee\u306e\u5408\u8a08+1\u3000\u56de\u6570\uff1a2\u56de","\u30ec\u30fc\u30c0\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ce\u30fc\u30d7\u30e9\u30f3\u3000\u88c5\u5099\u6642\u3001\u300c\u5371\u967a\u300d\u30921\u6e1b\u3089\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3000\u56de\u6570\uff1a\u5371\u967a\u6e1b\u5c112\u56de","\u98df\u6599\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002Life3\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u5fdc\u6025\u30ad\u30c3\u30c8\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30e1\u30c7\u30a3\u30ab\u30ebLv+1\u3000\u56de\u6570\uff1a\u56de\u5fa93\u56de","\u5203\u7269\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30a2\u30bf\u30c3\u30afLv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u9283\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30b7\u30e5\u30fc\u30c8Lv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u30c9\u30e9\u30c3\u30b0\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u3044\u3064\u3067\u3082\u4f7f\u7528\u53ef\u3002Brave1\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u91d1\u5238\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30a2\u30d5\u30bf\u30fc\u30d7\u30ec\u30a4\u3067\u4f7f\u7528\u53ef\u3002\u7d4c\u9a13\u70b9+2\u3000\u56de\u6570\uff1a1\u56de","\u30d7\u30ed\u30c6\u30af\u30bf\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ac\u30fc\u30c9Lv+1\u3000\u56de\u6570\uff1a\u9632\u5fa15\u56de","\u30c8\u30df\u30fc\u30ac\u30f3\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30c1\u30a7\u30fc\u30f3Lv+5\u3000\u56de\u6570\uff1a\u653b\u64831\u56de"]),DOUKIT:Q(u(d,"DiceTable"),"Table").$new("\u52d5\u6a5f\u8868","1D6",["\u96b7\u5c5e\u3002\u4f55\u304b\u5f31\u307f\u306b\u4ed8\u3051\u8fbc\u307e\u308c\u3001\u5acc\u3005\u306a\u304c\u3089\u3082\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u308b\u3002\u5f8c\u308d\u3081\u305f\u3044\u4e8b\u3001\u501f\u91d1\u3001\u306a\u3069\u3002","\u732e\u8eab\u3002\u3053\u306e\u756a\u7d44\u306f\u8ab0\u304b\u306e\u305f\u3081\u306b\u51fa\u3066\u3044\u308b\u3002\u75c5\u6c17\u306e\u5bb6\u65cf\u3092\u6551\u3046\u305f\u3081\u3001\u53c2\u52a0\u8005\u306e\u4e00\u4eba\u304c\u604b\u4eba\u3067\u3042\u308b\u3001\u306a\u3069\u3002","\u6210\u884c\u3002\u671b\u3093\u3067\u3044\u306a\u3044\u306e\u306b\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3002\u8ab0\u304b\u304c\u52dd\u624b\u306b\u7533\u3057\u8fbc\u3093\u3060\u3001\u7d1b\u308c\u8fbc\u3093\u3067\u3057\u307e\u3063\u305f\u3001\u306a\u3069\u3002","\u6e07\u671b\u3002\u3068\u306b\u304b\u304f\u4f55\u304b\u3092\u6b32\u3057\u3066\u53c2\u52a0\u3057\u3066\u3044\u308b\u3002\u91d1\u3001\u30b9\u30ea\u30eb\u3001\u91d1\u3067\u624b\u306b\u5165\u308b\u3082\u306e\u3001\u306a\u3069\u3002","\u5947\u4eba\u3002\u597d\u304d\u597d\u3093\u3067\u3053\u306e\u756a\u7d44\u306b\u51fa\u3066\u3044\u308b\u3002\u6bba\u4eba\u7656\u3001\u30ca\u30eb\u30b7\u30b9\u30c8\u3001\u81ea\u6bba\u9858\u671b\u3001\u5316\u3051\u7269\u30de\u30cb\u30a2\u3001\u306a\u3069\u3002","\u4ed5\u4e8b\u3002\u3053\u306e\u756a\u7d44\u306b\u51fa\u308b\u306e\u306f\u4ed5\u4e8b\u3060\u304b\u3089\u3060\u3002\u8cde\u91d1\u7a3c\u304e\u3001\u82b8\u80fd\u4eba\u3001\u8a18\u8005\u3001\u756a\u7d44\u30b9\u30bf\u30c3\u30d5\u3001\u306a\u3069\u3002"]),FLAGT:Q(u(d,"DiceTable"),"Table").$new("\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868","1D6",["\u5e0c\u671b\u3002\u300c\u3053\u308c\u304c\u7d42\u308f\u3063\u305f\u3089\u3001\u4e00\u7dd2\u306b\u9152\u3067\u3082\u98f2\u3082\u3046\u3084\u300d\u300c\u3082\u3046\u4f55\u3082\u6016\u304f\u306a\u3044\u300d\u306a\u3069\u3002","\u671b\u90f7\u3002\u300c\u304f\u305d\u3063\u3001\u3001\u3001\u4ffa\u306b\u306f\u3001\u5e30\u308a\u3092\u5f85\u3064\u4eba\u304c\u3001\u3001\u3001\u3063\uff01\u300d\u300c\u3042\u3042\u3001\u6545\u90f7\u306e\u30de\u30eb\u30b2\u30ea\u30fc\u30bf\u3092\u3082\u3046\u4e00\u5ea6\u98df\u3079\u305f\u304b\u3063\u305f\u3001\u3001\u3001\u300d\u306a\u3069\u3002","\u72c2\u4e71\u3002\u300c\u304a\u524d\u3092\u3001\u6bba\u305b\u3070\u3001\u4ffa\u306f\u3001\u5104\u4e07\u9577\u8005\u306a\u3093\u3060\u3088\u3049\u3049\u3049\u304a\uff01\uff01\u300d\u300c\u30d2\u30cf\u30c3\u3001\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u3047\u3047\u3047\u3047\u300d\u306a\u3069\u3002","\u7d76\u671b\u3002\u300c\u3082\u3046\u3060\u3081\u3060\u3041\u3001\u3001\u3001\u304a\u3057\u307e\u3044\u3060\u3041\u3001\u3001\u3001\u300d\u300c\u304f\u3001\u304f\u308b\u306a\u3063\u3001\u304f\u308b\u306a\u3041\u3041\u3041\u3041\uff01\uff01\u300d\u306a\u3069\u3002","\u6162\u5fc3\u3002\u300c\u306a\u3093\u3060\u3001\u3053\u3093\u306a\u3084\u3064\u3001\u4ffa\u3060\u3051\u3067\u5341\u5206\u3060\u300d\u300c\u5927\u4e08\u592b\u3060\u3001\u554f\u984c\u306a\u3044\u300d\u306a\u3069\u3002","\u72a0\u7272\u3002\u300c\u3075\u3075\u3001\u4ffa\u306a\u3089\u5927\u4e08\u592b\u3060\u3001\u3001\u3001\u6c17\u306b\u3059\u308b\u306a\u300d\u300c\u304a\u524d\u3089\u4e0b\u304c\u308c\u3063\uff01\u3053\u3053\u306f\u4ffa\u306b\u4efb\u305b\u308d\uff01\u300d\u306a\u3069\u3002"]),ENTRYT:Q(u(d,"DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868","1D6",["\u9045\u523b\u3002\u3082\u3068\u3082\u3068\u53c2\u52a0\u3059\u308b\u4e88\u5b9a\u3060\u3063\u305f\u306e\u3060\u304c\u9045\u308c\u3066\u3057\u307e\u3063\u305f\u3002\u4eca\u304b\u3089\u3067\u3082\u8d70\u308c\u3068\u7121\u7406\u77e2\u7406\u53c2\u52a0\u3002","\u73fe\u4f4f\u3002\u3082\u3068\u3082\u3068\u3053\u3053\u306b\u4f4f\u3093\u3067\u3044\u305f\u3002\u4f55\uff1f\u756a\u7d44\uff1f\u3048\uff1f\u3042\u3001\u304a\u91d1\u3082\u3089\u3048\u3093\u306e\uff1f\u30a4\u30a4\u30cd\uff01","\u7a81\u767a\u3002\u3082\u3068\u3082\u3068\u8996\u8074\u8005\u3068\u3057\u3066\u30b9\u30bf\u30b8\u30aa\u306b\u5c45\u305f\u3093\u3060\u3051\u3069\u3001\u53f8\u4f1a\u306b\u3046\u307e\u304f\u4e57\u305b\u3089\u308c\u3066\u30fb\u30fb\u30fb","\u4e71\u5165\u3002\u4f55\u304b\u76ee\u7684\u304c\u3042\u3063\u3066\u4e71\u5165\u3057\u305f\u3002\u4eca\u56de\u306e\u30b9\u30c6\u30fc\u30b8\u304c\u7c21\u5358\u306b\u898b\u3048\u305f\u308a\u3001\u53c2\u52a0\u8005\u306b\u5927\u4e8b\u306a\u4eba\u304c\u3044\u305f\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002","\u795e\u96a0\u3002\u4eca\u56de\u3088\u308a\u524d\u306e\u756a\u7d44\u306b\u53c2\u52a0\u3057\u3066\u3044\u305f\u304c\u884c\u65b9\u4e0d\u660e\u30fb\u6b7b\u3093\u3060\u3068\u601d\u308f\u308c\u3066\u3044\u305f\u3002\u304c\u3002\u541b\u306f\u307e\u3060\u3053\u3053\u306b\u3044\u308b\u3002","\u8077\u54e1\u3002\u3042\u308c\u3001\u9003\u3052\u9045\u308c\u307e\u3057\u305f\uff1f\u3042\u3089\u3042\u3089\u3001\u5927\u5909\u3067\u3059\u306d\u3001\u3057\u3087\u3046\u304c\u306a\u3044\u304b\u3089\u53c2\u52a0\u8005\u3055\u3093\u3068\u4e00\u7dd2\u306b\u8d70\u3063\u3066\u304f\u3060\u3055\u3044\u3002"]),ROADT:Q(u(d,"DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868","1D6",["\u6b7b\u7dda\u3002\u6b7b\u306c\u304b\u3068\u601d\u3063\u305f\u3002Flag+1","\u602a\u6211\u3002\u75db\u3044\u3002Life-1","\u5931\u610f\u3002\u3069\u3046\u3057\u3066\u3053\u3046\u306a\u3063\u305f\u3002Brave-1\u3002\u6e1b\u3089\u305b\u306a\u3044\u5834\u5408\u3001Flag+1","\u7d1b\u5931\u3002\u3069\u3063\u304b\u3044\u3063\u305f\u3002Item\u3092\u3069\u308c\u304b1\u3064\u6368\u3066\u308b\u3002\u6368\u3066\u308c\u306a\u3044\u5834\u5408\u3001Flag+1","\u8ffd\u5c3e\u3002\u5f8c\u308d\uff01\u5f8c\u308d\u30fc\u3063\uff01\u53c2\u52a0\u958b\u59cb\u90e8\u5c4b\u306e\u5371\u967a+1","\u8ff7\u5b50\u3002\u3042\u308c\u3001\u3053\u3053\u3069\u3053\u3060\uff1f\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3092\u632f\u308b\u56de\u6570+2"])}).$freeze()),_.$register_prefix("RC","DDC",u(d,"TABLES").$keys()),e.def(_,"$initialize",g=function(W){var c=this;return g.$$p&&(g.$$p=null),E(c,e.find_super_dispatcher(c,"initialize",g,!1,!0),"initialize",[W],null),c.sort_add_dice=!0,c.d66_sort_type=Q(u(d,"D66SortType"),"ASC")},g.$$arity=1),_.$private(),e.def(_,"$eval_game_system_specific_command",b=function(W){var o,c,v=this;return i(o=i(c=v.$check_roll(W))?c:v.$ddc_table(W))?o:v.$roll_tables(W,Q(v.$class(),"TABLES"))},b.$$arity=1),e.def(_,"$check_roll",p=function(W){var v,o,R=$,I=$,a=$,T=$,K=$,te=$,$e=$,ye=$,Te=$;return R=Q(u(d,"Command"),"Parser").$new(/RC\d+/,t(["round_type"],{round_type:this.$round_type()})).$restrict_cmp_op_to($).$parse(W),i(R)?(o=this.randomizer.$roll_barabara(2,6),T=j(I=null==(v=e.to_ary(o))[0]?$:v[0],a=null==v[1]?$:v[1]),K=j(j(I,a),R.$modify_number()),te=R.$command()["$[]"](A(2,-1,!1)).$to_i(),i(R.$modify_number()["$!="](0))&&($e="\u3000\u4fee\u6b63\u5024\uff1a"+R.$modify_number()),ye=I["$=="](a)?u(d,"Result").$critical("\u30be\u30ed\u76ee\uff01\u3010Critical\u3011"):T["$=="](7)?u(d,"Result").$fumble("\u30c0\u30a4\u30b9\u306e\u51fa\u76ee\u304c\u8868\u88cf\uff01\u3010Fumble\u3011"):i(function(f,D){return"number"==typeof f&&"number"==typeof D?f>=D:f["$>="](D)}(K,te))?u(d,"Result").$success(K+"\u3001\u96e3\u6613\u5ea6\u4ee5\u4e0a\uff01\u3010Success\u3011"):u(d,"Result").$failure(K+"\u3001\u96e3\u6613\u5ea6\u672a\u6e80\uff01\u3010Miss\u3011"),Te=[["\u5224\u5b9a\u3000\u96e3\u6613\u5ea6\uff1a"+te+$e,"\u51fa\u76ee\uff1a"+I+"\u3001"+a,ye.$text()].$join(" \uff1e ")],V(ye,"text=",e.to_a(Te)),w(Te.length,1),ye):$},p.$$arity=1),e.def(_,"$ddc_table",y=function(W){var v,o,h=$,R=$,I=$,a=$,T=$;return i(W["$!="]("DDC"))?$:(o=this.randomizer.$roll_barabara(2,6),o=[h=null==(v=e.to_ary(o))[0]?$:v[0],R=null==v[1]?$:v[1]].$sort(),"\u96e3\u6613\u5ea6\u6c7a\u5b9a \uff1e \u51fa\u76ee\uff1a"+h+"\u3001"+R+" \uff1e "+(a=null==(v=e.to_ary(o))[1]?$:v[1])+"-"+(I=null==v[0]?$:v[0])+"="+(T=w(a,I))+" \uff1e \u96e3\u6613\u5ea6"+j(5,T))},y.$$arity=1)}(Opal)}}]);